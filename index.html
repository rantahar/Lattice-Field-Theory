
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Lattice Field Theories &#8212; Lattice Field Theories  documentation</title>
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"TeX": {"equationNumbers": {"autoNumber": "AMS"}, "Macros": {"bra": ["\\langle{#1}|", "1"], "ket": ["|{#1}\\rangle", "1"], "ev": ["\\langle{#1}\\rangle", "1"], "braket": ["\\langle{#1}\\rangle", "1"], "Braket": ["\\left\\langle {#1} \\,\\middle|\\, {#2} \\right\\rangle", "2"], "Braketmid": ["\\left\\langle {#1} \\,\\middle|\\, {#2} \\,\\middle|\\, {#3} \\right\\rangle", "3"]}}})</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="lattice-field-theories">
<h1>Lattice Field Theories<a class="headerlink" href="#lattice-field-theories" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Lattice Field Theories</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#motivation">Motivation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#learning-objectives">Learning Objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="#spin-models">Spin models</a></li>
<li class="toctree-l2"><a class="reference internal" href="#field-theories">Field theories</a></li>
<li class="toctree-l2"><a class="reference internal" href="#scalar-fields">Scalar Fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="#monte-carlo-methods">Monte Carlo Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="#gauge-fields">Gauge fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="#fermions">Fermions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#hybrid-monte-carlo">Hybrid Monte-Carlo</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="motivation">
<h2>Motivation<a class="headerlink" href="#motivation" title="Permalink to this headline">¶</a></h2>
<p>These lecture notes give an introduction to lattice field theory, a
powerful framework for solving quantum field theories from first
principles.
We approach the topic mainly from the point of view of QCD, going
through the building blocks necessary to simulate a model with fermions
with a gauge interaction.</p>
</div>
<div class="section" id="learning-objectives">
<h2>Learning Objectives<a class="headerlink" href="#learning-objectives" title="Permalink to this headline">¶</a></h2>
<p>The course has two main objectives: to learn enough about lattice methods to put them into practical use and to become familiar with common methods used in studies of Standard Model physics.</p>
<p>After successfully completing the course, the student</p>
<ul class="simple">
<li><p>can implement a Monte Carlo simulation of a quantum field theory in
discrete space</p></li>
<li><p>can analyse the output of the calculation and describe its
connection to the theory</p></li>
<li><p>recognizes the most common discrete representations of field
theories and is able to find information on them</p></li>
<li><p>recognizes observables in the discrete representations and is able
to find information on them</p></li>
<li><p>can apply perturbation theory in a discrete space</p></li>
</ul>
</div>
<div class="section" id="spin-models">
<h2>Spin models<a class="headerlink" href="#spin-models" title="Permalink to this headline">¶</a></h2>
<p>We start with spin models as a simple example of a lattice model and to
get started with programming exercises.
This lesson introduces fundamental lattice simulation methods as well as important concepts from thermodynamics.</p>
<p>Spin models describe, in a rather simplified way, how a ferromagnet works.
We think of a clump of iron as a bunch of “atoms” sitting
unmoving on a structured lattice.</p>
<img src="_static/spin_random.svg"><p>Each atom has a spin, which creates a small magnetic field. When the
spins point to different random directions (as above), they cancel each
other and the iron is not magnetized. But if for some reason they point
to the same direction, the small magnetic fields add up into a
macroscopic value.</p>
<img src="_static/spin_ordered.svg"><p>Why would this happen?</p>
<p>A spin pointing against a magnetic field has a slightly higher energy
than a spin pointing to the same direction as the field. So atoms close
to each other would prefer to align. At zero temperature, they would
eventually all point to the same direction and create a magnet. At higher
temperatures, thermal fluctuations will occasionally cause a spin to flip.</p>
<p>Let’s only consider the spins closest to each other (nearest neighbors.)
The energy of two spins is</p>
<div class="math notranslate nohighlight" id="equation-index-0">
<span class="eqno">(1)<a class="headerlink" href="#equation-index-0" title="Permalink to this equation">¶</a></span>\[E=-j\mathbf{s}_{1}\cdot\mathbf{s}_{2}\]</div>
<p>and the energy of the whole system is</p>
<div class="math notranslate nohighlight" id="equation-index-1">
<span class="eqno">(2)<a class="headerlink" href="#equation-index-1" title="Permalink to this equation">¶</a></span>\[E=-J\sum_{&lt;ij&gt;}\mathbf{s}_{i}\mathbf{s}_{j}.\]</div>
<p>The sum over <span class="math notranslate nohighlight">\(&lt;ij&gt;\)</span> here counts pairs of neighbors. If the spins are
coupled to a magnetic field <span class="math notranslate nohighlight">\(\mathbf{H}\)</span>, with the magnetic momentum
<span class="math notranslate nohighlight">\(\gamma\)</span>, the energy is</p>
<div class="math notranslate nohighlight" id="equation-index-2">
<span class="eqno">(3)<a class="headerlink" href="#equation-index-2" title="Permalink to this equation">¶</a></span>\[E=-J\sum_{&lt;ij&gt;}\mathbf{s}_{i}\mathbf{s}_{j}-\gamma\mathbf{H}\cdot\sum_{i}\mathbf{s}_{i}.\]</div>
<p>At small temperatures the energy will tend to a minimum and the spins
will align. If there is a magnetic field, they will align to the
direction of the field. Otherwise they will pick a random direction.</p>
<p>At a non-zero temperature <span class="math notranslate nohighlight">\(T\)</span> the <em>configurations</em> of spins will follow
the Boltzmann distribution,</p>
<div class="math notranslate nohighlight" id="equation-index-3">
<span class="eqno">(4)<a class="headerlink" href="#equation-index-3" title="Permalink to this equation">¶</a></span>\[\begin{split}Z &amp; =\int[\prod_{i}ds_{i}]e^{-\frac{1}{kT}E(s)}\\
  &amp; =\int[\prod_{i}ds_{i}]e^{-\frac{J}{kT}\sum_{&lt;ij&gt;}\mathbf{s}_{i}\mathbf{s}_{j}+\frac{\gamma}{kT}\mathbf{H}\cdot\sum_{i}\mathbf{s}_{i}}\end{split}\]</div>
<p>The thermal expectation value of an observable <span class="math notranslate nohighlight">\(O\)</span> is then</p>
<div class="math notranslate nohighlight" id="equation-index-4">
<span class="eqno">(5)<a class="headerlink" href="#equation-index-4" title="Permalink to this equation">¶</a></span>\[&lt;O&gt; = \frac 1Z \int[\prod_{i}ds_{i}] \, O(s) \, e^{-\frac{1}{kT}E(s)}\]</div>
<p>At high temperatures the spins become essentially random and the
magnetization disappears.</p>
<div class="section" id="the-ising-model">
<h3>The Ising Model<a class="headerlink" href="#the-ising-model" title="Permalink to this headline">¶</a></h3>
<p>The Ising model is a further simplification of the above. All the spins
are either <span class="math notranslate nohighlight">\(+1\)</span> or <span class="math notranslate nohighlight">\(-1\)</span>. The partition function then is</p>
<div class="math notranslate nohighlight" id="equation-index-5">
<span class="eqno">(6)<a class="headerlink" href="#equation-index-5" title="Permalink to this equation">¶</a></span>\[Z =\sum_{s_{i}=\pm1}e^{-\beta\sum_{&lt;ij&gt;}s_{i}s_{j}+h\cdot\sum_{i}s_{i}}.\]</div>
<p>Here we use dimensionless couplings, <span class="math notranslate nohighlight">\(\beta=\frac{J}{kT}\)</span> and
<span class="math notranslate nohighlight">\(h=\frac{\gamma H}{kT}\)</span>.</p>
<p>The Ising model has been solved in 1 and 2 dimensions (Onsager 1944, Yang 1952).</p>
<p><strong>Simulation Algorithms</strong></p>
<p>The integral in the partition function has a very high dimension and cannot
practically be performed directly.
We introduce the Heat Bath algorithm here and will cover other Monte Carlo
methods in later chapters.
Monte Carlo methods perform very well when calculating high dimensional
integrals.</p>
<p>In the Ising model, the integral reduces to a sum over all possible configurations
of the spins. At constant temperature (in a heat bath), the probability of finding
the model in a given state should be equal to the Boltzmann weight.</p>
<div class="math notranslate nohighlight" id="equation-index-6">
<span class="eqno">(7)<a class="headerlink" href="#equation-index-6" title="Permalink to this equation">¶</a></span>\[P(s) = \frac{1}{Z} e^{-\beta E(s)}\]</div>
<p>We use a model known as a Markov Chain to draw configurations from this distribution.
Starting from any given configuration <span class="math notranslate nohighlight">\(s_0\)</span>, we build a new configuration
<span class="math notranslate nohighlight">\(s_1\)</span> and accept it with an appropriate probability <span class="math notranslate nohighlight">\(W_f(s_0 \to s_1)\)</span>.
The probability needs to be chosen correctly so that we do not move out of the
Boltzmann distribution.</p>
<p>The update probability needs to satisfy two conditions:</p>
<p><strong>1. Detailed Balance</strong></p>
<div class="math notranslate nohighlight" id="equation-index-7">
<span class="eqno">(8)<a class="headerlink" href="#equation-index-7" title="Permalink to this equation">¶</a></span>\[\frac{W_f(s_0\to s_1)}{W_f(s_1 \to s_0)} = \frac{P(s_1)}{P(s_0)} = e^{-\beta [ E(s_1) - E(s_0) ]}\]</div>
<p>If the first configuration is drawn with the correct probability, so will be
the second one. Detailed balance is in fact a bit more stringent a requirement
than is necessary, but it’s usually easiest to implement an algorithm that
satisfies it.</p>
<p><strong>2. Ergodicity</strong></p>
<p>It must be possible to reach any possible configuration from any other possible
configuration in a finite number of updates. Otherwise we might get stuck in
a finite region of the space of configurations.</p>
<p>With these two conditions, as long as the original configuration is drawn from
the correct distribution, the next one will also be.
And since all configurations have a non-zero weight, we can actually start from
any configuration.</p>
<p>But how do we construct the update? The Ising model has been studied for a long
time and there are many options.
One option is to update one spin at a time, flipping each spin with the appropriate
probability to satisfy detailed balance. Here are two common options for
the probability a spin:</p>
<p><strong>1. Heat Bath Algorithm</strong>:</p>
<p>In the heat bath method, we choose a random new spin based on its Boltzmann weight
normalized by the sum of all choices (in the Ising model just <span class="math notranslate nohighlight">\(\pm 1\)</span>).
The probability of choosing a new state <span class="math notranslate nohighlight">\(s_1\)</span> from possible states <span class="math notranslate nohighlight">\(s\)</span>
is</p>
<div class="math notranslate nohighlight" id="equation-index-8">
<span class="eqno">(9)<a class="headerlink" href="#equation-index-8" title="Permalink to this equation">¶</a></span>\[W_f(s_0\to s_1) = \frac{ P(s_1) }{ \sum_s P(s) }\]</div>
<p>Notice that the probability does not depend on the previous state <span class="math notranslate nohighlight">\(s_0\)</span>.
So the probability of choosing a positive spin is</p>
<div class="math notranslate nohighlight" id="equation-index-9">
<span class="eqno">(10)<a class="headerlink" href="#equation-index-9" title="Permalink to this equation">¶</a></span>\[P_+ = \frac{ P(1) }{ P(1) + P(-1) }\]</div>
<p>and for a negative spin</p>
<div class="math notranslate nohighlight" id="equation-index-10">
<span class="eqno">(11)<a class="headerlink" href="#equation-index-10" title="Permalink to this equation">¶</a></span>\[P_- = \frac{ P(-1) }{ P(1) + P(-1) }\]</div>
<p><strong>2. Metropolis Algorithm</strong> (Metropolis-Hastings Algorithm):</p>
<p>In the Metropolis method we suggest a random change to the current state
of the model. Given the initial state <span class="math notranslate nohighlight">\(s_0\)</span> the probability of choosing
the new state <span class="math notranslate nohighlight">\(s_1\)</span> is</p>
<div class="math notranslate nohighlight" id="equation-index-11">
<span class="eqno">(12)<a class="headerlink" href="#equation-index-11" title="Permalink to this equation">¶</a></span>\[W_f(s_0\to s_1) = min\left( 1, e^{- \beta [ E(s_1) - E(s_0) ]} \right )\]</div>
<p>So in the Metropolis method the probability of changing the spin depends
on the initial state. If the energy decreases, the update is always accepted.
If it increases, the probability is the ratio of Boltzmann weights of the two
options. You can check that the update follows detailed balance in both cases.</p>
<p>Note that if there were more than one possible spin, we would need to choose between
them using some update probability. This probability would need to be chosen so that
detailed balance is still preserved. More on this later, when we update models with
continuous parameters.</p>
<div class="note docutils container">
<p><strong>Example</strong></p>
<p>Let’s implement the Ising model. This is in python, but it’s hopefully readable
if you know another language. The algorithm is the important part. I recommend that
you write the code yourself, and don’t just copy and paste.</p>
<p>First will need numpy</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
<p>Next set up some parameters</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lattice_size</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">temperature</span> <span class="o">=</span> <span class="mf">4.0</span>
<span class="n">number_of_updates</span> <span class="o">=</span> <span class="mi">1000</span>
</pre></div>
</div>
<p>Create a numpy array that contains a spin on each lattice site</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">spin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="n">lattice_size</span><span class="p">,</span><span class="n">lattice_size</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
</pre></div>
</div>
<p>and run updates in a loop, updating one random site at a time</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_of_updates</span><span class="p">):</span>
   <span class="n">x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="n">lattice_size</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="p">)</span>
   <span class="n">y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="n">lattice_size</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="p">)</span>
</pre></div>
</div>
<p>Now we will randomly change the spin so that the probability matches the Boltzmann
distribution. First calculate the probability weights of each state</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">energy_plus</span>  <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span> <span class="n">spin</span><span class="p">[</span><span class="n">x</span><span class="p">][(</span><span class="n">y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="n">lattice_size</span><span class="p">]</span> <span class="o">+</span> <span class="n">spin</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                      <span class="o">+</span> <span class="n">spin</span><span class="p">[(</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="n">lattice_size</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">+</span> <span class="n">spin</span><span class="p">[</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="p">)</span>
<span class="n">energy_minus</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span> <span class="n">spin</span><span class="p">[</span><span class="n">x</span><span class="p">][(</span><span class="n">y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="n">lattice_size</span><span class="p">]</span> <span class="o">+</span> <span class="n">spin</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                       <span class="o">+</span> <span class="n">spin</span><span class="p">[(</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="n">lattice_size</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">+</span> <span class="n">spin</span><span class="p">[</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="p">)</span>

<span class="n">P_plus</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="n">energy_plus</span><span class="o">/</span><span class="n">temperature</span> <span class="p">)</span>
<span class="n">P_minus</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="n">energy_minus</span><span class="o">/</span><span class="n">temperature</span> <span class="p">)</span>
</pre></div>
</div>
<p>Notice the module lattice size (%lattice_size) in the neighbor index. If the current site
is at the lattice boundary, this will point to the other side. We don’t need this in the
negative direction since python does it automatically.</p>
<p>Now calculate the heat bath probability of choosing positive spin and we choose the spin
according to this probability</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">probability_plus</span> <span class="o">=</span> <span class="n">P_plus</span> <span class="o">/</span> <span class="p">(</span><span class="n">P_plus</span> <span class="o">+</span> <span class="n">P_minus</span><span class="p">)</span>

<span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">probability_plus</span><span class="p">:</span>
   <span class="n">spin</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">else</span><span class="p">:</span>
   <span class="n">spin</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</pre></div>
</div>
<p>This works in principle, but the program is a bit boring since it doesn’t measure anything.
Let’s print out the energy after each update.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">energy</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">lattice_size</span><span class="p">):</span>
   <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">lattice_size</span><span class="p">):</span>
      <span class="n">energy</span> <span class="o">+=</span> <span class="o">-</span> <span class="n">spin</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">*</span> <span class="n">spin</span><span class="p">[</span><span class="n">x</span><span class="p">][(</span><span class="n">y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="n">lattice_size</span><span class="p">]</span>
      <span class="n">energy</span> <span class="o">+=</span> <span class="o">-</span> <span class="n">spin</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">*</span> <span class="n">spin</span><span class="p">[(</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="n">lattice_size</span><span class="p">][</span><span class="n">y</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The energy is </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">energy</span><span class="p">))</span>
</pre></div>
</div>
<p><strong>Exercise</strong></p>
<ol class="arabic simple">
<li><p>Measure the magnetization as well</p></li>
<li><p>Running the measurement between each update is really wasteful.
Do multiple updates between measurements.</p></li>
<li><p>Switch to the Metropolis Algorithm</p></li>
</ol>
</div>
</div>
<div class="section" id="other-spin-models">
<h3>Other Spin Models<a class="headerlink" href="#other-spin-models" title="Permalink to this headline">¶</a></h3>
<p>Several more complicated spin models are studied. Some of the simpler ones include</p>
<p><strong>The Potts Model</strong></p>
<p>Similar to the Ising model, but there are <span class="math notranslate nohighlight">\(N\)</span> possible spins. Neighboring spins have
lower energy if they are equal.</p>
<div class="math notranslate nohighlight" id="equation-index-12">
<span class="eqno">(13)<a class="headerlink" href="#equation-index-12" title="Permalink to this equation">¶</a></span>\[E = -\beta\sum_{&lt;ij&gt;} \delta(s_{i},s_{j}) + |h| \sum_{i} \delta(\hat h, s_{i})\]</div>
<p><strong>The XY Spin Model</strong></p>
<p>Each spin is represented by an angle <span class="math notranslate nohighlight">\(\alpha\)</span>, or a 2D vector <span class="math notranslate nohighlight">\(s\)</span> of length 1.
The distance between spins is represented by the dot product, or equivalently the cosine
of the difference of the angles.</p>
<div class="math notranslate nohighlight" id="equation-index-13">
<span class="eqno">(14)<a class="headerlink" href="#equation-index-13" title="Permalink to this equation">¶</a></span>\[\begin{split}E &amp;= -\beta\sum_{&lt;ij&gt;} \cos( \alpha_i - \alpha_j ) + |h| \sum_{i} \cos( \alpha_i - \alpha_h )\\
  &amp;= -\beta\sum_{&lt;ij&gt;} s_{i} \cdot s_{j} + h \cdot \sum_{i} s_{i}\end{split}\]</div>
<p><strong>O(N) Spin Models</strong></p>
<p>Similarly, spins can be represented by N-dimensional vectors.</p>
<div class="math notranslate nohighlight" id="equation-index-14">
<span class="eqno">(15)<a class="headerlink" href="#equation-index-14" title="Permalink to this equation">¶</a></span>\[E = -\beta\sum_{&lt;ij&gt;} s_{i} \cdot s_{j} + h \cdot \sum_{i} s_{i}\]</div>
</div>
<div class="section" id="observables">
<h3>Observables<a class="headerlink" href="#observables" title="Permalink to this headline">¶</a></h3>
<p>We can measure the amount of magnetization through the sum of the spins.
For an individual configuration</p>
<div class="math notranslate nohighlight" id="equation-index-15">
<span class="eqno">(16)<a class="headerlink" href="#equation-index-15" title="Permalink to this equation">¶</a></span>\[M=\frac{1}{V}\sum_{i}s_{i},\]</div>
<p>where V is the number of points on the lattice, the volume. We get the thermal average by integrating over the Boltzmann distribution:</p>
<div class="math notranslate nohighlight" id="equation-index-16">
<span class="eqno">(17)<a class="headerlink" href="#equation-index-16" title="Permalink to this equation">¶</a></span>\[&lt;M&gt; =\frac{1}{V} \frac 1Z \int[\prod_{i}ds_{i}]  e^{-\frac{1}{kT}E(s)} ( \sum_{i}s_{i})\]</div>
<p>This can also be expressed as a derivative of the partition function with respect to the external field <span class="math notranslate nohighlight">\(h\)</span></p>
<div class="math notranslate nohighlight" id="equation-index-17">
<span class="eqno">(18)<a class="headerlink" href="#equation-index-17" title="Permalink to this equation">¶</a></span>\[&lt;M&gt; = \frac{1}{V} \frac{\partial}{\partial h} \log(Z).\]</div>
<p>So the field <span class="math notranslate nohighlight">\(h\)</span> functions as a source for the magnetization.</p>
<p>Similarly the energy is</p>
<div class="math notranslate nohighlight" id="equation-index-18">
<span class="eqno">(19)<a class="headerlink" href="#equation-index-18" title="Permalink to this equation">¶</a></span>\[\begin{split}&lt;E&gt; &amp;= \frac 1Z \int[\prod_{i}ds_{i}] \, E(s) \, e^{-\beta E(s)} \\
&amp;= -\frac{\partial}{\partial \beta} \log(Z)\end{split}\]</div>
<p>Other interesting observables include
- the specific heat (heat capacity)</p>
<div class="math notranslate nohighlight" id="equation-index-19">
<span class="eqno">(20)<a class="headerlink" href="#equation-index-19" title="Permalink to this equation">¶</a></span>\[\begin{split}\chi &amp; = -\frac 1V \frac{\partial}{\partial \beta} &lt;E&gt; \\
&amp; = \frac 1V \frac{\partial^2}{\partial^2 \beta} \log(Z) \\
&amp; = -\frac 1V \frac{\partial}{\partial \beta} \frac 1Z \int[\prod_{i}ds_{i}] E(s) e^{-\beta E(s)} \\
&amp; = \frac 1V \frac 1Z \int[\prod_{i}ds_{i}] E^2(s) e^{-\beta E(s)} - \frac 1V \frac 1{Z^2} \left(\int[\prod_{i}ds_{i}] E(s) e^{-\beta E(s)}\right)^2\\
&amp;=\frac 1V \left( &lt;E^2&gt; - &lt;E&gt;^2 \right)\end{split}\]</div>
<ul class="simple">
<li><p>The magnetic susceptibility</p></li>
</ul>
<div class="math notranslate nohighlight" id="equation-index-20">
<span class="eqno">(21)<a class="headerlink" href="#equation-index-20" title="Permalink to this equation">¶</a></span>\[\begin{split}\chi_M &amp; = \frac{\partial}{\partial h} &lt;M&gt; = \frac 1V \frac{\partial^2}{\partial^2 h} \log(Z) \\
&amp;= V\left( &lt;M^2&gt; - &lt;M&gt;^2 \right)\end{split}\]</div>
<ul class="simple">
<li><p>Correlation functions</p></li>
</ul>
<div class="math notranslate nohighlight" id="equation-index-21">
<span class="eqno">(22)<a class="headerlink" href="#equation-index-21" title="Permalink to this equation">¶</a></span>\[\begin{split}&amp;C(\mathbf{x}-\mathbf{y}) = &lt;s_{\mathbf{x}} s_{\mathbf{y}}&gt; - &lt;s_{\mathbf{x}}&gt;&lt;s_{\mathbf{y}}&gt;, \\
&amp;\lim_{|\mathbf{x} - \mathbf{y}|\to\infty} C(\mathbf{x}-\mathbf{y}) = e^{-|\mathbf{x} - \mathbf{y}|/\xi},\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\xi\)</span> is the correlation length.</p>
<p>Deriving this from the partition function requires introducing an <span class="math notranslate nohighlight">\(\mathbf{x}\)</span>-dependent source <span class="math notranslate nohighlight">\(h_\mathbf{x}\)</span></p>
<div class="math notranslate nohighlight" id="equation-index-22">
<span class="eqno">(23)<a class="headerlink" href="#equation-index-22" title="Permalink to this equation">¶</a></span>\[Z =\sum_{s_{i}=\pm1}e^{\beta\sum_{&lt;ij&gt;}s_{i}s_{j}+\sum_{i} h_i s_{i}}.\]</div>
<div class="math notranslate nohighlight" id="equation-index-23">
<span class="eqno">(24)<a class="headerlink" href="#equation-index-23" title="Permalink to this equation">¶</a></span>\[C(\mathbf{x}-\mathbf{y}) = \partial_\mathbf{x} \partial_\mathbf{y}
  \left . \log(Z) \right |_{h=0}\]</div>
</div>
<div class="section" id="transfer-matrices-example-of-an-exact-solution">
<h3>Transfer matrices (Example of an exact solution)<a class="headerlink" href="#transfer-matrices-example-of-an-exact-solution" title="Permalink to this headline">¶</a></h3>
<p>Consider the 1D Ising model:</p>
<img src="_static/1Dlat.svg"><p>and assume periodic boundary conditions</p>
<div class="math notranslate nohighlight" id="equation-index-24">
<span class="eqno">(25)<a class="headerlink" href="#equation-index-24" title="Permalink to this equation">¶</a></span>\[s_{x+L}=s_x\]</div>
<p>First we’ll write the energy in a symmetric way between the neighboring sites</p>
<div class="math notranslate nohighlight" id="equation-index-25">
<span class="eqno">(26)<a class="headerlink" href="#equation-index-25" title="Permalink to this equation">¶</a></span>\[\begin{split}E &amp;= \beta\sum_{x=1}^L s_x s_{x+1} +h\sum_{x=1}^L s_x\\
  &amp;=\sum_{x=1}^L \left( \beta s_x s_{x+1} + \frac 12 h (s_x + s_{x+1}) \right)\end{split}\]</div>
<p>We’ll define the <span class="math notranslate nohighlight">\(2\times2\)</span> transfer matrix</p>
<div class="math notranslate nohighlight" id="equation-index-26">
<span class="eqno">(27)<a class="headerlink" href="#equation-index-26" title="Permalink to this equation">¶</a></span>\[T_{s,s'} = e^{\beta s s' + \frac 12 h(s+s')}.\]</div>
<p>Now the partition function can be written as</p>
<div class="math notranslate nohighlight" id="equation-index-27">
<span class="eqno">(28)<a class="headerlink" href="#equation-index-27" title="Permalink to this equation">¶</a></span>\[\begin{split}Z &amp;= \sum_{\{s_x\}} T_{s_1,s_2} T_{s_2,s_3} \dots T_{s_{L-1},s_L} T_{s_L,s_1}\\
  &amp;= \sum_{s_1} \left( T^L \right)_{s_1,s_1}\\
  &amp;= Tr (T^L)\end{split}\]</div>
<p>The transfer matrix describes the contribution to the energy between two connected
spins, <span class="math notranslate nohighlight">\(s\)</span> and <span class="math notranslate nohighlight">\(s'\)</span>.</p>
<p>Writing the matrix explicitly,</p>
<div class="math notranslate nohighlight" id="equation-index-28">
<span class="eqno">(29)<a class="headerlink" href="#equation-index-28" title="Permalink to this equation">¶</a></span>\[\begin{split}T_{s,s'} =
\left (\begin{matrix}
e^{\beta+h} &amp; e^{-\beta} \\
e^{-\beta} &amp; e^{\beta-h}
\end{matrix} \right )\end{split}\]</div>
<p>We can evaluate the trace by diagonalizing <span class="math notranslate nohighlight">\(T\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-index-29">
<span class="eqno">(30)<a class="headerlink" href="#equation-index-29" title="Permalink to this equation">¶</a></span>\[\begin{split}&amp; \det \left (\begin{matrix}
e^{\beta+h} -\lambda &amp; e^{-\beta} \\
e^{-\beta} &amp; e^{\beta-h} -\lambda
\end{matrix} \right )
= \left(e^{\beta+h}-\lambda\right) \left(e^{\beta-h}-\lambda\right) - e^{-2\beta}\\
&amp; \lambda_{\pm} = e^\beta \left ( \cosh(h) \pm \sqrt{ \sinh^2(h)+e^{-4\beta} }\right )\end{split}\]</div>
<div class="math notranslate nohighlight" id="equation-index-30">
<span class="eqno">(31)<a class="headerlink" href="#equation-index-30" title="Permalink to this equation">¶</a></span>\[\begin{split}\log(Z) &amp;= \log \left( Tr \left (\begin{matrix}
\lambda_+ &amp; 0 \\
0&amp; \lambda_-
\end{matrix} \right )^L\right)
= \log\left( \lambda_+^L + \lambda_-^L \right)\\
&amp;= \log\left( \lambda_+^L \left(1+\left(\frac{\lambda_-}{\lambda_+}\right)^L \right ) \right)\\
&amp;= \log\left( \lambda_+^L \right ) + \log\left ( 1+\left(\frac{\lambda_-}{\lambda_+}\right)^L \right)\\\end{split}\]</div>
<p>In the thermodynamic limit, <span class="math notranslate nohighlight">\(L\to\infty\)</span>,</p>
<div class="math notranslate nohighlight" id="equation-index-31">
<span class="eqno">(32)<a class="headerlink" href="#equation-index-31" title="Permalink to this equation">¶</a></span>\[\left(\frac{\lambda_-}{\lambda_+}\right)^L \to 0\]</div>
<p>and</p>
<div class="math notranslate nohighlight" id="equation-index-32">
<span class="eqno">(33)<a class="headerlink" href="#equation-index-32" title="Permalink to this equation">¶</a></span>\[\log(Z) = \log(\lambda_+) = L\log \left( \cosh(h) + \sqrt{1 + \sinh^2(h)+e^{-4\beta}} \right ) + L\beta\]</div>
<p>From here we can calculate the magnetization as a function of <span class="math notranslate nohighlight">\(h\)</span></p>
<div class="math notranslate nohighlight" id="equation-index-33">
<span class="eqno">(34)<a class="headerlink" href="#equation-index-33" title="Permalink to this equation">¶</a></span>\[\begin{split}&lt;M&gt; &amp;= \frac 1L \frac \partial {\partial h} \log(Z)
= \frac{\sinh(h) + \frac{\cosh(h) \sinh(h)}{\sqrt{\sinh^2(h)+e^{-4\beta}} }}{\cosh(h)+\sqrt{\sinh^2(h)+e^{-4\beta}} }\\
&amp;= \frac{\sinh(h)}{\sqrt{\sinh^2(h)+e^{-4\beta}} }\end{split}\]</div>
<p>So at <span class="math notranslate nohighlight">\(h=0\)</span> the magnetization is zero, which is what we expect. At large <span class="math notranslate nohighlight">\(\beta\)</span>, small temperature, it approaches one, which is also expected. Here is a sketch of its behavior in general:</p>
<img src="_static/ising_solutions.svg"></div>
<div class="section" id="phase-transitions">
<h3>Phase transitions<a class="headerlink" href="#phase-transitions" title="Permalink to this headline">¶</a></h3>
<p><strong>Global symmetries</strong></p>
<p>The action</p>
<div class="math notranslate nohighlight" id="equation-index-34">
<span class="eqno">(35)<a class="headerlink" href="#equation-index-34" title="Permalink to this equation">¶</a></span>\[S = -\beta \sum_{&lt;ij&gt;} s_i \cdot s_j - h\cdot \sum_i s_i\]</div>
<p>has global symmetries when <span class="math notranslate nohighlight">\(h=0\)</span>. There are transformations <span class="math notranslate nohighlight">\(M\)</span> that can be applied to all spins without changing the action. More precisely, <span class="math notranslate nohighlight">\(S(s)\)</span> and <span class="math notranslate nohighlight">\(ds\)</span> remain constant when</p>
<div class="math notranslate nohighlight" id="equation-index-35">
<span class="eqno">(36)<a class="headerlink" href="#equation-index-35" title="Permalink to this equation">¶</a></span>\[s_i \to s_i' = Ms_i, \textrm{ for all } i.\]</div>
<ul>
<li><p><strong>Ising:</strong></p>
<div class="math notranslate nohighlight" id="equation-index-36">
<span class="eqno">(37)<a class="headerlink" href="#equation-index-36" title="Permalink to this equation">¶</a></span>\[s_i\to -s_i\]</div>
</li>
<li><p><strong>Potts Model:</strong></p>
<div class="math notranslate nohighlight" id="equation-index-37">
<span class="eqno">(38)<a class="headerlink" href="#equation-index-37" title="Permalink to this equation">¶</a></span>\[s_i\to (s_i+1)\bmod N_s\]</div>
<p>(and other permutations)</p>
</li>
<li><p><strong>O(N) Model:</strong></p>
<div class="math notranslate nohighlight" id="equation-index-38">
<span class="eqno">(39)<a class="headerlink" href="#equation-index-38" title="Permalink to this equation">¶</a></span>\[s_i\to Ms_i,\]</div>
<p>where <span class="math notranslate nohighlight">\(M\)</span> is a <span class="math notranslate nohighlight">\(N\times N\)</span> matrix with</p>
<div class="math notranslate nohighlight" id="equation-index-39">
<span class="eqno">(40)<a class="headerlink" href="#equation-index-39" title="Permalink to this equation">¶</a></span>\[M^T M = I.\]</div>
<p>So M is an orthogonal matrix: <span class="math notranslate nohighlight">\(M^{-1} = M^T\)</span>. It belongs to the group of <span class="math notranslate nohighlight">\(N\times N\)</span> orthogonal matrices, <span class="math notranslate nohighlight">\(M\in O(N)\)</span></p>
</li>
</ul>
<blockquote>
<div><p>The interaction term is invariant since</p>
<div class="math notranslate nohighlight" id="equation-index-40">
<span class="eqno">(41)<a class="headerlink" href="#equation-index-40" title="Permalink to this equation">¶</a></span>\[\begin{split}s_i \cdot s_j = (s_i)_\alpha (s_j)\alpha = \to M_{\alpha,\beta} (s_i)_\beta  M_{\beta,\gamma} (s_j)\gamma \\
= s_i M^T M s_j = s_i s_j\end{split}\]</div>
<p>If <span class="math notranslate nohighlight">\(h\neq 0\)</span>, the symmetry is “broken”:</p>
<div class="math notranslate nohighlight" id="equation-index-41">
<span class="eqno">(42)<a class="headerlink" href="#equation-index-41" title="Permalink to this equation">¶</a></span>\[h \cdot s_i \to (h)_\alpha M_{\alpha,\beta} (s_i)_\beta \neq h \cdot s_i\]</div>
<p>We also need to check the integration measure <span class="math notranslate nohighlight">\(ds\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-index-42">
<span class="eqno">(43)<a class="headerlink" href="#equation-index-42" title="Permalink to this equation">¶</a></span>\[\begin{split}&amp;\int_{|s_i|=1} d^Vs_i = \int d^Vs_i \delta(|s_i|-1)\\
&amp;\to \int d^Vs'_i \delta(|s'_i|-1) =
\int d^Vs_i \left \| \frac{ds'}{ds} \right \| \delta(|Ms'_i|-1)
\\
&amp;= \int d^Vs_i | \det(M) | \delta(|Ms'_i|-1)\\
&amp;= \int d^Vs_i \delta(|Ms'_i|-1)\end{split}\]</div>
<p>So the measure is also invariant, and the model is invariant at <span class="math notranslate nohighlight">\(h\neq 0\)</span>.</p>
</div></blockquote>
<p><strong>Symmetry breaking</strong></p>
<p>Consider the model at <span class="math notranslate nohighlight">\(h=0\)</span> and finite <span class="math notranslate nohighlight">\(V\)</span>. Since the model has a global <span class="math notranslate nohighlight">\(O(N)\)</span> symmetry, it is symmetric under</p>
<div class="math notranslate nohighlight" id="equation-index-43">
<span class="eqno">(44)<a class="headerlink" href="#equation-index-43" title="Permalink to this equation">¶</a></span>\[s_i \to M s_i = -s_i (-I \in O(N)).\]</div>
<p>However the magnetization</p>
<div class="math notranslate nohighlight" id="equation-index-44">
<span class="eqno">(45)<a class="headerlink" href="#equation-index-44" title="Permalink to this equation">¶</a></span>\[&lt;M&gt; = \frac{\int [ds] \sum_i s_i e^{-S}}{Z}\]</div>
<p>is not symmetric,</p>
<div class="math notranslate nohighlight" id="equation-index-45">
<span class="eqno">(46)<a class="headerlink" href="#equation-index-45" title="Permalink to this equation">¶</a></span>\[&lt;M&gt; \to -&lt;M&gt;.\]</div>
<p>Therefore we always have</p>
<div class="math notranslate nohighlight" id="equation-index-46">
<span class="eqno">(47)<a class="headerlink" href="#equation-index-46" title="Permalink to this equation">¶</a></span>\[&lt;M&gt; =0.\]</div>
<ul class="simple">
<li><p>On a finite lattice the symmetry is <em>restored</em> and the model is in a <em>disordered phase</em>.</p></li>
<li><p>If <span class="math notranslate nohighlight">\(h\neq 0\)</span> the symmetry is explicitly broken and <span class="math notranslate nohighlight">\(&lt;M&gt;\neq 0\)</span></p></li>
</ul>
<p>Non-trivial symmetry breaking happens in the thermodynamic limit, <span class="math notranslate nohighlight">\(V\to 0\)</span>.
The symmetry is spontaneously broken if</p>
<div class="math notranslate nohighlight" id="equation-index-47">
<span class="eqno">(48)<a class="headerlink" href="#equation-index-47" title="Permalink to this equation">¶</a></span>\[\lim_{h\to 0} \left[ \lim_{V\to\infty} &lt;M&gt; \right ] \neq 0\]</div>
<p>The order of the limits is important here. If the limit <span class="math notranslate nohighlight">\(h\to0\)</span> is taken too quickly the magnetization will approach <span class="math notranslate nohighlight">\(0\)</span>.</p>
<ul class="simple">
<li><p>The 1D Ising model the symmetry is <em>not</em> spontaneously broken.</p></li>
</ul>
<div class="math notranslate nohighlight" id="equation-index-48">
<span class="eqno">(49)<a class="headerlink" href="#equation-index-48" title="Permalink to this equation">¶</a></span>\[\lim_{N\to\infty} &lt;M&gt; =  \frac{\sinh(h)}{\sqrt{\sinh^2 + e^{-4\beta}}}\]</div>
<ul class="simple">
<li><p>At <span class="math notranslate nohighlight">\(D&gt;1\)</span> the symmetry is broken at <span class="math notranslate nohighlight">\(T&gt;T_c\)</span>, or <span class="math notranslate nohighlight">\(\beta &lt; \beta_c\)</span>.</p></li>
</ul>
<p><strong>Phase transitions</strong></p>
<p>In many models we have a broken symmetry at <span class="math notranslate nohighlight">\(\beta &gt; \beta_c\)</span> and a restored symmetry at <span class="math notranslate nohighlight">\(\beta &lt; \beta_c\)</span>. This means there is a phase transition at <span class="math notranslate nohighlight">\(\beta=\beta_c\)</span></p>
<blockquote>
<div><ul>
<li><p><strong>First order</strong>
One or more of the first derivatives of the free energy</p>
<div class="math notranslate nohighlight" id="equation-index-49">
<span class="eqno">(50)<a class="headerlink" href="#equation-index-49" title="Permalink to this equation">¶</a></span>\[F=-\frac{1}{\beta}\log(Z)\]</div>
<p>is discontinuous:</p>
<div class="math notranslate nohighlight" id="equation-index-50">
<span class="eqno">(51)<a class="headerlink" href="#equation-index-50" title="Permalink to this equation">¶</a></span>\[&lt;E&gt; = \frac{\partial}{\partial\beta} \beta F\]</div>
<div class="math notranslate nohighlight" id="equation-index-51">
<span class="eqno">(52)<a class="headerlink" href="#equation-index-51" title="Permalink to this equation">¶</a></span>\[&lt;M&gt; = -\frac 1V \frac{\partial}{\partial h} \beta F\]</div>
<img src="_static/transition_1.svg"><p>The jump in energy is known as the latent heat</p>
<div class="math notranslate nohighlight" id="equation-index-52">
<span class="eqno">(53)<a class="headerlink" href="#equation-index-52" title="Permalink to this equation">¶</a></span>\[\frac 1V \Delta E = \lim_{\beta\to_-\beta_c}&lt;E&gt; - \lim_{\beta\to_+\beta_c}&lt;E&gt; = \frac{E_- - E_+}{V}\]</div>
<p>How does this work on the lattice? The transition is not instantaneous,
but gets smoothed over a small span of temperatures.
The derivative of the energy in fact grows with the volume.</p>
<div class="math notranslate nohighlight" id="equation-index-53">
<span class="eqno">(54)<a class="headerlink" href="#equation-index-53" title="Permalink to this equation">¶</a></span>\[\chi = \frac 1V \left&lt;(E-&lt;E&gt;)^2\right&gt;\]</div>
<p>At <span class="math notranslate nohighlight">\(\beta=\beta_c\)</span>, <span class="math notranslate nohighlight">\(&lt;E&gt;\approx \frac 12 (E_+ + E_-)\)</span>, so</p>
<div class="math notranslate nohighlight" id="equation-index-54">
<span class="eqno">(55)<a class="headerlink" href="#equation-index-54" title="Permalink to this equation">¶</a></span>\[\chi \approx \frac 1V \frac{\Delta E^2}{4}
= V \frac 14 \left( \frac{\Delta E}{V} \right)^2 \sim V\]</div>
<p>In a first order transition the two phases can coexist, such as ice and water. The average energy density in this state is between the two phases.</p>
</li>
<li><p><strong>Second order</strong></p>
<p>No discontinuity in the first derivative of the free energy,
but there is a discontinuity in the second derivative.
This is the case in spin models.
The derivative of magnetization</p>
<div class="math notranslate nohighlight" id="equation-index-55">
<span class="eqno">(56)<a class="headerlink" href="#equation-index-55" title="Permalink to this equation">¶</a></span>\[\frac{\partial}{\partial_h}&lt;M&gt; \neq 0\]</div>
<p>is discontinuous.</p>
<img src="_static/transition_2.svg"></li>
</ul>
</div></blockquote>
<div class="section" id="critical-phenomena">
<h4>Critical Phenomena:<a class="headerlink" href="#critical-phenomena" title="Permalink to this headline">¶</a></h4>
<p>The correlation length <span class="math notranslate nohighlight">\(\xi\)</span> diverges exponentially at <span class="math notranslate nohighlight">\(\beta_c\)</span>.
Structures scale to all distances:</p>
<p>Writing <span class="math notranslate nohighlight">\(\tau = \beta-\beta_c\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-index-56">
<span class="eqno">(57)<a class="headerlink" href="#equation-index-56" title="Permalink to this equation">¶</a></span>\[\begin{split}\chi &amp;\sim |\tau |^{-\alpha} \\
\chi_M &amp;\sim |\tau |^{-\gamma} \\
\xi &amp;\sim |\tau |^{-\nu}\end{split}\]</div>
<div class="math notranslate nohighlight" id="equation-index-57">
<span class="eqno">(58)<a class="headerlink" href="#equation-index-57" title="Permalink to this equation">¶</a></span>\[\begin{split}&lt;M&gt; &amp;= 0 \textrm{ at } \beta \leq \beta_c \textrm{ and }\\
&lt;M&gt; &amp;\sim |\tau|^\delta \textrm{ at } \beta &gt; \beta_c\end{split}\]</div>
<p>The critical exponents are characteristic to the symmetries and dimensionality of the model.
This is an important property of higher order transitions known as universality.
It allows us to construct lattice models of continuous systems.
More on this later.</p>
<blockquote>
<div><ul class="simple">
<li><p>Potts model in 2D (Including Ising)
Has a phase transition at <span class="math notranslate nohighlight">\(\beta=\log(1+\sqrt(q))\)</span>.
It is second order when <span class="math notranslate nohighlight">\(q\leq 4\)</span> and first order otherwise.
This is a discrete symmetry, in 2D continuous symmetries do not break (Mermin-Wagner-Coleman theorem).</p></li>
<li><p>O(N) model in 2D
No symmetry breaking transition due to Mermin-Wagner-Coleman.</p></li>
<li><p>XY model in 2D
Has a special Berezinskii–Kosterlitz–Thouless transition, <span class="math notranslate nohighlight">\(\infty\)</span> order with symmetry restored on both sides.</p></li>
<li><p>O(N) in 3D
Has a 2nd order transition. The critical exponents have been determined numerically.</p></li>
<li><p>Potts model in 3D
First order when <span class="math notranslate nohighlight">\(q\geq 3\)</span>, otherwise second.</p></li>
<li><p>O(N) in 4 or more dimensions
Second order transition with <em>mean field</em> exponents. These can be calculated analytically.</p></li>
</ul>
</div></blockquote>
<p>In the O(N), Ising and Potts models, there is also a first order transition
when <span class="math notranslate nohighlight">\(\beta &gt; \beta_c\)</span> <span class="math notranslate nohighlight">\(h\neq 0\)</span>, if we change <span class="math notranslate nohighlight">\(h\)</span> continuously across <span class="math notranslate nohighlight">\(0\)</span>.</p>
<ul class="simple">
<li><p><strong>Crossover</strong></p></li>
</ul>
<p>Crossover is a term for a transition, where no symmetry is broken and / or
there is no discontinuity in the derivative of the free energy.
The transition is continuous and there is no well defined critical
temperature, but the two phases are nevertheless distinct.</p>
</div>
</div>
</div>
<div class="section" id="field-theories">
<h2>Field theories<a class="headerlink" href="#field-theories" title="Permalink to this headline">¶</a></h2>
<div class="section" id="quantum-field-theories">
<h3>Quantum Field Theories<a class="headerlink" href="#quantum-field-theories" title="Permalink to this headline">¶</a></h3>
<p>Quantum field theory is a huge field and introducing it properly is outside the scope of this
course. In short, quantum field theory unifies the <em>special</em> theory of relativity and quantum mechanics.
This is not an easy task for point particles, but
it turns out you the quantum mechanical version of relativistic electromagnetism works.
Quantum field theory builds on this observation and uses field theories to describe other particles
as well.</p>
<p>Let’s consider a scalar field theory is Minkowsky spacetime (the field <span class="math notranslate nohighlight">\(\phi\)</span> could also represent a more complicated set of fields). Given the action</p>
<div class="math notranslate nohighlight" id="equation-index-58">
<span class="eqno">(59)<a class="headerlink" href="#equation-index-58" title="Permalink to this equation">¶</a></span>\[S = \int d^3 dt \mathcal L(\phi,\partial_t \phi) = \int d^3 dt \left [ \frac 12 \partial_\mu \phi \partial^\mu\phi - V(\phi) \right ]\]</div>
<p>The classical equations of motion are found by minimizing the action, which leads to the
Euler-Lagrange equation</p>
<div class="math notranslate nohighlight" id="equation-index-59">
<span class="eqno">(60)<a class="headerlink" href="#equation-index-59" title="Permalink to this equation">¶</a></span>\[\partial_\mu \frac{\delta L}{\delta(\partial_\mu \phi)} - \frac{\delta L}{\delta \phi} = 0.\]</div>
<p>In this case we find the Klein-Gordon equation</p>
<div class="math notranslate nohighlight" id="equation-index-60">
<span class="eqno">(61)<a class="headerlink" href="#equation-index-60" title="Permalink to this equation">¶</a></span>\[\partial_\mu \partial^\mu \phi = -\frac{dV(\phi)}{d\phi}.\]</div>
<p>The classical Hamiltonian is obtained by a Legendre transformation</p>
<div class="math notranslate nohighlight" id="equation-index-61">
<span class="eqno">(62)<a class="headerlink" href="#equation-index-61" title="Permalink to this equation">¶</a></span>\[\int d^3xdt H = \int d^3xdt\left [  \pi\dot\phi-\mathcal L \right ],\]</div>
<p>where <span class="math notranslate nohighlight">\(\pi = \delta \mathcal L/\delta\dot\phi\)</span> is the canonical momentum, and</p>
<div class="math notranslate nohighlight" id="equation-index-62">
<span class="eqno">(63)<a class="headerlink" href="#equation-index-62" title="Permalink to this equation">¶</a></span>\[H(\phi,\pi) = \pi^2 +\frac 12 (\partial_i\phi)^2 + V(\phi).\]</div>
<p>In quantum field theory, we consider the Hilbert space of states <span class="math notranslate nohighlight">\(\ket{\phi,\pi}\)</span>.
These evolve according to the Schrödinger equation</p>
<div class="math notranslate nohighlight" id="equation-index-63">
<span class="eqno">(64)<a class="headerlink" href="#equation-index-63" title="Permalink to this equation">¶</a></span>\[i\hbar\partial_t \ket{\phi,\pi} = \hat H \ket{\phi,\pi}.\]</div>
<p>Here the Hamilton operator is</p>
<div class="math notranslate nohighlight" id="equation-index-64">
<span class="eqno">(65)<a class="headerlink" href="#equation-index-64" title="Permalink to this equation">¶</a></span>\[\hat H \ket{\phi,\pi} = H(\phi,\pi) \ket{\phi,\pi}.\]</div>
<p>The expectation value of a measurable that depends on the fields <span class="math notranslate nohighlight">\(\phi\)</span> and <span class="math notranslate nohighlight">\(\pi\)</span>
is</p>
<div class="math notranslate nohighlight" id="equation-index-65">
<span class="eqno">(66)<a class="headerlink" href="#equation-index-65" title="Permalink to this equation">¶</a></span>\[\Braketmid{\phi,\pi}{O(\phi,\pi)}{\phi,\pi}\]</div>
<p>and</p>
<div class="math notranslate nohighlight" id="equation-index-66">
<span class="eqno">(67)<a class="headerlink" href="#equation-index-66" title="Permalink to this equation">¶</a></span>\[\begin{split}&amp;\int \left[\prod_x d\phi({\bf x})\right] \ket{\phi}\bra{\phi} = 1\\
&amp;\int \left[\prod_x \frac {d\pi({\bf x})}{2\pi} \right] \ket{\pi}\bra{\pi} = 1\\
&amp;\Braket{\pi}{\phi} = e^{i\int d^3xdt \pi({\bf x})\phi({\bf x})}\end{split}\]</div>
<p>We also define field operators</p>
<div class="math notranslate nohighlight" id="equation-index-67">
<span class="eqno">(68)<a class="headerlink" href="#equation-index-67" title="Permalink to this equation">¶</a></span>\[\begin{split}&amp;\hat \phi({\bf x}) \ket{\phi} = \phi({\bf x}) \ket{\phi}\\
&amp;\hat \pi({\bf x}) \ket{\pi} = \pi({\bf x}) \ket{\pi}\\
&amp;[\hat\phi({\bf x}),\hat\phi({\bf x}')] = -i\delta^3({\bf x} - {\bf x}') \\\end{split}\]</div>
<p>We can formally solve the Schrödinger equation to find the time evolution operator</p>
<div class="math notranslate nohighlight" id="equation-index-68">
<span class="eqno">(69)<a class="headerlink" href="#equation-index-68" title="Permalink to this equation">¶</a></span>\[U(t)=e^{\frac{i}{\hbar}\hat H t}.\]</div>
<p>In this representation, we can define a partition function analogically to classical statistics,</p>
<div class="math notranslate nohighlight" id="equation-index-69">
<span class="eqno">(70)<a class="headerlink" href="#equation-index-69" title="Permalink to this equation">¶</a></span>\[Z = \textrm{Tr} e^{\frac{i}{\hbar}\hat H t} = \int d\phi \left&lt;\phi\left| e^{\frac{i}{\hbar} \hat H t} \right|\phi\right&gt;.\]</div>
<p>From here we could derive the Feynman path integral representation by
evolving the a field configuration <span class="math notranslate nohighlight">\(\bra{\phi,\pi}\)</span> by small time steps <span class="math notranslate nohighlight">\(\delta t\)</span> and
taking the limit <span class="math notranslate nohighlight">\(\delta t\to 0\)</span>. Here we will skip the derivation and simply introduce the result.
Then we will follow essentially the same steps in field theory at thermal equilibrium.</p>
</div>
<div class="section" id="the-path-integral-representation">
<h3>The Path Integral Representation<a class="headerlink" href="#the-path-integral-representation" title="Permalink to this headline">¶</a></h3>
<p>First, let us quickly introduce the path integral representation in Minkowsky space. We will not
derive this, since the derivation is essentially the same in thermal field theory and we will do
it there.
The expectation value of an observable is</p>
<div class="math notranslate nohighlight" id="equation-pathintegral">
<span class="eqno">(71)<a class="headerlink" href="#equation-pathintegral" title="Permalink to this equation">¶</a></span>\[\begin{split}&amp;&lt;O&gt; = \frac{1}{Z} \int \left [ \prod_x d\phi(x) \right ] O(\phi) e^{\frac{i}{\hbar} S(\phi)} \\
&amp; \textrm{ where } Z= \int \left [ \prod_x d\phi(x) \right ]e^{\frac{i}{\hbar} S(\phi)}\\
&amp; \textrm{ and } S=\int d^4x \mathcal L (\phi)\end{split}\]</div>
<p>Or using natural units <span class="math notranslate nohighlight">\(\hbar = 1\)</span></p>
<div class="math notranslate nohighlight" id="equation-index-70">
<span class="eqno">(72)<a class="headerlink" href="#equation-index-70" title="Permalink to this equation">¶</a></span>\[Z = \left [ \prod_x d\phi(x) \right ] e^{i S(\phi)}\]</div>
<p>This is similar to the representation of thermodynamics used above.
We can write observables using source fields,</p>
<div class="math notranslate nohighlight" id="equation-index-71">
<span class="eqno">(73)<a class="headerlink" href="#equation-index-71" title="Permalink to this equation">¶</a></span>\[\begin{split}Z(J) &amp;= \left [ \prod_x d\phi(x) \right ] e^{i \left (S(\phi) + J(x) \phi(x) \right ) }\\
&lt;\phi(x)&gt; &amp;= \left . \frac{\partial}{i\partial J(x)}\right |_{J=0} \log( Z(J) ) \\
&lt;\phi(x) \phi(y)&gt; &amp;= \left . \frac{\partial}{i\partial J(x)} \frac{\partial}{i\partial J(y)}\right |_{J=0} \log( Z(J) ) \\
&amp;= \frac 1Z \int \left [ d\phi \right ] \phi(x) \phi(y) e^{iS} - &lt;\phi(x)&gt;^2\end{split}\]</div>
<p>There are no state vectors or operators in the path integral representation. Instead, the variables closely
resemble classical fields. The difference is the integral over all possible field values, with a weight
defined by the action.</p>
<p>Now, since the fields are defined at all space-time locations, the integral measure</p>
<div class="math notranslate nohighlight" id="equation-index-72">
<span class="eqno">(74)<a class="headerlink" href="#equation-index-72" title="Permalink to this equation">¶</a></span>\[\prod_x d\phi(x)\]</div>
<p>is not well defined and needs to be regularized. This is a general problem with functional integrals.
Lattice field theory is a conceptually simple renormalization method:
we divide the volume into a lattice of discrete points <span class="math notranslate nohighlight">\(x\in aZ^4\)</span> and study a system with
a finite volume <span class="math notranslate nohighlight">\(V\)</span>.
Since the integral is now finite, we can in principle calculate is directly (brute force, with supercomputers,)
and get fully non-perturbative results.</p>
<p>The full theory is recovered by taking the infinite volume and continuum limit <span class="math notranslate nohighlight">\(v\to \infty, a\to0\)</span>.
The order of the limits is important here, just like for the spin models.</p>
<p>In practice the dimensionality of the integral grows quickly when increasing the volume and decreasing the lattice spacing.
In most cases the integral can be calculated directly only for lattice sizes that are practically useless.</p>
<p>Instead, we should use Monte Carlo methods.
The problem here is the complex, unimodular weight, <span class="math notranslate nohighlight">\(\exp(iS)\)</span>.
Every configuration <span class="math notranslate nohighlight">\(\{\phi\}\)</span> contributes with the same magnitude and result depends on cancellations between configurations.
However, this is (mostly) solved in the imaginary time formalism of thermal field theory.</p>
</div>
<div class="section" id="imaginary-time-path-integral">
<h3>Imaginary Time Path integral<a class="headerlink" href="#imaginary-time-path-integral" title="Permalink to this headline">¶</a></h3>
<p>In equilibrium at a finite temperature <span class="math notranslate nohighlight">\(T\)</span>, a quantum field theory follows the Gibbs ensemble:</p>
<div class="math notranslate nohighlight" id="equation-index-73">
<span class="eqno">(75)<a class="headerlink" href="#equation-index-73" title="Permalink to this equation">¶</a></span>\[Z = \textrm{Tr} e^{-\hat H/T} = \int d\phi \left&lt;\phi\left| e^{-\hat H/T} \right|\phi\right&gt;.\]</div>
<p>This is formally similar to the real time partition function above, with the replacement</p>
<div class="math notranslate nohighlight" id="equation-index-74">
<span class="eqno">(76)<a class="headerlink" href="#equation-index-74" title="Permalink to this equation">¶</a></span>\[\tau = it = 1/T\]</div>
<p>and is equivalent to quantum field theory in <em>Euclidean</em> spacetime.
The Hamiltonian and the Hilbert space remain unchanged.</p>
<p>It is convenient to start by discretizing the space.
We will do this in any case, since we want to end up with discrete spacetime, but this could be done later.</p>
<div class="math notranslate nohighlight" id="equation-index-75">
<span class="eqno">(77)<a class="headerlink" href="#equation-index-75" title="Permalink to this equation">¶</a></span>\[\begin{split}&amp;{\bf x} = a {\bf n}, n_i = 0...N_s,\\
&amp;\int d^3x \to a^3 \sum_x\\
&amp;\partial_i\phi \to \frac 1a \left[ \phi({\bf x}+{\bf e}_ia) -\phi(x) \right] = \Delta_i\phi({\bf x})\end{split}\]</div>
<p>The Hamiltonian in discrete space is</p>
<div class="math notranslate nohighlight" id="equation-index-76">
<span class="eqno">(78)<a class="headerlink" href="#equation-index-76" title="Permalink to this equation">¶</a></span>\[\hat H = a^3 \sum_x \left [ \hat \pi^2(x) + \frac 12 [\Delta_i \hat \phi(x)]^2 +V(\phi) \right ]\]</div>
<p>Now let’s consider the amplitude of the fields <span class="math notranslate nohighlight">\(\phi_A\)</span> and <span class="math notranslate nohighlight">\(\phi_B\)</span> in equilibrium at inverse temperature <span class="math notranslate nohighlight">\(\tau = 1/T\)</span> and split the time interval into N small sections</p>
<div class="math notranslate nohighlight" id="equation-index-77">
<span class="eqno">(79)<a class="headerlink" href="#equation-index-77" title="Permalink to this equation">¶</a></span>\[\begin{split}&amp;\left&lt;\phi_B \left|e^{-\tau \hat H}\right|\phi_A \right&gt; =
 \left&lt;\phi_B \left| \left(e^{-\tau/N \hat H}\right)^N\right|\phi_A \right&gt;\\
&amp;= \left&lt;\phi_B \left| \left(e^{-a_\tau \hat H}\right)^N\right|\phi_A \right&gt;\end{split}\]</div>
<p>In order to evaluate this, we insert the identity operators <span class="math notranslate nohighlight">\(1 = \int\left[\Pi_x\right]|\phi_x&gt;&lt;\phi_x|\)</span> and <span class="math notranslate nohighlight">\(\int\left[\Pi_x\right]|\pi_x&gt;&lt;\pi_x|\)</span>.</p>
<div class="math notranslate nohighlight" id="equation-index-78">
<span class="eqno">(80)<a class="headerlink" href="#equation-index-78" title="Permalink to this equation">¶</a></span>\[\begin{split}&amp;\left&lt;\phi_B \left|e^{-\tau \hat H}\right|\phi_A \right&gt; = \\
&amp;\int\left[\prod_{i=2}^N\prod_x d\phi_x\right]\left[\prod_{i=1}^N\prod_x d\pi_x \right]
\left&lt;\phi_B |\pi_N\right &gt; \left&lt;\pi_N |e^{-a_\tau \hat H}|\phi_N\right &gt; \\
&amp;\left&lt;\phi_N |\pi_{N-1}\right &gt; \left&lt;\pi_{N-1} |e^{-a_\tau \hat H}|\phi_{N-1}\right &gt;\dots
\left&lt;\phi_2 |\pi_{1}\right &gt; \left&lt;\pi_1 |e^{-a_\tau \hat H}|\phi_A\right &gt;\end{split}\]</div>
<p>Since the matrix in each exponential is small, we can expand the first few two and conclude that</p>
<div class="math notranslate nohighlight" id="equation-index-79">
<span class="eqno">(81)<a class="headerlink" href="#equation-index-79" title="Permalink to this equation">¶</a></span>\[\left&lt;\pi_n |e^{-a_\tau \hat H}|\phi_n\right &gt; =
e^{-a^3 a_\tau \sum_x \left( \frac 12 \pi_x^2 + \frac 12 (\Delta_i\phi_n)^2 + V[\phi_i]\right )} \left&lt; \pi_n |\phi_n \right&gt; + O(a_\tau^2)\]</div>
<p>and that</p>
<div class="math notranslate nohighlight" id="equation-index-80">
<span class="eqno">(82)<a class="headerlink" href="#equation-index-80" title="Permalink to this equation">¶</a></span>\[\begin{split}\left&lt;\phi_{n+1} | \pi_n\right &gt;\left&lt;\pi_n | \phi_n\right &gt; &amp;=
e^{ia^3 \sum_x \pi_n({\bf x})\phi_{n+1}({\bf x}) } e^{-ia^3 \sum_x \phi_n({\bf x})\pi_n({\bf x}) } \\
&amp;= e^{-ia^3 a_\tau \sum_x \pi_n({\bf x})\Delta_0\phi_n({\bf x}) }\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\Delta_0 = \frac {1}{a_\tau} \left( \phi_{n+1} - \phi_n \right)\)</span>.</p>
<p>Repeating this we can write the entire expression in terms of the field values <span class="math notranslate nohighlight">\(\phi_n\)</span> and <span class="math notranslate nohighlight">\(\pi_n\)</span> in discrete time.
Further, the integral over the field <span class="math notranslate nohighlight">\(\pi_n({\bf x})\)</span> is gaussian and
after performing that integral we are only left with <span class="math notranslate nohighlight">\(\phi_n\)</span>.</p>
<div class="math notranslate nohighlight" id="equation-index-81">
<span class="eqno">(83)<a class="headerlink" href="#equation-index-81" title="Permalink to this equation">¶</a></span>\[\begin{split}&amp;\int\left[\prod_x d\pi_n({\bf x}) \right]
e^{a^3 a_\tau \sum_x \left(-\frac 12 \pi_n({\bf x})^2 + (i\Delta_0\phi_n({\bf x})  \pi_n({\bf x})^2 \right) } \\
&amp;= \left(\frac{2\pi}{a^2a_\tau}\right)^{N_S^3/2}
e^{-a^3 a_\tau \sum_x \left(\Delta_0\phi_n({\bf x})\right)^2 }\end{split}\]</div>
<p>Now, after running through the same logic for all other <span class="math notranslate nohighlight">\(n\)</span>, we find the path integral</p>
<div class="math notranslate nohighlight" id="equation-index-82">
<span class="eqno">(84)<a class="headerlink" href="#equation-index-82" title="Permalink to this equation">¶</a></span>\[\left&lt;\phi_B \left| e^{-\tau \hat H}\right |\phi_A \right&gt; = \frac 1N  \int\left[\prod_x d\phi_n({\bf x}) \right] \phi_A(\tau_A) \phi_B(\tau_B) e^{ -S_E }\]</div>
<p>and</p>
<div class="note docutils container">
<div class="math notranslate nohighlight" id="equation-index-83">
<span class="eqno">(85)<a class="headerlink" href="#equation-index-83" title="Permalink to this equation">¶</a></span>\[S_E = a^3 a_\tau \sum_x \left (\frac 12 \Delta_\mu \phi \right )^2 + V[\phi]\]</div>
</div>
<p>In the continuum limit we would have</p>
<div class="math notranslate nohighlight" id="equation-index-84">
<span class="eqno">(86)<a class="headerlink" href="#equation-index-84" title="Permalink to this equation">¶</a></span>\[S_E = \int d^4x \left (\frac 12 \partial_\mu \phi \right)^2 + V[\phi]\]</div>
</div>
<div class="section" id="finite-temperature">
<h3>Finite Temperature<a class="headerlink" href="#finite-temperature" title="Permalink to this headline">¶</a></h3>
<p>So the path integral formulation in thermal equilibrium has the same form as a
Euclidean field theory in four dimensions.
Further we can now write the partition function as</p>
<div class="math notranslate nohighlight" id="equation-index-85">
<span class="eqno">(87)<a class="headerlink" href="#equation-index-85" title="Permalink to this equation">¶</a></span>\[\begin{split}Z &amp;= \int d\phi \left&lt;\phi\left| e^{ -\hat H / T } \right|\phi\right&gt;\\
  &amp;= \int \left[d\phi \right] e^{ - S_E(\phi)}\end{split}\]</div>
<p>The quantum statistical model in 3 dimensions corresponds to a classical statistical model
in 4 dimensions with periodic boundary conditions.</p>
<p>In summary</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Minkowsky</p></td>
<td><p>Euclidean</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\mathcal L_M\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\mathcal L_E = - \mathcal L_M|_{x_i \to ix_0; \partial_0 \to i\partial_0}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(g = (1,-1,-1,-1)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(g = (1,1,1,1)\)</span></p></td>
</tr>
</tbody>
</table>
<p><strong>Correlation functions</strong></p>
<p>The correlation functions of a classical theory are related to the Greens functions of the quantum field theory.
Earlier we used the “transfer matrix” <span class="math notranslate nohighlight">\(T\)</span>,</p>
<div class="math notranslate nohighlight" id="equation-index-86">
<span class="eqno">(88)<a class="headerlink" href="#equation-index-86" title="Permalink to this equation">¶</a></span>\[T_{\phi_{i+1},\phi_i} = \Braketmid{ \phi_{i+1} }{ e^{-a_\tau \hat H} }{ \phi_i }\]</div>
<p>We can write the partition function using the transfer matrix as</p>
<div class="math notranslate nohighlight" id="equation-index-87">
<span class="eqno">(89)<a class="headerlink" href="#equation-index-87" title="Permalink to this equation">¶</a></span>\[Z = \int \left [ d\phi \right ] e^{S_E} = Tr \left( T^{N_\tau} \right)\]</div>
<p>Now diagonalizing the transfer matrix <span class="math notranslate nohighlight">\(T\)</span> and labeling the eigenvalues as <span class="math notranslate nohighlight">\(\lambda_0, \lambda_1,\dots\)</span>,</p>
<div class="math notranslate nohighlight" id="equation-index-88">
<span class="eqno">(90)<a class="headerlink" href="#equation-index-88" title="Permalink to this equation">¶</a></span>\[Z = \sum_i \lambda_i^{N_\tau} = \lambda_0^{N_\tau} \left[ 1 + O((\lambda_1/\lambda_0)^{N_\tau}) + \dots \right]\]</div>
<p>Note that the eigenvalues <span class="math notranslate nohighlight">\(\lambda_i\)</span> are equal to <span class="math notranslate nohighlight">\(exp(E_i)\)</span>, where <span class="math notranslate nohighlight">\(E_i\)</span> are the eigenvalues of <span class="math notranslate nohighlight">\(\hat H\)</span>.
So <span class="math notranslate nohighlight">\(\lambda_0\)</span> corresponds to the lowest energy state, or the vacuum <span class="math notranslate nohighlight">\(|0&gt;\)</span>.</p>
<p>The two point function (with <span class="math notranslate nohighlight">\(i&gt;j\)</span>) in the path integral and operator representations is</p>
<div class="math notranslate nohighlight" id="equation-index-89">
<span class="eqno">(91)<a class="headerlink" href="#equation-index-89" title="Permalink to this equation">¶</a></span>\[&lt;\phi_i \phi_j&gt; = \frac 1Z \int\left[ d\phi \right] \phi_i \phi_j e^{-S_E}
= \frac 1Z Tr\left( T^{N_\tau-(i-j)} \hat\phi T^{i-j} \hat\phi  \right)\]</div>
<p>Introducing a time dependent operator</p>
<div class="math notranslate nohighlight" id="equation-index-90">
<span class="eqno">(92)<a class="headerlink" href="#equation-index-90" title="Permalink to this equation">¶</a></span>\[\hat \phi(\tau) = e^{\tau\hat H} \hat\phi e^{-\tau\hat H}\]</div>
<p>In the limit <span class="math notranslate nohighlight">\(N_\tau\to\infty\)</span> (and because <span class="math notranslate nohighlight">\(a_\tau(i-j) = \tau_i-\tau_j\)</span>),</p>
<div class="math notranslate nohighlight" id="equation-index-91">
<span class="eqno">(93)<a class="headerlink" href="#equation-index-91" title="Permalink to this equation">¶</a></span>\[&lt;\phi_i \phi_j&gt; = \Braketmid{ 0 }{ \hat\phi \left(\frac{T}{\lambda_0}\right)^{i-j} \hat\phi }{ 0 }
= \Braketmid{ 0 }{ \hat\phi(\tau_i) \hat\phi(\tau_j) }{ 0 }\]</div>
<p>Finally, if including also negative time separation <span class="math notranslate nohighlight">\(i-j\)</span>, we have</p>
<div class="math notranslate nohighlight" id="equation-index-92">
<span class="eqno">(94)<a class="headerlink" href="#equation-index-92" title="Permalink to this equation">¶</a></span>\[&lt;\phi_i \phi_j&gt; =\Braketmid{ 0 }{ \mathcal T \left[ \hat\phi(\tau_i) \hat\phi(\tau_j) \right] }{ 0 },\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathcal T\)</span> is the time ordering operator.</p>
<p><strong>Greens Function and the Mass Spectrum</strong></p>
<p>Any Greens function for an operator <span class="math notranslate nohighlight">\(\Gamma\)</span> can be expanded in terms of energy states
(eigenstates of the hamiltonian)</p>
<div class="math notranslate nohighlight" id="equation-index-93">
<span class="eqno">(95)<a class="headerlink" href="#equation-index-93" title="Permalink to this equation">¶</a></span>\[\begin{split}\Braketmid{ 0 }{ \Gamma(\tau) \Gamma^\dagger(0) }{ 0 }
&amp;= \frac 1Z \int\left[ d\phi \right ] \Gamma(\tau) \Gamma^\dagger(0) e^{-S}\\
&amp;= \Braketmid{ 0 }{ e^{\hat H \tau} \Gamma(0) e^{-\hat H \tau} \Gamma(0) }{ 0 }\\
&amp;= \sum_n  \Braketmid{ 0 }{ \Gamma(0) }{ E_n }  e^{-E_n \tau}  \Braketmid{ E_n }{ \Gamma(0) }{ 0 }\\
&amp;= \sum_n e^{-E_n\tau} \left| \Braketmid{ 0 }{ \Gamma(0) }{ E_n } \right|^2\end{split}\]</div>
<p>At long enough distances we find</p>
<div class="math notranslate nohighlight" id="equation-index-94">
<span class="eqno">(96)<a class="headerlink" href="#equation-index-94" title="Permalink to this equation">¶</a></span>\[\Braketmid{ 0 }{ \Gamma(\tau) \Gamma^\dagger(0) }{ 0 }
\to e^{-E_0\tau} \left| \Braketmid{ 0 }{ \Gamma(0) }{ E_0 } \right|^2,
\textrm{ when } \tau \to \infty\]</div>
<p>Here the state <span class="math notranslate nohighlight">\(E_0\)</span> is the lowest energy eigenstate that the operator <span class="math notranslate nohighlight">\(\Gamma(0)\)</span>
constructs out of the vacuum state and therefore the eigenvalue <span class="math notranslate nohighlight">\(E_0\)</span> is the mass of a
state with the same quantum numbers as <span class="math notranslate nohighlight">\(\Gamma(0)\)</span>.</p>
<p>This relation allows us to measure the masses of propagating composite states.
It is also useful for calculating certain more complicated observables, such as scattering lengths.</p>
<p><strong>Lattice Terminology</strong></p>
<p>We do computation on a lattice with a finite number of points, so a finite volume and finite lattice spacing.
In order to obtain results in a continuum model, we need to take two limits in order:</p>
<blockquote>
<div><ul class="simple">
<li><p><span class="math notranslate nohighlight">\(V \to \infty\)</span>: the <em>thermodynamic</em> limit</p></li>
<li><p><span class="math notranslate nohighlight">\(a \to 0\)</span>: the <em>continuum</em> limit</p></li>
</ul>
<ol class="arabic simple">
<li><p>Run simulations at fixed <span class="math notranslate nohighlight">\(a\)</span> and several <span class="math notranslate nohighlight">\(V\)</span>. Extrapolate to <span class="math notranslate nohighlight">\(V\to\infty\)</span></p></li>
<li><p>Do the previous with different values of <span class="math notranslate nohighlight">\(a\)</span> and extrapolate to <span class="math notranslate nohighlight">\(a\to 0\)</span></p></li>
</ol>
</div></blockquote>
<p>Often it is also easier to run simulations with unphysical parameters, such as quark mass in QCD
and take the limit <span class="math notranslate nohighlight">\(m_q \to m_{q,phys}\)</span></p>
<p>At <span class="math notranslate nohighlight">\(T=0\)</span></p>
<blockquote>
<div><ol class="arabic">
<li><p><span class="math notranslate nohighlight">\(V\to \infty\)</span></p>
<p><span class="math notranslate nohighlight">\(N_\tau,N_s\to\infty\)</span>, <span class="math notranslate nohighlight">\(a\)</span> constant</p>
</li>
<li><p>continuum:
<span class="math notranslate nohighlight">\(a\to 0\)</span></p></li>
</ol>
</div></blockquote>
<p>At <span class="math notranslate nohighlight">\(T&gt;0\)</span></p>
<blockquote>
<div><ol class="arabic">
<li><p><span class="math notranslate nohighlight">\(V\to \infty\)</span></p>
<p><span class="math notranslate nohighlight">\(N_s\to\infty\)</span>, <span class="math notranslate nohighlight">\(a\)</span> constant, <span class="math notranslate nohighlight">\(N_\tau a\)</span> constant</p>
</li>
<li><p>continuum:
<span class="math notranslate nohighlight">\(a\to 0\)</span>, <span class="math notranslate nohighlight">\(\frac 1T = aN_\tau\)</span> constant</p></li>
</ol>
</div></blockquote>
</div>
</div>
<div class="section" id="scalar-fields">
<h2>Scalar Fields<a class="headerlink" href="#scalar-fields" title="Permalink to this headline">¶</a></h2>
<div class="section" id="the-action">
<h3>The action<a class="headerlink" href="#the-action" title="Permalink to this headline">¶</a></h3>
<p>The continuum action of a free scalar field <span class="math notranslate nohighlight">\(\phi\)</span> in Euclidean space is</p>
<div class="math notranslate nohighlight" id="equation-index-95">
<span class="eqno">(97)<a class="headerlink" href="#equation-index-95" title="Permalink to this equation">¶</a></span>\[S = \int dx \frac 12 \sum_\mu \phi(x) \partial_\mu \partial_\mu \phi(x) + \frac 12 m^2\phi(x)^2\]</div>
<p>On a lattice we can define the d’Alembert operator as</p>
<div class="math notranslate nohighlight" id="equation-index-96">
<span class="eqno">(98)<a class="headerlink" href="#equation-index-96" title="Permalink to this equation">¶</a></span>\[\Box_{x,y} = \sum_\mu \frac {1}{a^2} \left( 2\delta_{x,y} - \delta_{x+\hat\mu,y}  - \delta_{x-\hat\mu,y}\right)\]</div>
<p>so that</p>
<div class="math notranslate nohighlight" id="equation-index-97">
<span class="eqno">(99)<a class="headerlink" href="#equation-index-97" title="Permalink to this equation">¶</a></span>\[\sum_y \Box_{x,y} \phi_y = -\Delta^2\phi = \sum_\mu \frac {1}{a^2} \left( 2\phi_x - \phi_{x-\hat\mu} - \phi_{x+\hat\mu} \right)\]</div>
<p>where <span class="math notranslate nohighlight">\(\hat\mu\)</span> is a basis vector of length <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> are vectors,
<span class="math notranslate nohighlight">\(x_\mu = an_\mu\)</span>
Using these definitions, we can write the lattice action as</p>
<div class="math notranslate nohighlight" id="equation-index-98">
<span class="eqno">(100)<a class="headerlink" href="#equation-index-98" title="Permalink to this equation">¶</a></span>\[S =  a^d \sum_x\left[ \frac 12 \sum_y \phi_x \Box_{x,y} \phi_y + \frac 12 m^2\phi_x^2 \right]\]</div>
<p>The partition function is Gaussian, <span class="math notranslate nohighlight">\(S=\frac12 \sum_{x,y} \phi_xM_{x,y}\phi_y\)</span>, and we can actually
do the integral</p>
<div class="math notranslate nohighlight" id="equation-index-99">
<span class="eqno">(101)<a class="headerlink" href="#equation-index-99" title="Permalink to this equation">¶</a></span>\[Z = \int \left[d\phi\right] e^{-S} = \left( \det \frac {M}{2\pi}  \right)^{-1/2}\]</div>
<p>While this looks like it should reproduce the continuum action when <span class="math notranslate nohighlight">\(a\to 0\)</span>, this is
actually a subtle issue. In this case things will work out, but once we get to fermions, we will see
how this can go wrong. In any case, we should check that our action produces the correct model in
continuum.</p>
</div>
<div class="section" id="scalar-field-theories">
<h3>Scalar Field Theories<a class="headerlink" href="#scalar-field-theories" title="Permalink to this headline">¶</a></h3>
<p>Most classes in field theories will introduce the <span class="math notranslate nohighlight">\(\phi^4\)</span>-theory:</p>
<div class="math notranslate nohighlight" id="equation-index-100">
<span class="eqno">(102)<a class="headerlink" href="#equation-index-100" title="Permalink to this equation">¶</a></span>\[\begin{split}L_4(\phi) &amp;= \sum_x \left [ \frac 12 \sum_y \phi_x \Box_{x,y} \phi_y + \frac 12 m^2\phi_x^2
    + \frac{\lambda}{4!} \phi_x^4 \right ] \\
Z &amp;= \int [d\phi] e^{-L_4(\phi)}\end{split}\]</div>
<p>The Higgs field is a complex scalar field, <span class="math notranslate nohighlight">\(\phi_x\)</span> is a complex number.
The partition function, excluding interactions with other standard
model fields is</p>
<div class="math notranslate nohighlight" id="equation-index-101">
<span class="eqno">(103)<a class="headerlink" href="#equation-index-101" title="Permalink to this equation">¶</a></span>\[\begin{split}L_H(\phi) &amp;= \sum_x \left [ \frac 12 \sum_y \phi^*_x \Box_{x,y} \phi_y - \mu^2\phi_x^2
    + \lambda \phi_x^4 \right ] \\
Z &amp;= \int [d\phi] e^{-L_H(\phi)}\end{split}\]</div>
<p>This is similar to the <span class="math notranslate nohighlight">\(\phi^4\)</span>-theory, but the <em>mass</em> term is negative. This leads
to a potential well at zero temperature. As a results, the Higgs model has a symmetry
breaking transition at a finite temperature.</p>
</div>
<div class="section" id="updating-scalar-fields">
<h3>Updating Scalar Fields<a class="headerlink" href="#updating-scalar-fields" title="Permalink to this headline">¶</a></h3>
<p>Scalar fields are continuous, represented by floating point numbers.
The most efficient update method depends on the theory, but the metropolis update
gives a very general method:</p>
<ol class="arabic simple">
<li><p>Choose a random field on a random site</p></li>
<li><p>Update the field by adding a random value <span class="math notranslate nohighlight">\(\Delta\)</span>. Gaussian distribution usually
works well. The parameter C is tunable.</p></li>
</ol>
<div class="math notranslate nohighlight" id="equation-index-102">
<span class="eqno">(104)<a class="headerlink" href="#equation-index-102" title="Permalink to this equation">¶</a></span>\[\phi'_x = \phi + C \Delta\]</div>
<ol class="arabic simple" start="3">
<li><p>accept or reject the change according to the metropolis probability.</p></li>
</ol>
<div class="math notranslate nohighlight" id="equation-index-103">
<span class="eqno">(105)<a class="headerlink" href="#equation-index-103" title="Permalink to this equation">¶</a></span>\[W_f(\phi_x \to \phi'_x) = min\left( 1, e^{- [ S(\phi'_x) - S(\phi_x) ]} \right )\]</div>
</div>
<div class="section" id="fourier-transforms">
<h3>Fourier Transforms<a class="headerlink" href="#fourier-transforms" title="Permalink to this headline">¶</a></h3>
<p>The discrete Fourier transform is</p>
<div class="math notranslate nohighlight" id="equation-index-104">
<span class="eqno">(106)<a class="headerlink" href="#equation-index-104" title="Permalink to this equation">¶</a></span>\[\tilde f(k) = \sum_x a^d e^{-ikx} f(x)\]</div>
<p>On a lattice with finite lattice spacing <span class="math notranslate nohighlight">\(a\)</span>, <span class="math notranslate nohighlight">\(x=an\)</span>, the momentum is periodic</p>
<div class="math notranslate nohighlight" id="equation-index-105">
<span class="eqno">(107)<a class="headerlink" href="#equation-index-105" title="Permalink to this equation">¶</a></span>\[\tilde f(k+2\pi m/a) = \tilde f(k)\]</div>
<p>and we can restrict it to the Brillouin zone, <span class="math notranslate nohighlight">\(-\pi &lt; ak_\mu \leq \pi\)</span></p>
<p>In infinite volume the inverse transform is</p>
<div class="math notranslate nohighlight" id="equation-index-106">
<span class="eqno">(108)<a class="headerlink" href="#equation-index-106" title="Permalink to this equation">¶</a></span>\[f(x) = \int_{-\pi/a}^{\pi/a}\frac{d^dk}{(2\pi)^d}e^{ikx}\tilde f(k)\]</div>
<p>It is often more convenient to use dimensionless units, where <span class="math notranslate nohighlight">\(x_\mu \in Z,\)</span>
<span class="math notranslate nohighlight">\(-\pi &lt; k_\mu \neq \pi\)</span>.</p>
<p>If the lattice is finite, the inverse transform depends on the boundary conditions.
With periodic boundaries, <span class="math notranslate nohighlight">\(x_\mu +aN = x\mu\)</span>, the allowed momenta are
<span class="math notranslate nohighlight">\(ak_\mu = \frac{2\pi}{N} n_\mu -\pi\)</span>, with <span class="math notranslate nohighlight">\(0&lt;n_\mu \leq N\)</span>.
The inverse transform is a sum over these momenta:</p>
<div class="math notranslate nohighlight" id="equation-index-107">
<span class="eqno">(109)<a class="headerlink" href="#equation-index-107" title="Permalink to this equation">¶</a></span>\[\begin{split}f(x) &amp;= \sum_k \frac {1}{(aN)^d} e^{ikx}\tilde f(k), \\
k_\mu &amp;=\frac{2\pi}{aN} n_\mu -\pi\end{split}\]</div>
<p>This approaches the integral form when <span class="math notranslate nohighlight">\(N\to \infty\)</span></p>
</div>
<div class="section" id="lattice-propagator">
<h3>Lattice Propagator<a class="headerlink" href="#lattice-propagator" title="Permalink to this headline">¶</a></h3>
<p>The scalar field propagator <span class="math notranslate nohighlight">\(G(x,y)\)</span> is the inverse (Greens function) of the operator
<span class="math notranslate nohighlight">\(a^{-d}M = (\Box + m^2)\)</span>,</p>
<div class="math notranslate nohighlight" id="equation-index-108">
<span class="eqno">(110)<a class="headerlink" href="#equation-index-108" title="Permalink to this equation">¶</a></span>\[\sum_y a^d ( \Box_{x,y} + \delta_{x,y} m^2 ) G(y,z) = \delta_{x,z}\]</div>
<p>Calculating Greens functions is often simplest by taking a Fourier transform:</p>
<div class="math notranslate nohighlight" id="equation-index-109">
<span class="eqno">(111)<a class="headerlink" href="#equation-index-109" title="Permalink to this equation">¶</a></span>\[\left [ \sum_\mu \frac {2}{a^2} (1-cos(k_\mu a)) + m^2 \right ] \tilde G(k) = 1\]</div>
<p>So the propagator is</p>
<div class="math notranslate nohighlight" id="equation-index-110">
<span class="eqno">(112)<a class="headerlink" href="#equation-index-110" title="Permalink to this equation">¶</a></span>\[\tilde G(k) = \frac{1}{\hat k^2 + m^2},\]</div>
<p>where <span class="math notranslate nohighlight">\(\hat k\)</span> is the lattice momentum</p>
<div class="math notranslate nohighlight" id="equation-index-111">
<span class="eqno">(113)<a class="headerlink" href="#equation-index-111" title="Permalink to this equation">¶</a></span>\[\hat k^2 = \sum_\mu \hat k_\mu^2
= \sum_\mu \left[ \frac 2 a \sin\left( \frac{ak_\mu}{2} \right) \right]^2\]</div>
<p>In the continuum limit we take <span class="math notranslate nohighlight">\(a\to 0\)</span> and</p>
<div class="math notranslate nohighlight" id="equation-index-112">
<span class="eqno">(114)<a class="headerlink" href="#equation-index-112" title="Permalink to this equation">¶</a></span>\[\begin{split}\hat k^2 &amp;= k^2 + O(a)\\
\tilde G(k) &amp;= \frac{1}{k^2+m^2} + O(a)\end{split}\]</div>
<p>In this case everything works well. The propagator behaves correctly in
the continuum and describes a single particle.</p>
<p><strong>Poles of the Propagator</strong></p>
<p>In Minkowsky spacetime the propagator has a pole at
<span class="math notranslate nohighlight">\(k_0^2 = k_ik^i + m^2\)</span> and this defines the dispersion
relation of a free particle.
In Euclidean time there is no pole since the square in the denominator
is always positive.</p>
<p>We can recover the pole structure using a Wick rotation back into
Minkowski space: <span class="math notranslate nohighlight">\(k_0^M \to ik_0^E\)</span>. This works since the propagator
has no poles in the quarter of complex space between <span class="math notranslate nohighlight">\(k_0^E\)</span> and
<span class="math notranslate nohighlight">\(k_0^M\)</span>.</p>
<div class="math notranslate nohighlight" id="equation-index-113">
<span class="eqno">(115)<a class="headerlink" href="#equation-index-113" title="Permalink to this equation">¶</a></span>\[\left[ \frac 2 a \sin\left( \frac{iak_0}{2} \right) \right]^2
+ \sum_i \hat k_i^2 + m^2
 = \left[ \frac 2 a \sinh\left( \frac{ak_0}{2} \right) \right]^2
+ \sum_i \hat k_i^2 + m^2 = 0\]</div>
<p>So</p>
<div class="math notranslate nohighlight" id="equation-index-114">
<span class="eqno">(116)<a class="headerlink" href="#equation-index-114" title="Permalink to this equation">¶</a></span>\[ak_0 = 2 \sinh^{-1} \sqrt{ \sum_i \sin^2\frac {ak_i}{2} + \frac{(am)^2}{4} }\]</div>
<p>Here is a comparison of the lattice and continuum propagators at <span class="math notranslate nohighlight">\(am=0.1\)</span></p>
<img src="_static/lattice_continuum_scalar_propagator.svg"><p><strong>N-point Functions</strong></p>
<p>The Greens functions can be generated using a source <span class="math notranslate nohighlight">\(J\)</span></p>
<div class="math notranslate nohighlight" id="equation-index-115">
<span class="eqno">(117)<a class="headerlink" href="#equation-index-115" title="Permalink to this equation">¶</a></span>\[S(J) = \sum_x a^d \left[ \frac 12 \phi_x (\Box + m^2) \phi_x - J_x \phi_x \right]\]</div>
<p>with</p>
<div class="math notranslate nohighlight" id="equation-index-116">
<span class="eqno">(118)<a class="headerlink" href="#equation-index-116" title="Permalink to this equation">¶</a></span>\[Z(J) = \int [d\phi] e^{-S(J)} = Z(0) e^{\sum_{x,y} a^{2d} \frac 12 J_x G(x,y) J_y}\]</div>
<p>This defines N-point functions</p>
<div class="math notranslate nohighlight" id="equation-index-117">
<span class="eqno">(119)<a class="headerlink" href="#equation-index-117" title="Permalink to this equation">¶</a></span>\[\ev{\phi_x,\dots,\phi_y} = \left . \frac{1}{Z(0)}
\frac{\partial}{\partial J_x} \cdots \frac{\partial}{\partial J_y}
Z(J) \right |_{J=0}\]</div>
</div>
</div>
<div class="section" id="monte-carlo-methods">
<h2>Monte Carlo Methods<a class="headerlink" href="#monte-carlo-methods" title="Permalink to this headline">¶</a></h2>
<p>Now let’s take a brief look at Markov Chain Monte Carlo algorithms.
We already used these in the Ising model example, but we need to go
over a bit more detail in order to analyze our results properly.</p>
<p><strong>Dartboard Example</strong></p>
<p>The dartboard example clarifies the general idea of the Monte Carlo method.
Monte Carlo is a general method for numerically evaluating an integral.
Say we need to calculate the area of a circle with unit radius.
The area is</p>
<div class="math notranslate nohighlight" id="equation-index-118">
<span class="eqno">(120)<a class="headerlink" href="#equation-index-118" title="Permalink to this equation">¶</a></span>\[V = \pi r^2 = \pi\]</div>
<p>But assume we don’t know this, but we do know the area of a square.
We can evaluate the are of any shape within the square by randomly throwing
darts into the square. The probability of a dart landing in the circle is</p>
<div class="math notranslate nohighlight" id="equation-index-119">
<span class="eqno">(121)<a class="headerlink" href="#equation-index-119" title="Permalink to this equation">¶</a></span>\[p(\textrm{hits inside circle}) = \frac{A_{circle}}{A_{square}} \approx
\frac{\textrm{number of hits inside circle}}{\textrm{number of hits inside square}}\]</div>
<div class="math notranslate nohighlight" id="equation-index-120">
<span class="eqno">(122)<a class="headerlink" href="#equation-index-120" title="Permalink to this equation">¶</a></span>\[\lim_{N\to\infty} \frac 1N \sum_{i=0}^N \delta({\bf x}_i \textrm{ in circle})
 = \frac{\pi}{4}\]</div>
<p>This method can be used to evaluate the area of any irregular shape as
long as we can determine whether the dart has landed inside it.</p>
<div class="section" id="monte-carlo-integration">
<h3>Monte Carlo integration<a class="headerlink" href="#monte-carlo-integration" title="Permalink to this headline">¶</a></h3>
<p>Now let’s take a look at a 1D integral</p>
<div class="math notranslate nohighlight" id="equation-index-121">
<span class="eqno">(123)<a class="headerlink" href="#equation-index-121" title="Permalink to this equation">¶</a></span>\[I = \int_a^b dx f(x)\]</div>
<p>We could take this to describe a shape inside a square and
draw random values on both x and y axis.
We would need to evaluate the function at x to determine whether
<span class="math notranslate nohighlight">\(y&lt;f(x)\)</span>.</p>
<div class="math notranslate nohighlight" id="equation-index-122">
<span class="eqno">(124)<a class="headerlink" href="#equation-index-122" title="Permalink to this equation">¶</a></span>\[\begin{split}I &amp;\approx \frac{(b-a)(y_{max}-y_{min})}{N} \sum_{i=0}^N \delta(y_i &lt; f(x_i))\\
&amp;\approx \frac{(b-a)(y_{max}-y_{min})}{N} \sum_{i=0}^N \frac{f(x_i)}{y_{max}-y_{min}}\\
&amp;\approx \frac{b-a}{N} \sum_{i=0}^N f(x_i)\end{split}\]</div>
<p>In the 1D case this this is not the most efficient method, but for large
dimensional integrals the error of this method scales favorably.
The other standard method for numerical integration is to split the domain
into equal pieces and sum them up, following a simple rule for each piece.
For example, if following the <em>trapezoidal rule</em>, the error scales as</p>
<div class="math notranslate nohighlight" id="equation-index-123">
<span class="eqno">(125)<a class="headerlink" href="#equation-index-123" title="Permalink to this equation">¶</a></span>\[\delta \sim \frac {1}{N^{2/D}}.\]</div>
<p>In error of the Monte Carlo method is statistical and it follows from the
<em>central limit theorem</em> that</p>
<div class="math notranslate nohighlight" id="equation-index-124">
<span class="eqno">(126)<a class="headerlink" href="#equation-index-124" title="Permalink to this equation">¶</a></span>\[\delta \sim \frac {1}{\sqrt{N}}.\]</div>
<p>We will not prove this here, but you can check it by calculating the
standard deviation in your own simulations.</p>
<div class="note docutils container">
<p><strong>Exercise</strong></p>
<ol class="arabic simple">
<li><p>Run a simulation of the Ising model and print out
a large number of measurements. Take the first 100, 200, 500
and  1000 measurements and check this follows the
inverse square root scaling.</p></li>
</ol>
</div>
<p>So the Monte Carlo method becomes more efficient around <span class="math notranslate nohighlight">\(D = 8\)</span>.
In a model with a single scalar field each site has a single spin, so
for a small <span class="math notranslate nohighlight">\(4\times4\times4\times4\)</span> lattice we already have</p>
<div class="math notranslate nohighlight" id="equation-index-125">
<span class="eqno">(127)<a class="headerlink" href="#equation-index-125" title="Permalink to this equation">¶</a></span>\[D = 4\times4\times4\times4 = 256\]</div>
<p>This result is true as long as the function and its square are
integrable</p>
<div class="math notranslate nohighlight" id="equation-index-126">
<span class="eqno">(128)<a class="headerlink" href="#equation-index-126" title="Permalink to this equation">¶</a></span>\[\begin{split}\int_0^1 f(x) = \textrm{finite}\\
\int_0^1 f^2(x) = \textrm{finite}\end{split}\]</div>
<p>This is true in lattice simulations, but here is a counterexample:</p>
<div class="math notranslate nohighlight" id="equation-index-127">
<span class="eqno">(129)<a class="headerlink" href="#equation-index-127" title="Permalink to this equation">¶</a></span>\[I=\int_0^1 \frac {1}{\sqrt{x}}\]</div>
<p>The mean and standard deviation from a Monte Carlo run are still
correct, but the error may not scale as inverse square root.</p>
</div>
<div class="section" id="importance-sampling">
<h3>Importance Sampling<a class="headerlink" href="#importance-sampling" title="Permalink to this headline">¶</a></h3>
<p>The Monte Carlo Method can be made even more efficient using importance sampling.
Again, we already do this in our example program.
We integrate</p>
<div class="math notranslate nohighlight" id="equation-index-128">
<span class="eqno">(130)<a class="headerlink" href="#equation-index-128" title="Permalink to this equation">¶</a></span>\[\int d\phi e^{-S}\]</div>
<p>The weight function of the Gibbs ensemble is exponentially peaked where S is
small. Further, <span class="math notranslate nohighlight">\(S\)</span>
is an extensive quantity, meaning it grows with the volume.
The function gets more peaked as the volume increases.
If we use completely random points in the Monte Carlo
estimate, most of the values will be very small and only a small
fraction will actually contribute to the integral.</p>
<p>Instead we should choose the random points from a distribution and mimics
the function we are integrating. This leads to more measurements
actually contributing to the result and reduces the variance.</p>
<p>Say we are integrating</p>
<div class="math notranslate nohighlight" id="equation-index-129">
<span class="eqno">(131)<a class="headerlink" href="#equation-index-129" title="Permalink to this equation">¶</a></span>\[I = \int dV f(x)\]</div>
<p>We choose to draw random numbers from the distribution <span class="math notranslate nohighlight">\(p(x)\)</span>.
The integral is</p>
<div class="math notranslate nohighlight" id="equation-index-130">
<span class="eqno">(132)<a class="headerlink" href="#equation-index-130" title="Permalink to this equation">¶</a></span>\[I = \int dV p(x) \frac{f(X)}{p(x)}
  = \lim_{N\to\infty} \frac 1N \sum_i \frac{f(x_i)}{p(x)}\]</div>
<p>If <span class="math notranslate nohighlight">\(p\)</span> is chosen well, the function <span class="math notranslate nohighlight">\(p/f\)</span> will be flatter
than the original and the variance of the result will be smaller. The
optimal choice would be to use <span class="math notranslate nohighlight">\(p(x) = C |f(x)|\)</span>.</p>
<p>Of course if it was that straightforward, we would always just draw from
the f(x). The problem is that f(x) is probably not a distribution, and to turn
it into one, we would need to calculate</p>
<div class="math notranslate nohighlight" id="equation-index-131">
<span class="eqno">(133)<a class="headerlink" href="#equation-index-131" title="Permalink to this equation">¶</a></span>\[C = \int dV f(x),\]</div>
<p>which is exactly the problem we are trying to solve.</p>
<p>In lattice simulations though, this is exactly what we do.
We are actually calculating</p>
<div class="math notranslate nohighlight" id="equation-index-132">
<span class="eqno">(134)<a class="headerlink" href="#equation-index-132" title="Permalink to this equation">¶</a></span>\[\ev{O} = \frac {\int [d\phi] O(\phi) e^{-S(\phi)} }{\int [d\phi] e^{-S(\phi)}}\]</div>
<p>If we normalize the two integrals in the same way, the normalization drops out.</p>
<p>Since the denominator does not depend on <span class="math notranslate nohighlight">\(O\)</span>,
the best choice generally is</p>
<div class="math notranslate nohighlight" id="equation-index-133">
<span class="eqno">(135)<a class="headerlink" href="#equation-index-133" title="Permalink to this equation">¶</a></span>\[g(\phi) = C \int [d\phi] e^{-S(\phi)}\]</div>
<p>with an unknown normalization coefficient <span class="math notranslate nohighlight">\(C\)</span>.
We then find</p>
<div class="math notranslate nohighlight" id="equation-index-134">
<span class="eqno">(136)<a class="headerlink" href="#equation-index-134" title="Permalink to this equation">¶</a></span>\[\ev{O} = \frac 1N \sum_i O(\phi_i)\]</div>
<p>Notice that since the normalization coefficient drops out in the
Monte Carlo, we cannot calculate the partition function
directly from the simulation.</p>
</div>
<div class="section" id="autocorrelation-time">
<h3>Autocorrelation Time<a class="headerlink" href="#autocorrelation-time" title="Permalink to this headline">¶</a></h3>
<p>The autocorrelation time measures the number of update steps required
to reach an independent configuration.</p>
<p>Given a measurement <span class="math notranslate nohighlight">\(X\)</span>, let’s label the individual measurements
as <span class="math notranslate nohighlight">\(X_i\)</span> with the configuration numbers <span class="math notranslate nohighlight">\(i=1,2,...,N\)</span>.
The autocorrelation function for measurable <span class="math notranslate nohighlight">\(X\)</span> is the
correlation between measurements separated by time <span class="math notranslate nohighlight">\(t\)</span>
normalized by the overall variation:</p>
<div class="math notranslate nohighlight" id="equation-index-135">
<span class="eqno">(137)<a class="headerlink" href="#equation-index-135" title="Permalink to this equation">¶</a></span>\[C(t) = \frac{\frac{1}{N-t} \sum_{i=1}^{N-t} X_i X_{i+t} - \ev{X}^2 }{\ev{X^2} - \ev{X}^2}\]</div>
<p>This is normalized to <span class="math notranslate nohighlight">\(C(0)=1\)</span>.</p>
<p>When the number of measurements is large, <span class="math notranslate nohighlight">\(N\to \infty\)</span>, and
the time <span class="math notranslate nohighlight">\(t\)</span> is not small (<span class="math notranslate nohighlight">\(t\to\infty\)</span>, <span class="math notranslate nohighlight">\(t\ll N\)</span>),
the autocorrelation function decays exponentially</p>
<div class="math notranslate nohighlight" id="equation-index-136">
<span class="eqno">(138)<a class="headerlink" href="#equation-index-136" title="Permalink to this equation">¶</a></span>\[C(t) \sim e^{-t/\tau_{exp}}\]</div>
<p>The exponential autocorrelation time <span class="math notranslate nohighlight">\(\tau_{exp}\)</span> is generally
roughly the same for all measurements and really measures the time
it takes to decorrelate the configurations. For error analysis the relevant quantity is the integrated autocorrelation time</p>
<div class="math notranslate nohighlight" id="equation-index-137">
<span class="eqno">(139)<a class="headerlink" href="#equation-index-137" title="Permalink to this equation">¶</a></span>\[\tau_{int} = \frac 12 + \sum_{t=1}^\infty C(t)\]</div>
<p>Note that if the autocorrelation function is purely exponential,
<span class="math notranslate nohighlight">\(C(t) = e^{-t/\tau_{exp}}\)</span>, the two autocorrelation times are
the same, <span class="math notranslate nohighlight">\(\tau_{int}\sim\tau_{exp}\)</span>. Generally
<span class="math notranslate nohighlight">\(\tau_{int} &lt; \tau_{exp}\)</span>.</p>
<p>In a Monte Carlo simulation, the corrected error estimate is</p>
<div class="math notranslate nohighlight" id="equation-index-138">
<span class="eqno">(140)<a class="headerlink" href="#equation-index-138" title="Permalink to this equation">¶</a></span>\[\sigma_X = \sqrt{2\tau_{int}} \sigma_{X, naive}
= \sqrt{2\tau_{int} \frac{ \sum_i \left(X_i - \ev{X}\right)^2 }{N(N-1)} }\]</div>
<p>In practice <span class="math notranslate nohighlight">\(N\)</span> is always finite. Taking this into account, the
formula for the autocorrelation function is modified slightly:</p>
<div class="math notranslate nohighlight" id="equation-index-139">
<span class="eqno">(141)<a class="headerlink" href="#equation-index-139" title="Permalink to this equation">¶</a></span>\[\begin{split}&amp;C(t) = \frac{\frac{1}{N-t} \sum_{i=1}^{N-t} X_i X_{i+t} - \ev{X}_1 \ev{X}_2 }{\ev{X^2} - \ev{X}^2},\\
&amp;\ev{X}_1 = \frac{1}{N-t} \sum_{i=1}^{N-t} X_i, \textrm{ and}\\
&amp;\ev{X}_2 = \frac{1}{N-t} \sum_{i=t}^{N} X_i\end{split}\]</div>
<p>It is important to keep track of autocorrelation times and to use them
in error estimates. Calculating observables too often is a waste of time,
so if the autocorrelation time is large, it might be worth adjusting the
number of updates between measurements.</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>Check out jackknife blocking for a second possible error analysis method.
It is useful when doing complicated calculations with expectation
values and tracking errors becomes unreliable. It also works well
with correlated data.</p>
</div>
</div>
<div class="section" id="update-sweeps">
<h3>Update Sweeps<a class="headerlink" href="#update-sweeps" title="Permalink to this headline">¶</a></h3>
<p>In our previous example we update the sites in random order. It is
often better, in terms of the autocorrelation time, to update each
spin in order.</p>
<p>Here are three common choices for update ordering:</p>
<ol class="arabic simple">
<li><p><strong>Typewriter:</strong> Just start site zero, update every site in a row
in order and then continue to the next row. Simple to implement, but
has a significant drawback: it breaks detailed balance in the Ising
model, at least in 1D.</p></li>
<li><p><strong>Checkerboard:</strong> When all interactions are nearest neighbor, it is
possible to update all even sites (<span class="math notranslate nohighlight">\(\sum_i x_i\)</span> is even) or all
odd sites without problems with detailed balance. So for a full
update run over even sites first and odd sites second.</p></li>
<li><p><strong>Random ordering:</strong> Just pick sites completely at random. This
always respects detailed balance, but might leave a region unchanged
for a long time.</p></li>
</ol>
</div>
<div class="section" id="cluster-and-worm-algorithm">
<h3>Cluster and Worm Algorithm<a class="headerlink" href="#cluster-and-worm-algorithm" title="Permalink to this headline">¶</a></h3>
<p>Local updates are not the only option. The most efficient method for
simulating the Ising model is a cluster algorithm. The Wolff cluster
update [U. Wolff, PRL 62 (1989) 361] proceeds as follows:</p>
<ol class="arabic simple">
<li><p>Choose a random site i.</p></li>
<li><p>Check each neighboring site j.  If <span class="math notranslate nohighlight">\(s_j==s_i\)</span>, join the site
to the cluster with probability <span class="math notranslate nohighlight">\(p=1-e^{-2\beta}\)</span>.</p></li>
<li><p>Repeat step 2 for each site <span class="math notranslate nohighlight">\(j\)</span> that was joined to the cluster.
Continue until there are no more sites to consider.</p></li>
<li><p>Flip all spins in the cluster.</p></li>
</ol>
<p>Cluster updates perform an update on a large region at once. This way it can quickly
go from a state where most spins are <span class="math notranslate nohighlight">\(+1\)</span> to a state where most spins are
<span class="math notranslate nohighlight">\(-1\)</span>. Doing this in multiple small steps is harder because each step can get
reversed.</p>
<p>Worm  updates are similar, but they update the configuration as they go.
They usually start by creating two mutually cancelling deformations
(head and tail). The head moves around the lattice while updating the
configuration. When the deformations meet, they cancel and the worm
update ends.
Worm algorithms can be efficient in a large <span class="math notranslate nohighlight">\(\beta\)</span> expansion,
for example.</p>
<p>As a further generalization of the worm algorithm, it is possible to create
impossible configurations that, configuration with extra fields or zero weight,
as intermediate steps in an update. As long as the final result is not impossible,
the update works.</p>
</div>
</div>
<div class="section" id="gauge-fields">
<h2>Gauge fields<a class="headerlink" href="#gauge-fields" title="Permalink to this headline">¶</a></h2>
<p>Gauge field theories are fundamental to the Standard Model of particle physics.
They describe the three fundamental interactions, strong and weak nuclear forces
and electromagnetism. In this section we will see how they can be implemented on
the lattice and study some of their properties.</p>
<div class="section" id="ising-gauge-model">
<h3>Ising Gauge Model<a class="headerlink" href="#ising-gauge-model" title="Permalink to this headline">¶</a></h3>
<p>The defining feature of a gauge field is the gauge symmetry, a local symmetry of
the action. Let’s look at the following action for spins <span class="math notranslate nohighlight">\(s = \pm 1\)</span></p>
<div class="math notranslate nohighlight" id="equation-index-140">
<span class="eqno">(142)<a class="headerlink" href="#equation-index-140" title="Permalink to this equation">¶</a></span>\[S = -\beta \sum_x \sum_{\mu&gt;\nu} s_{x,\mu} s_{x+\mu,\nu} s_{x+\nu, \mu} s_{x,\nu}.\]</div>
<p>The kinetic term consists of a product of spins around a single lattice square,
also known as a plaquette.</p>
<p>The action is symmetric with respect to the transformation</p>
<div class="math notranslate nohighlight" id="equation-index-141">
<span class="eqno">(143)<a class="headerlink" href="#equation-index-141" title="Permalink to this equation">¶</a></span>\[s_{x,\mu} \to -s_{x,\mu} \textrm{ for all } \mu.\]</div>
<p>Now let’s look at a scalar field</p>
<div class="math notranslate nohighlight" id="equation-index-142">
<span class="eqno">(144)<a class="headerlink" href="#equation-index-142" title="Permalink to this equation">¶</a></span>\[S = \sum_x \sum_\mu \frac {1}{a^2} \phi_x \left ( 2\phi_x - \phi_{x-\hat\mu} -\phi_{x+\hat\mu} \right ) .\]</div>
<p>This model has a global symmetry,</p>
<div class="math notranslate nohighlight" id="equation-index-143">
<span class="eqno">(145)<a class="headerlink" href="#equation-index-143" title="Permalink to this equation">¶</a></span>\[\phi_x \to -\phi_x \textrm{ for all } x.\]</div>
<p>We turn this into a local symmetry by adding the Ising Gauge field and
multiplying with it in the derivative term.</p>
<div class="math notranslate nohighlight" id="equation-index-144">
<span class="eqno">(146)<a class="headerlink" href="#equation-index-144" title="Permalink to this equation">¶</a></span>\[\begin{split}S &amp;= -\beta \sum_x \sum_{\mu&gt;\nu} s_{x,\mu} s_{x+\mu,\nu} s_{x+\nu, \mu} s_{x,\nu}\\
  &amp;+ \sum_x \sum_\mu \frac {1}{a^2} \phi_x \left ( 2\phi_x - s_{x-\hat\mu,\mu}\phi_{x-\mu} - s_{x,\mu}\phi_{x+\mu} \right ).\end{split}\]</div>
<p>The local symmetry is</p>
<div class="math notranslate nohighlight" id="equation-index-145">
<span class="eqno">(147)<a class="headerlink" href="#equation-index-145" title="Permalink to this equation">¶</a></span>\[\begin{split}&amp;\phi_x \to -\phi_x \\
&amp;s_{x,\mu} \to -s_{x,\mu} \textrm{ for all } \mu\end{split}\]</div>
<p>We also need to check the measure. Here <span class="math notranslate nohighlight">\(ds \to ds |ds'/ds| = ds |-1| = ds\)</span> and similarly
<span class="math notranslate nohighlight">\(d\phi \to d\phi\)</span>.</p>
</div>
<div class="section" id="quantum-electrodynamics">
<h3>Quantum Electrodynamics<a class="headerlink" href="#quantum-electrodynamics" title="Permalink to this headline">¶</a></h3>
<p>Consider a complex scalar field,</p>
<div class="math notranslate nohighlight" id="equation-index-146">
<span class="eqno">(148)<a class="headerlink" href="#equation-index-146" title="Permalink to this equation">¶</a></span>\[S = \sum_x \left [ \sum_\mu \frac {1}{a^2} \phi_x^* \left ( 2\phi_x - \phi_{x-\hat\mu} -\phi_{x+\hat\mu} \right ) + m^2\phi_x^*\phi_x \right ].\]</div>
<p>This model has a <span class="math notranslate nohighlight">\(U(1)\)</span> global symmetry,</p>
<div class="math notranslate nohighlight" id="equation-index-147">
<span class="eqno">(149)<a class="headerlink" href="#equation-index-147" title="Permalink to this equation">¶</a></span>\[\phi_x \to e^{i\alpha} \phi_x \textrm{ for all } x.\]</div>
<p>As above, this can be turned into a local symmetry by adding a gauge field</p>
<div class="math notranslate nohighlight" id="equation-index-148">
<span class="eqno">(150)<a class="headerlink" href="#equation-index-148" title="Permalink to this equation">¶</a></span>\[U_{x,\mu} = e^{i aA_{x,\mu}}.\]</div>
<p>Note the factor <span class="math notranslate nohighlight">\(a\)</span> in the exponential. The field <span class="math notranslate nohighlight">\(A\)</span> can be
identified with the vector potential and should have the units of energy.</p>
<p>We add a plaquette term to the Lagrangian and
add the field <span class="math notranslate nohighlight">\(U_\mu\)</span> to the derivative term:</p>
<div class="math notranslate nohighlight" id="equation-index-149">
<span class="eqno">(151)<a class="headerlink" href="#equation-index-149" title="Permalink to this equation">¶</a></span>\[\begin{split}S &amp;= -\beta \sum_x \sum_{\mu&gt;\nu} Re U_{x,\mu} U_{x+\mu,\nu} U^*_{x+\nu, \mu} U^*_{x,\nu}\\
  &amp;+ \sum_x \sum_\mu \frac {1}{a^2} \phi^*_x \left ( 2\phi_x - U^*_{x-\hat\mu,\mu}\phi_{x-\mu} - U_{x,\mu}\phi_{x+\mu} \right ).\end{split}\]</div>
<p>The local symmetry is</p>
<div class="math notranslate nohighlight" id="equation-index-150">
<span class="eqno">(152)<a class="headerlink" href="#equation-index-150" title="Permalink to this equation">¶</a></span>\[\begin{split}&amp;\phi_x \to e^{i\alpha_x} \phi_x \\
&amp;U_{x,\mu} \to e^{i\alpha_x} U_{x,\mu} e^{-i\alpha_{x+\hat\mu}} \textrm{ for all } \mu\end{split}\]</div>
<p><strong>The plaquette action</strong></p>
<p>This model has the correct symmetries for a scalar field interacting with the
electromagnetic field and it was constructed with the same principle.
Still, we should check that the plaquette actions reproduces the familiar
continuum gauge action.</p>
<p>First, what is the field <span class="math notranslate nohighlight">\(U_{x,\mu}\)</span>?
The product <span class="math notranslate nohighlight">\(\phi^*_xU_{x,\mu}\phi_{x+\mu}\)</span> is invariant, it does not
change with the local transformation. Therefore we can identify it with the
parallel transport. This also works for longer chains, for example,</p>
<div class="math notranslate nohighlight" id="equation-index-151">
<span class="eqno">(153)<a class="headerlink" href="#equation-index-151" title="Permalink to this equation">¶</a></span>\[\phi^*_{(0,0,0,0)}U_{(0,0,0,0),0}U_{(1,0,0,0),1}U_{(1,1,0,0),0}\phi_{(2,1,0,0)}\]</div>
<p>is invariant.</p>
<p>In continuum the parallel transport is the line integral</p>
<div class="math notranslate nohighlight" id="equation-index-152">
<span class="eqno">(154)<a class="headerlink" href="#equation-index-152" title="Permalink to this equation">¶</a></span>\[e^{i \int_x^y A_{\mu}(x) \cdot dr},\]</div>
<p>where <span class="math notranslate nohighlight">\(A_\mu\)</span> is the vector potential, the integral runs along a contour
from <span class="math notranslate nohighlight">\(x\)</span> to <span class="math notranslate nohighlight">\(y\)</span> and <span class="math notranslate nohighlight">\(dr\)</span> is the line element along this contour.</p>
<p>In our discrete setup, the gauge field is constant on the links between sites, and
the parallel transport between <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(x+\hat\mu\)</span> is</p>
<div class="math notranslate nohighlight" id="equation-index-153">
<span class="eqno">(155)<a class="headerlink" href="#equation-index-153" title="Permalink to this equation">¶</a></span>\[U_{x,\mu} = e^{i \int_x^{x+\hat\mu} A_{\mu}(x) \cdot dx} = e^{iaA_{x,\mu}}\]</div>
<p>Closed loops of the gauge field are also invariant. In fact, these can
be seen as the parallel transport of a massless fermion,</p>
<div class="math notranslate nohighlight" id="equation-index-154">
<span class="eqno">(156)<a class="headerlink" href="#equation-index-154" title="Permalink to this equation">¶</a></span>\[\int d\phi_x \phi^*_{x}U_{x,\mu} U_{x+\mu,\nu} U^*_{x+\nu, \mu} U^*_{x,\nu}\phi_{x}
 = Tr \left [ U_{x,\mu} U_{x+\mu,\nu} U^*_{x+\nu, \mu} U^*_{x,\nu} \right ].\]</div>
<p>One way of deriving the field strength tensor is to do a parallel transport over a
closed loop and take the limit where the loop contracts to a point. This is
what we will do here. The plaquette is the smallest closed loop possible on the
lattice and we will in the end take the limit <span class="math notranslate nohighlight">\(a\to0\)</span>, where the loop
contracts to zero.</p>
<p>More formally, we can write</p>
<div class="math notranslate nohighlight" id="equation-index-155">
<span class="eqno">(157)<a class="headerlink" href="#equation-index-155" title="Permalink to this equation">¶</a></span>\[\begin{split}S &amp;= -\sum_x \beta Re \sum_{\mu&gt;\nu} U_{x,\mu} U_{x+\mu,\nu} U^*_{x+\nu, \mu} U^*_{x,\nu}\\
&amp;= -\sum_x  \beta Re \sum_{\mu&gt;\nu} e^{iaA_{x,\mu} + iaA_{x+\mu,\nu}-iaA_{x+\nu, \mu}-iaA_{x,\nu}}\\\end{split}\]</div>
<p>Now expanding</p>
<div class="math notranslate nohighlight" id="equation-index-156">
<span class="eqno">(158)<a class="headerlink" href="#equation-index-156" title="Permalink to this equation">¶</a></span>\[A_{x+\hat\mu,\nu} = A_{x,\mu} + a\partial_\mu A_{x,\nu}
+ \frac 12 a^2 \partial^2_\mu A_{x,\nu} + \dots\]</div>
<p>we find</p>
<div class="math notranslate nohighlight" id="equation-u1plaquetteaction">
<span class="eqno">(159)<a class="headerlink" href="#equation-u1plaquetteaction" title="Permalink to this equation">¶</a></span>\[\begin{split}S &amp;= -\sum_x \beta Re \sum_{\mu&gt;\nu} e^{ia^2\partial_\nu A_{x,\mu} - ia\partial_\mu A_{x,\nu} + O(a^3)}\\
&amp;=-\sum_x \beta Re\left( 1 + ia^2F_{x,\mu,\nu} - a^4F_{x,\mu,\nu} F_{x,\mu,\nu} \right )\\
&amp;=\sum_x \beta \left ( -1 + a^4F_{x,\mu,\nu} F_{x,\mu,\nu} \right )\end{split}\]</div>
<p>While constant shifts in the action do not actually make a difference, it is common
to use the action</p>
<div class="math notranslate nohighlight" id="equation-index-157">
<span class="eqno">(160)<a class="headerlink" href="#equation-index-157" title="Permalink to this equation">¶</a></span>\[S = \sum_x \beta\left [ 1 - Re \sum_{\mu&gt;\nu} U_{x,\mu} U_{x+\mu,\nu} U^*_{x+\nu, \mu} U^*_{x,\nu} \right ]\]</div>
<p>This is the Wilson plaquette gauge action [K. Wilson, 1974] for a U(1) gauge theory,
such as electromagnetism.</p>
<p>The continuum action you may have seen does not have the factor <span class="math notranslate nohighlight">\(\beta\)</span>.
This is where the coupling comes in: we would usually write the covariant derivative as</p>
<div class="math notranslate nohighlight" id="equation-index-158">
<span class="eqno">(161)<a class="headerlink" href="#equation-index-158" title="Permalink to this equation">¶</a></span>\[D_\mu = \partial_\mu +i gA_\mu\]</div>
<p>This would lead to the parallel transport</p>
<div class="math notranslate nohighlight" id="equation-index-159">
<span class="eqno">(162)<a class="headerlink" href="#equation-index-159" title="Permalink to this equation">¶</a></span>\[U_\mu = e^{i agA_{x,\mu}}.\]</div>
<p>So the vector potential is scaled by a factor of <span class="math notranslate nohighlight">\(g\)</span>. On the lattice it is more
straightforward to not incorporate the coupling to the matrix, but if we did
the rescaling, <span class="math notranslate nohighlight">\(A_\mu \to gA_\mu\)</span>, we would find</p>
<div class="math notranslate nohighlight" id="equation-index-160">
<span class="eqno">(163)<a class="headerlink" href="#equation-index-160" title="Permalink to this equation">¶</a></span>\[S_{gauge} \to \beta g^2 a^4 \sum_x  F_{x,\mu,\nu} F_{x,\mu,\nu}.\]</div>
<p>From here we can set <span class="math notranslate nohighlight">\(\beta=\frac {1}{g^2}\)</span> to recover the continuum action.</p>
<p>So the action matches the continuum action for gauge fields. The propagators can
be derived similarly to the scalar fields. The kinetic terms are squared derivatives
and will produce the same dispersion relation.</p>
<p>In the Standard Model, the electromagnetic field interacts with fermion and the
Higgs field. We will get to fermions after we the gauge field section. The
Higgs field also interacts with the weak gauge field and is not just a complex field.
Next we will look at <span class="math notranslate nohighlight">\(SU(2)\)</span> interactions, such as the weak interaction,
and <span class="math notranslate nohighlight">\(SU(3)\)</span> interactions, such as the strong interaction.
The results for <span class="math notranslate nohighlight">\(SU(3)\)</span> generalize to any <span class="math notranslate nohighlight">\(SU(N)\)</span>.</p>
<p>The electromagnetic interaction has a further complication not shared by the other
fundamental interactions. The electromagnetic couplings for each particle can be
different. Modeling this on the lattice would require actually adding the coupling
to the parallel transport. For particle <span class="math notranslate nohighlight">\(i\)</span>,</p>
<div class="math notranslate nohighlight" id="equation-index-161">
<span class="eqno">(164)<a class="headerlink" href="#equation-index-161" title="Permalink to this equation">¶</a></span>\[U_{\mu,i} = e^{i ag_i A_{x,\mu}} = U_\mu^{g_i}.\]</div>
<p>In this case it is actually simpler to use store the vector potential
<span class="math notranslate nohighlight">\(A_{x_\mu}\)</span> instead of the parallel transport <span class="math notranslate nohighlight">\(U_{x_\mu}\)</span>.
The parallel transport can be calculated relatively easily,</p>
<div class="math notranslate nohighlight" id="equation-index-162">
<span class="eqno">(165)<a class="headerlink" href="#equation-index-162" title="Permalink to this equation">¶</a></span>\[U_{\mu,i} = e^{i a g_i A_{x,\mu}} = \cos(a g_i A_{x,\mu}) + i\sin(a g_i A_{x,\mu}).\]</div>
<p>The exponentiation is not as straightforward in <span class="math notranslate nohighlight">\(SU(N)\)</span>.</p>
</div>
<div class="section" id="non-abelian-gauge-fields">
<h3>Non-Abelian Gauge Fields<a class="headerlink" href="#non-abelian-gauge-fields" title="Permalink to this headline">¶</a></h3>
<p>The U(1) gauge field is Abelian, meaning that</p>
<div class="math notranslate nohighlight" id="equation-index-163">
<span class="eqno">(166)<a class="headerlink" href="#equation-index-163" title="Permalink to this equation">¶</a></span>\[A_{x,\mu} A_{y,\nu} = A_{y,\nu} A_{x,\mu}\]</div>
<p>The weak and strong nuclear forces are governed by a non-Abelian symmetry.
Again, starting from a scalar matter field <span class="math notranslate nohighlight">\(\phi_x\)</span>, but this is now a vector
with <span class="math notranslate nohighlight">\(N\)</span> indexes,</p>
<div class="math notranslate nohighlight" id="equation-index-164">
<span class="eqno">(167)<a class="headerlink" href="#equation-index-164" title="Permalink to this equation">¶</a></span>\[S = \sum_x \sum_\mu \frac {1}{a^2} \phi^\dagger_x \left ( 2\phi_x - \phi_{x-\hat\mu} - \phi_{x+\mu} \right ).\]</div>
<p>the global symmetry is</p>
<div class="math notranslate nohighlight" id="equation-index-165">
<span class="eqno">(168)<a class="headerlink" href="#equation-index-165" title="Permalink to this equation">¶</a></span>\[\begin{split}&amp;\phi_x \to \Lambda \phi_x \textrm{ for all } x \textrm{, and therefore } \\
&amp;\phi_x^\dagger \to \phi_x^\dagger \Lambda^\dagger \textrm{ for all } x\\
&amp;\Lambda^\dagger \Lambda = 1\end{split}\]</div>
<p>This in principle incorporates the U(1) symmetry, which is still a global symmetry.
It can be separated and have a different coupling, so we consider it a separate interaction.
This is achieved by requiring</p>
<div class="math notranslate nohighlight" id="equation-index-166">
<span class="eqno">(169)<a class="headerlink" href="#equation-index-166" title="Permalink to this equation">¶</a></span>\[\det \left ( \Lambda \right ) = 1.\]</div>
<p>Thus the matrix <span class="math notranslate nohighlight">\(\Lambda\)</span> is a member of the <span class="math notranslate nohighlight">\(SU(N)\)</span> symmetry group.</p>
<p>The symmetry is made local using a gauge matrix <span class="math notranslate nohighlight">\(U_{x,\mu}\)</span> as above.
The gauge invariant action is</p>
<div class="math notranslate nohighlight" id="equation-index-167">
<span class="eqno">(170)<a class="headerlink" href="#equation-index-167" title="Permalink to this equation">¶</a></span>\[\begin{split}S &amp;= -\beta \sum_x \sum_{\mu&gt;\nu}
\left( 1 - \frac {1}{N} Re Tr U_{x,\mu} U_{x+\mu,\nu} U^*_{x+\nu, \mu} U^*_{x,\nu} \right )\\
  &amp;+ \sum_x \sum_\mu \frac {1}{a^2} \phi^\dagger_x \left ( 2\phi_x - U^\dagger_{x-\hat\mu,\mu}\phi_{x-\hat\mu} - U_{x,\mu}\phi_{x+\mu} \right ).\end{split}\]</div>
<p>The gauge matrix is a special unitary matrix,</p>
<div class="math notranslate nohighlight" id="equation-index-168">
<span class="eqno">(171)<a class="headerlink" href="#equation-index-168" title="Permalink to this equation">¶</a></span>\[\begin{split}&amp;\det \left ( U_{x,\mu} \right ) = 1 \\
&amp;U_{x,\mu}^\dagger U_{x,\mu} = 1\end{split}\]</div>
<p>and it can be written as</p>
<div class="math notranslate nohighlight" id="equation-index-169">
<span class="eqno">(172)<a class="headerlink" href="#equation-index-169" title="Permalink to this equation">¶</a></span>\[U = e^{i aA_{x,\mu}}.\]</div>
<p>The color vector potential <span class="math notranslate nohighlight">\(A_{x,\mu}\)</span> is a traceless, hermitean matrix, and it is a member
of a Lie algebra. The continuum action has the same form as in the U(1) case
(equation <a class="reference internal" href="#equation-u1plaquetteaction">(159)</a>),</p>
<div class="math notranslate nohighlight" id="equation-index-170">
<span class="eqno">(173)<a class="headerlink" href="#equation-index-170" title="Permalink to this equation">¶</a></span>\[S = \int dx  Tr F_{x, \mu\nu}F_{x, \mu\nu}\]</div>
<div class="note docutils container">
<p><strong>Exercise</strong></p>
<p>1. Check that the plaquette action generates the correct continuum action.
Note that it this case <span class="math notranslate nohighlight">\(\left[ A_{x,\mu}, A_{y,\nu} \right] \neq 0\)</span>
and that the definition of <span class="math notranslate nohighlight">\(F_{\mu,\nu}\)</span> is a bit different.</p>
</div>
<p><strong>Note on Gauge Fixing</strong></p>
<p>Unlike in perturbative calculations, there is no reason to fix the gauge during a lattice simulation.
In general this is something we do not want to do.
The gauge symmetry simply adds an irrelevant dimension to the integral and reduces to a constant factor
in the metric.</p>
</div>
<div class="section" id="updating-gauge-fields">
<h3>Updating Gauge Fields<a class="headerlink" href="#updating-gauge-fields" title="Permalink to this headline">¶</a></h3>
<p>The action of the gauge field is still local and in fact each of the directional fields
<span class="math notranslate nohighlight">\(U_\mu\)</span>, there are only nearest neighbor interactions. The complication is that we
need to suggest a new matrix in the correct group. For U(1), there are two options.
Either draw the vector potential and exponentiate it, or draw either the real
or imaginary part and calculate the other one. It is somewhat easier to use first
option:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Loop over direction <span class="math notranslate nohighlight">\(\mu\)</span>.</p></li>
<li><p>Choose a site <span class="math notranslate nohighlight">\(x\)</span>.</p></li>
<li><p>Do a metropolis step:</p></li>
</ol>
<blockquote>
<div><ol class="arabic simple">
<li><p>Calculate the sum of “staples”,</p></li>
</ol>
<div class="math notranslate nohighlight" id="equation-index-171">
<span class="eqno">(174)<a class="headerlink" href="#equation-index-171" title="Permalink to this equation">¶</a></span>\[S_{x,\mu} = \sum_{\nu\neq\mu} U_{x+\mu,\nu} U^*_{x+\nu, \mu} U^*_{x,\nu}\]</div>
<ol class="arabic" start="2">
<li><p>Calculate the initial action</p>
<div class="math notranslate nohighlight" id="equation-index-172">
<span class="eqno">(175)<a class="headerlink" href="#equation-index-172" title="Permalink to this equation">¶</a></span>\[S_1 = Re U_{x,\mu} S_{x,\mu}\]</div>
</li>
<li><p>Suggest the change</p>
<div class="math notranslate nohighlight" id="equation-index-173">
<span class="eqno">(176)<a class="headerlink" href="#equation-index-173" title="Permalink to this equation">¶</a></span>\[\begin{split}A'_{x,\mu} &amp;= \left . A_{x,\mu} + C x \right |_{mod(2\pi)},\\
U_{x,\mu} &amp;= e^{iA_{x,\mu}} = \cos(A_{x,\mu}) + i \sin(A_{x,\mu})\end{split}\]</div>
<p>(Here <span class="math notranslate nohighlight">\(a=1\)</span>)</p>
</li>
<li><p>Accept with the propability</p>
<div class="math notranslate nohighlight" id="equation-index-174">
<span class="eqno">(177)<a class="headerlink" href="#equation-index-174" title="Permalink to this equation">¶</a></span>\[W_f(\phi_x \to \phi'_x) = min\left( 1, e^{- [ S(\phi'_x) - S(\phi_x) ]} \right )\]</div>
</li>
</ol>
</div></blockquote>
</div></blockquote>
<p>If you are also simulating a scalar matter field, you need to derivative term in the action,
since it depends on the gauge fields. This can be done by adding
<span class="math notranslate nohighlight">\(-\phi^*_x\phi_{x+\mu}-\phi^*_{x+\mu}\phi_x\)</span> to the staple.</p>
<p>For non-Abelian fields, the vector potential is a matrix and exponentiating it is a bit more
complicated. One general option is to generate a “small” SU(N) matrix and multiply with it,
since this will produce an SU(N) matrix:</p>
<div class="math notranslate nohighlight" id="equation-index-175">
<span class="eqno">(178)<a class="headerlink" href="#equation-index-175" title="Permalink to this equation">¶</a></span>\[\begin{split}\Lambda &amp;= e^{iCx\lambda_i} = \cos(C\sqrt{\tau_N}x)
 + i \sin(C\sqrt{\tau_N}x)\frac{\lambda_i}{\sqrt{\tau_N}}\\
U'_{x,\mu} &amp;= \Lambda U_{x,\mu}\end{split}\]</div>
<p>Here <span class="math notranslate nohighlight">\(\lambda_i\)</span> is the generator matrix and <span class="math notranslate nohighlight">\(\tau_N = \lambda_i^2\)</span> is a constant
that depends on how the generators are defined. For SU(2) with Pauli matrices
<span class="math notranslate nohighlight">\(\tau_N = 1\)</span> and for SU(3) with Gell-Mann <span class="math notranslate nohighlight">\(\tau_N = \frac23\)</span>.</p>
<p>While there are more efficient algorithms for each SU(N) group, this is a general method and
sufficient for our purposes.</p>
<p>During a simulation floating point errors will cause the gauge field to drift outside the SU(N)
group. In a long run this needs to be corrected for. The usual method is to change one of the
columns and the rows to make sure that the new matrix is Hermitean and has determinant <span class="math notranslate nohighlight">\(1\)</span>.</p>
</div>
<div class="section" id="id1">
<h3>Observables<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>Any observables constructed out of gauge dependent objects should be gauge invariant.
The gauge symmetry forces the expectation value of any non-invariant objects to zero
(Elitzur’s theorem). For example, <span class="math notranslate nohighlight">\(\ev{U_{x,\mu}} = 0\)</span></p>
<p><strong>Wilson Loops</strong></p>
<p>Consider static (infinitely massive) charge and a similar anticharge separated by the distance
<span class="math notranslate nohighlight">\(R\)</span> that exist for the time <span class="math notranslate nohighlight">\(T\)</span> and annihilate. To describe this we would need to parallel
transport a matter field <span class="math notranslate nohighlight">\(\phi\)</span> from a point <span class="math notranslate nohighlight">\(x\)</span> to <span class="math notranslate nohighlight">\(x+(T,0)\)</span>, then to <span class="math notranslate nohighlight">\(x+(T,R)\)</span>,
down in time (as an antiparticle) to <span class="math notranslate nohighlight">\(x+(0,R)\)</span> and finally back to <span class="math notranslate nohighlight">\(x\)</span>
to annihilate. This can be described by the operator</p>
<div class="math notranslate nohighlight" id="equation-index-176">
<span class="eqno">(179)<a class="headerlink" href="#equation-index-176" title="Permalink to this equation">¶</a></span>\[\begin{split}W_{RT} &amp;= \int [d\phi_{(0,0)} d\phi_{(R,T)}] \phi^\dagger_{(0,0)} \prod_{x=(0,R)}^{(0,0)} U_{x,\hat x} \prod_{x=(T,R)}^{(0,R)} U_{x,\hat t} \phi_{(T,R)} \\
&amp;\times \phi^\dagger_{(T,R)} \phi_{(0,0)} \prod_{x=(T,0)}^{(T,R)} U_{x,\hat x}^\dagger \prod_{x=(0,0)}^{(T,0)} U_{x,\hat t}^\dagger \phi_{(0,0)}\\
&amp;= Tr \prod_{x=(0,R)}^{(0,0)} U_{x,\hat x} \prod_{x=(T,R)}^{(0,R)} U_{x,\hat t} \prod_{x=(T,0)}^{(T,R)} U_{x,\hat x}^\dagger \prod_{x=(0,0)}^{(T,0)} U_{x,\hat t}^\dagger.\end{split}\]</div>
<p>This is known as a Wilson loop. Since it is a closed loop, it is a gauge invariant observable.
It has several possible interpretations, but perhaps the most straightforward is as the
propagator of a state of two static charged particles.
At large <span class="math notranslate nohighlight">\(T\)</span> this should behave exponentially,</p>
<div class="math notranslate nohighlight" id="equation-index-177">
<span class="eqno">(180)<a class="headerlink" href="#equation-index-177" title="Permalink to this equation">¶</a></span>\[W_{RT} \to C e^{-V(R) T} \textrm{ as } T \to \infty\]</div>
<p>and indeed it generally does.</p>
<p>The Wilson loops allows us to probe wether a gauge theory is confining.
In a confining model, the potential energy <span class="math notranslate nohighlight">\(V(R)\)</span> grows to infinity with distance,
whereas without confinement it remains finite.</p>
<div class="math notranslate nohighlight" id="equation-index-178">
<span class="eqno">(181)<a class="headerlink" href="#equation-index-178" title="Permalink to this equation">¶</a></span>\[\begin{split}&amp;V(R\to\infty) \to \infty : \textrm{confinement}\\
&amp;V(R\to\infty) \to finite : \textrm{no confinement}\end{split}\]</div>
<dl>
<dt>The Wilson loop follows the</dt><dd><ul>
<li><p><em>perimeter law</em>: Free charges.</p>
<p><span class="math notranslate nohighlight">\(W_{RT} \sim exp(-m (2R+2T))\)</span>, where m is the mass of the charge due to the gauge field.
At constant <span class="math notranslate nohighlight">\(R\)</span> and large <span class="math notranslate nohighlight">\(T\)</span>, <span class="math notranslate nohighlight">\(W_{RT} \sim exp(-2m T)\)</span> and <span class="math notranslate nohighlight">\(V(R) = m\)</span></p>
</li>
<li><p><em>area law</em>: Confined charges</p>
<p><span class="math notranslate nohighlight">\(W_{RT} \sim exp(-\sigma RT)\)</span>, <span class="math notranslate nohighlight">\(V(R) = \sigma R\)</span>. String tension <span class="math notranslate nohighlight">\(\sigma\)</span> ties
the charges together.</p>
</li>
</ul>
</dd>
</dl>
<p>Note that because of the exponential decay of the Wilson loop, measuring it becomes difficult when
<span class="math notranslate nohighlight">\(R\)</span> and <span class="math notranslate nohighlight">\(T\)</span> are large. The statistical uncertainty remains roughly constant and exponentially
more data is required.</p>
<p>In general, the Wilson loop follows the phenomenological form</p>
<div class="math notranslate nohighlight">
\[V(r) = V_0 + \sigma_r - \frac er + f\left[ G_L({\bf r}) - \frac 1r \right]\]</div>
<p><strong>Polyakov Line</strong></p>
<p>Now let’s add a single static test charge. It does not annihilate,but moves forward in time
around the lattice. Since the lattice is periodic, this forms a closed loop:</p>
<div class="math notranslate nohighlight" id="equation-index-179">
<span class="eqno">(182)<a class="headerlink" href="#equation-index-179" title="Permalink to this equation">¶</a></span>\[P = Tr \prod_{t=0}^{T} U_{t,\hat t}\]</div>
<p>Similarly to the above, the this corresponds to a propagator and scales exponentially,</p>
<div class="math notranslate nohighlight" id="equation-index-180">
<span class="eqno">(183)<a class="headerlink" href="#equation-index-180" title="Permalink to this equation">¶</a></span>\[\ev{P} = e^{-T F_Q}.\]</div>
<p>Here <span class="math notranslate nohighlight">\(F_Q\)</span> is the free energy of a single charged quark.
In a confining model charged quarks cannot appear alone and <span class="math notranslate nohighlight">\(F_Q\to\infty\)</span>.
So we should find <span class="math notranslate nohighlight">\(\ev{P}\to 0\)</span>.</p>
<p>Both <span class="math notranslate nohighlight">\(SU(2)\)</span> and <span class="math notranslate nohighlight">\(SU(3)\)</span> have a deconfining transition and are not
confining at high temperatures. Above some critical temperature we find <span class="math notranslate nohighlight">\(\ev{P} \neq 0\)</span>.
The same result can of course be found using Wilson loops, but the Polyakov line provides
a particularly straightforward method.</p>
<p>The transition is in fact related to spin models in an interesting way. SU(N) fields have
an coincidental center symmetry. Center elements are elements of a group that commute with
other elements. For SU(2) these are <span class="math notranslate nohighlight">\(1\)</span> and <span class="math notranslate nohighlight">\(-1\)</span> and for SU(3) they are
<span class="math notranslate nohighlight">\(1\)</span>, <span class="math notranslate nohighlight">\(exp(i2\pi/3)\)</span> and <span class="math notranslate nohighlight">\(exp(i4\pi/3)\)</span>. Since they commute with all other
elements, we can multiply all links at a given <span class="math notranslate nohighlight">\(t\)</span> with a center element and not affect
the plaquette action:</p>
<div class="math notranslate nohighlight" id="equation-index-181">
<span class="eqno">(184)<a class="headerlink" href="#equation-index-181" title="Permalink to this equation">¶</a></span>\[U_{t,({\bf x},\tau)} \to zU_{t,({\bf x},\tau)}  \textrm{ for all } {\bf x} \textrm{ and given } \tau.\]</div>
<p>Now</p>
<div class="math notranslate nohighlight" id="equation-index-182">
<span class="eqno">(185)<a class="headerlink" href="#equation-index-182" title="Permalink to this equation">¶</a></span>\[\begin{split}L_{x,t,\nu} &amp;= \beta \left [ 1 - ReTr U_{({\bf x}, \tau), t} U_{({\bf x}, \tau+1),\nu} U^\dagger_{({\bf x}+\hat\nu, \tau), t} U^\dagger_{({\bf x}, \tau),\nu} \right ]\\
&amp;\to \beta \left [ 1 - ReTr z U_{({\bf x}, \tau), t} U_{({\bf x}, \tau+1),\nu} z^*U^\dagger_{({\bf x}+\hat\nu, \tau), t} U^\dagger_{({\bf x}, \tau),\nu} \right ]\\
&amp;\to \beta \left [ 1 - ReTr z z^* U_{({\bf x}, \tau), t} U_{({\bf x}, \tau+1),\nu} U^\dagger_{({\bf x}+\hat\nu, \tau), t} U^\dagger_{({\bf x}, \tau),\nu} \right ]\\
&amp;\to \beta \left [ 1 - ReTr U_{({\bf x}, \tau), t} U_{({\bf x}, \tau+1),\nu} U^\dagger_{({\bf x}+\hat\nu, \tau), t} U^\dagger_{({\bf x}, \tau),\nu} \right ].\end{split}\]</div>
<p>However the Polyakov loop does not remain invariant. In only contains one link for each <span class="math notranslate nohighlight">\(t\)</span>-layer, so</p>
<div class="math notranslate nohighlight" id="equation-index-183">
<span class="eqno">(186)<a class="headerlink" href="#equation-index-183" title="Permalink to this equation">¶</a></span>\[P \to zP.\]</div>
<p>Since all configurations that differ by a center trasnformation have the same weight,
the expectation value is</p>
<div class="math notranslate nohighlight" id="equation-index-184">
<span class="eqno">(187)<a class="headerlink" href="#equation-index-184" title="Permalink to this equation">¶</a></span>\[\ev P = \frac 1N \sum_{n=0}^{N-1} e^{in\pi/N} \ev P = 0.\]</div>
<p>The center symmetry transformations are similar to the symmetries of an <span class="math notranslate nohighlight">\(Z_N\)</span> spin model
in 3 dimensions. The <span class="math notranslate nohighlight">\(Z_3\)</span> part of the interaction in nearest neighbor and symmetry transformation cycles through the possible spins.</p>
<p>The most notable similarity is that the symmetry is never broken at finite volume.
The deconfinement transition requires large enough volume to prevent tunneling
between the sectors.</p>
<p>Any matter field breaks the center symmetry and prevents this mechanism for
confinement. This is because dynamical particles can break the string:
a particle-antiparticle loops can pop out of the vacuum and screen the
charges. Confinement is still happening but the Wilson loop does not measure
the correct thing.</p>
</div>
</div>
<div class="section" id="fermions">
<h2>Fermions<a class="headerlink" href="#fermions" title="Permalink to this headline">¶</a></h2>
<p>The Standard Model of particle physics consists of fermions, gauge bosons and the Higgs field,
which is a scalar boson field. What we call matter is generally made up of fermions, although
it’s mass in fact arises from the binding energy of the neutral bound states of the strong
interaction.</p>
<p>Properly modeling fermions is essential for the complex phenomenology of strong interactions,
but fermions are also conceptually more complicated than bosonic fields and present some unique
challenges for lattice discretization.</p>
<p>In this section we will review the properties and the path integral describtion of fermions,
describe the most important complications created by simulating fermionic theories on the
lattice and the most common solutions. The intention is that you become familiar with two
of the most common fermion discretizations and are able to look up the details. We will also
discuss important measurements constructed from the fermion fields.</p>
<div class="section" id="the-problem-with-naive-fermions">
<h3>The problem with naive Fermions<a class="headerlink" href="#the-problem-with-naive-fermions" title="Permalink to this headline">¶</a></h3>
<p><strong>Continuum Fermions</strong></p>
<p>As mentioned above, we run into problems when discretizing fermions.
First let’s just see what happens when we try to do this the most
straightforward way. The action of a free fermion field is</p>
<div class="math notranslate nohighlight" id="equation-index-185">
<span class="eqno">(188)<a class="headerlink" href="#equation-index-185" title="Permalink to this equation">¶</a></span>\[S = \int dx \sum_\mu \bar\psi(x) \gamma_\mu \partial_\mu \psi(x) + m\bar\psi(x)\psi(x)\]</div>
<p>The fields <span class="math notranslate nohighlight">\(\psi\)</span> and <span class="math notranslate nohighlight">\(\bar\psi\)</span> consist of Grassmann numbers.
The defining so feature of Grassmann numbers is that for any two of them, say
<span class="math notranslate nohighlight">\(\psi\)</span> and <span class="math notranslate nohighlight">\(\bar\psi\)</span>,</p>
<div class="math notranslate nohighlight" id="equation-index-186">
<span class="eqno">(189)<a class="headerlink" href="#equation-index-186" title="Permalink to this equation">¶</a></span>\[\bar\psi\psi = -\psi\bar\psi\]</div>
<p>From this we find</p>
<div class="math notranslate nohighlight" id="equation-index-187">
<span class="eqno">(190)<a class="headerlink" href="#equation-index-187" title="Permalink to this equation">¶</a></span>\[\begin{split}&amp;\psi\psi = 0\\
&amp;f(\psi) = f_1 + f_2\psi\end{split}\]</div>
<p>for any analytic function f.</p>
<p>The matrices <span class="math notranslate nohighlight">\(\gamma_\mu\)</span> are a set of Hermitean matrices that follow
the anticommutation relation</p>
<div class="math notranslate nohighlight" id="equation-index-188">
<span class="eqno">(191)<a class="headerlink" href="#equation-index-188" title="Permalink to this equation">¶</a></span>\[\{\gamma_\mu,\gamma_\nu\} = 2 g_{\mu,\nu} = 2\]</div>
<p>In 4 dimensions they are <span class="math notranslate nohighlight">\(4\times 4\)</span> matrices.
The fields <span class="math notranslate nohighlight">\(\psi\)</span> are actually length 4 vectors in the same vector space.
Since we are using the Euclidean metric, the gamma matrices may be different from the
ones you are used to. We could derive them from the Minkowsky space gamma matrices by</p>
<div class="math notranslate nohighlight" id="equation-index-189">
<span class="eqno">(192)<a class="headerlink" href="#equation-index-189" title="Permalink to this equation">¶</a></span>\[\begin{split}&amp;\gamma_0 = \gamma_0^M\\
&amp;\gamma_k = -i\gamma_k^M\end{split}\]</div>
<p>A common choice is to use</p>
<div class="math notranslate nohighlight" id="equation-index-190">
<span class="eqno">(193)<a class="headerlink" href="#equation-index-190" title="Permalink to this equation">¶</a></span>\[\begin{split}&amp;\gamma_k = \begin{pmatrix}
0 &amp; i\sigma_k\\
-i\sigma_k &amp; 0
\end{pmatrix}\\
&amp;\gamma_0 = \begin{pmatrix}
0 &amp; 1\\
1 &amp; 0
\end{pmatrix}\end{split}\]</div>
<p>and</p>
<div class="math notranslate nohighlight" id="equation-index-191">
<span class="eqno">(194)<a class="headerlink" href="#equation-index-191" title="Permalink to this equation">¶</a></span>\[\begin{split}&amp;\gamma_5 = -\gamma_0\gamma_1\gamma_2\gamma_3 = \begin{pmatrix}
I &amp; 0\\
0 &amp; -I
\end{pmatrix}\end{split}\]</div>
<p>The Dirac equation in a kind of a square root of the Schrödinger equation in the sense that</p>
<div class="math notranslate nohighlight" id="equation-index-192">
<span class="eqno">(195)<a class="headerlink" href="#equation-index-192" title="Permalink to this equation">¶</a></span>\[(\gamma_\mu \partial_\mu - m)(\gamma_\nu \partial_\nu + m) = (\partial_\mu \partial_\mu + m^2)\]</div>
<p>It applies to a particle transforming in the spin <span class="math notranslate nohighlight">\(1/2\)</span> representation of the Lorentz group.</p>
<p>From the point of view of discretization, however, the significant property is that there is only one
derivative. This will cause us some trouble.</p>
<p><strong>Naive discretization</strong></p>
<p>In the previous sections we have introduced the discrete derivatives</p>
<div class="math notranslate nohighlight" id="equation-index-193">
<span class="eqno">(196)<a class="headerlink" href="#equation-index-193" title="Permalink to this equation">¶</a></span>\[\begin{split}\Delta_\mu \psi(x) &amp;= \frac 1a \left[ \psi(x+a\hat\mu) - \psi(x) \right]\\
\Delta^*_\mu \psi(x) &amp;= \frac 1a \left[ \psi(x) - \psi(x-a\hat\mu) \right]\end{split}\]</div>
<p>Plugging either the forward or the backward derivative in directly would not work, since
the resulting action would not be reflection invariant. This would lead to unitarity
violations, making the theory truly problematic. And since the symmetries would be different, even in
continuum, the continuum limit would not be correct.</p>
<p>Instead, we can take the symmetric combination of the two,</p>
<div class="math notranslate nohighlight" id="equation-index-194">
<span class="eqno">(197)<a class="headerlink" href="#equation-index-194" title="Permalink to this equation">¶</a></span>\[\frac 12 (\Delta_\mu + \Delta^*_\mu) \psi(x) = \frac 1{2a} \left[ \psi(x+a\hat\mu) - \psi(x-a\hat\mu) \right]\]</div>
<p>This is reflection invariant, preserves unitarity and approaches the derivative in the continuum limit.
It is not enough, though. Looking at the form above, perhaps you can already see the problem we
will run into.</p>
<p>With this derivative, the action is</p>
<div class="math notranslate nohighlight" id="equation-index-195">
<span class="eqno">(198)<a class="headerlink" href="#equation-index-195" title="Permalink to this equation">¶</a></span>\[S = a^4\sum_x \left [ \sum_\mu \bar\psi_x \gamma_\mu \frac{ \psi_{x+\mu} - \psi_{x-\mu} }{2a}
    - m\bar\psi_x\psi_x \right ]\]</div>
<p>As before, we should first check that this produces the correct set of particles in
the continuum. For this we need the propagator.</p>
<p>Deriving the propagator is quite similar to the bosonic case, but since the fields are
Grassmann numbers we need to do a bit of Grassmann algebra.
First, we define the derivative operator as similarly to standard numbers as possible:</p>
<div class="math notranslate nohighlight" id="equation-index-196">
<span class="eqno">(199)<a class="headerlink" href="#equation-index-196" title="Permalink to this equation">¶</a></span>\[\partial_\psi \psi = 1, \textrm{  } \partial_\psi \psi = 0, \textrm{  } \partial_\psi c = 0,\]</div>
<p>where <span class="math notranslate nohighlight">\(\psi\)</span> and <span class="math notranslate nohighlight">\(\bar\psi\)</span> are Grassman numbers and <span class="math notranslate nohighlight">\(c\)</span> is a complex number.</p>
<p>The integral is defined identically,</p>
<div class="math notranslate nohighlight" id="equation-index-197">
<span class="eqno">(200)<a class="headerlink" href="#equation-index-197" title="Permalink to this equation">¶</a></span>\[\int d\psi \psi = 1 , \textrm{  } \int d\psi \psi = 0 \textrm{ and } \int d\psi c = 0\]</div>
<p>While this may seem a bit unusual, the Grassmann integral follows the most important standard
properties of an integral. It is a linear operation, an integral over a total derivative vanishes
and After an integral over <span class="math notranslate nohighlight">\(\psi\)</span> the expression no longer depends
on <span class="math notranslate nohighlight">\(\psi\)</span>.</p>
<p>Now the generating function for propagators and other N-point functions is</p>
<div class="math notranslate nohighlight" id="equation-index-198">
<span class="eqno">(201)<a class="headerlink" href="#equation-index-198" title="Permalink to this equation">¶</a></span>\[Z[\eta,\bar\eta] = \int d\bar\psi d\psi e^{-S + \sum_x \bar\eta_x \psi  + \sum_x \bar\psi_x \eta_x},\]</div>
<p>where the sources <span class="math notranslate nohighlight">\(\eta\)</span> and <span class="math notranslate nohighlight">\(\bar\eta\)</span> are Grassmann fields.
Note that the exponential of a Grassmann number is (from the Taylor expansion)</p>
<div class="math notranslate nohighlight" id="equation-index-199">
<span class="eqno">(202)<a class="headerlink" href="#equation-index-199" title="Permalink to this equation">¶</a></span>\[e^{\psi} = 1 + \psi\]</div>
<p>and so</p>
<div class="math notranslate nohighlight" id="equation-index-200">
<span class="eqno">(203)<a class="headerlink" href="#equation-index-200" title="Permalink to this equation">¶</a></span>\[e^{\bar\eta_x \psi + \bar\psi_x \eta_x} = 1 + \bar\eta_x \psi + \bar\psi_x \eta_x
+ \bar\eta_x \psi\bar\psi_x \eta_x\]</div>
<p>In general</p>
<div class="math notranslate nohighlight" id="equation-index-201">
<span class="eqno">(204)<a class="headerlink" href="#equation-index-201" title="Permalink to this equation">¶</a></span>\[\int d\psi d\eta e^{\sum_{ij} \eta_i M_{ij} \psi_j} = det(M)\]</div>
<p>By filling in the squares and performing a change of integration variable, we find</p>
<div class="math notranslate nohighlight" id="equation-index-202">
<span class="eqno">(205)<a class="headerlink" href="#equation-index-202" title="Permalink to this equation">¶</a></span>\[Z[\eta,\bar\eta] = det(M) \int d\bar\psi d\psi e^{ \sum_{x,y} \bar\eta_x M_{x,y} \eta_y}\]</div>
<p>where the fermion matrix <span class="math notranslate nohighlight">\(M\)</span> is</p>
<div class="math notranslate nohighlight" id="equation-index-203">
<span class="eqno">(206)<a class="headerlink" href="#equation-index-203" title="Permalink to this equation">¶</a></span>\[M_{x,y} = \sum_\mu\gamma_\mu \frac{ \delta_{y,x+\mu} - \delta_{y,x-\mu} }{2a} + m\]</div>
<p>and</p>
<div class="math notranslate nohighlight" id="equation-index-204">
<span class="eqno">(207)<a class="headerlink" href="#equation-index-204" title="Permalink to this equation">¶</a></span>\[\begin{split}M^{-1}_{x,y} &amp;= \frac{1}{ \sum_\mu\gamma_\mu ( \delta_{y,x+\mu} - \delta_{y,x-\mu} )/2a + m } \\
&amp;= \int \frac{d^4p}{(2\pi)^4} \frac{1}{ \sum_\mu i\gamma_\mu \sin(p_\mu a)/a + m } e^{ip\cdot x}\\
&amp;= \int \frac{d^4p}{(2\pi)^4} \frac{-\sum_\mu i\gamma_\mu \sin(p_\mu a)/a + m}{ \sum_\mu \sin(p_\mu a)^2/a^2 + m^2 } e^{ip\cdot x}.\end{split}\]</div>
<p>From here we can read the momentum space propagator,</p>
<div class="math notranslate nohighlight" id="equation-index-205">
<span class="eqno">(208)<a class="headerlink" href="#equation-index-205" title="Permalink to this equation">¶</a></span>\[S(p) = -a \frac{\sum_\mu i\gamma_\mu \sin(p_\mu a) - am}{ \sum_\mu \sin(p_\mu a)^2 + a^2m^2 }\]</div>
<p>It clearly approaches the continuum propagator as <span class="math notranslate nohighlight">\(a\to0\)</span>. The lattice momentum is
<span class="math notranslate nohighlight">\(\tilde p_\mu = sin(ap_\mu)/a\)</span>. For bosons we had <span class="math notranslate nohighlight">\(\hat p_\mu = \frac 2a sin(\frac a2 p_\mu)\)</span>.</p>
<p>The difference is quite significant. Remember that the lattice momenta cover the Brillouin zone</p>
<div class="math notranslate nohighlight" id="equation-index-206">
<span class="eqno">(209)<a class="headerlink" href="#equation-index-206" title="Permalink to this equation">¶</a></span>\[-\frac \pi a &lt; p_\mu \leq \frac \pi a\]</div>
<p>Unlike the bosonic momentum, fermion lattice momentum repeats values inside the Brillouin zone</p>
<div class="math notranslate nohighlight" id="equation-index-207">
<span class="eqno">(210)<a class="headerlink" href="#equation-index-207" title="Permalink to this equation">¶</a></span>\[\hat p_\mu(p_\mu) = \hat p_\mu\left (p_\mu + \frac \pi 2 \hat\mu \right )\]</div>
<p>So for each low-momentum mode with a small <span class="math notranslate nohighlight">\(p_\mu\)</span> there is a second low-momentum mode
at <span class="math notranslate nohighlight">\(p_\mu+\frac \pi 2 \hat\mu\)</span>. In total there are <span class="math notranslate nohighlight">\(2^D = 16\)</span> low-momentum states.
These states are known as fermion <strong>doublers</strong>.</p>
<p>In the continuum limit, one species of naive fermions corresponds to 16 degenerate fermions.
This is usually more than you would like.</p>
<p>The root of the problem is in the action with the naively symmetric derivative</p>
<div class="math notranslate nohighlight" id="equation-index-208">
<span class="eqno">(211)<a class="headerlink" href="#equation-index-208" title="Permalink to this equation">¶</a></span>\[S = a^4\sum_x \left [ \sum_\mu \bar\psi_x \gamma_\mu \frac{ \psi_{x+\mu} - \psi_{x-\mu} }{2a}
    - m\bar\psi_x\psi_x \right ]\]</div>
<p>To put it simply (too simply for the interacting case), the derivative term only connects the
field <span class="math notranslate nohighlight">\(\bar\psi\)</span> at even sites to <span class="math notranslate nohighlight">\(\psi\)</span> at odd sites, and
<span class="math notranslate nohighlight">\(\bar\psi\)</span> at odd sites to <span class="math notranslate nohighlight">\(\psi\)</span> at even sites.
There are 2 disconnected fields to each direction.</p>
<p>There are several other fermion discretizations that fix the double problem to an extent.
However the Nielsen-Ninomiya no-go theorem shows that this cannot be done with a local action
without sacrificing
some of the symmetries of the continuum model. The symmetries can be restored in the continuum
limit, but they will be broken in the discrete model.</p>
<dl class="simple">
<dt>The following three are incompatible:</dt><dd><ul class="simple">
<li><p>local action</p></li>
<li><p>chiral symmetry</p></li>
<li><p>absence of doublers</p></li>
</ul>
</dd>
</dl>
<p>In these notes we will cover Wilson fermions and Staggered fermions. Wilson fermions are
conceptually simpler and we will start with them. Other possiblities you may want to look
into include twisted mass, Ginsparg-Wilson, Domain-wall and Overlap fermions.</p>
<p><strong>Symmetries</strong></p>
<p>The Nielsen-Ninomiya theorem states that the lattice fermions without doublers must break some
global symmetries. Before we go on to common solutions to the double problem, let’s look at the
global symmetries of the original action.</p>
<p>Again, the full action is</p>
<div class="math notranslate nohighlight" id="equation-index-209">
<span class="eqno">(212)<a class="headerlink" href="#equation-index-209" title="Permalink to this equation">¶</a></span>\[S = a^4\sum_x \left [ \sum_\mu \bar\psi_x \gamma_\mu \frac{ \psi_{x+\mu} - \psi_{x-\mu} }{2a}
    - m\bar\psi_x\psi_x \right ]\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\textrm{U(1)}_V\)</span></p></li>
</ul>
<div class="math notranslate nohighlight" id="equation-index-210">
<span class="eqno">(213)<a class="headerlink" href="#equation-index-210" title="Permalink to this equation">¶</a></span>\[\begin{split}&amp;\psi \to e^{i\theta} \psi\\
&amp;\bar\psi \to \bar\psi e^{-i\theta}\end{split}\]</div>
<p>is a symmetry of the action and the partition function. Results in conservation of fermion number.</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\textrm{U(1)}_A\)</span>, if <span class="math notranslate nohighlight">\(m=0\)</span>,</p></li>
</ul>
<div class="math notranslate nohighlight" id="equation-index-211">
<span class="eqno">(214)<a class="headerlink" href="#equation-index-211" title="Permalink to this equation">¶</a></span>\[\begin{split}&amp;\psi \to e^{i\theta\gamma_5} \psi\\
&amp;\bar\psi \to \bar\psi e^{i\theta\gamma_5}\end{split}\]</div>
<p>is a symmetry of the action and on the lattice also the measure.
In continuum this is <strong>not</strong> as symmetry of the measure <span class="math notranslate nohighlight">\(d\bar\psi d\psi\)</span>.
Since it is not a symmetry of the partition function, it does not result in a conserved quantity.
The violations appear at higher loop order.</p>
<p>If there are multiple flavours of fermions with degenerate mass <span class="math notranslate nohighlight">\(m\)</span>, we can combine the
flavors as a single vector</p>
<div class="math notranslate nohighlight" id="equation-index-212">
<span class="eqno">(215)<a class="headerlink" href="#equation-index-212" title="Permalink to this equation">¶</a></span>\[\begin{split}\psi = \begin{pmatrix}
\psi_1 \\
\vdots \\
\psi_{N_f} \end{pmatrix}, \textrm{ }
\bar \psi = \begin{pmatrix}
\bar\psi_1, \cdots, \bar\psi_{N_f} \end{pmatrix},\end{split}\]</div>
<div class="math notranslate nohighlight" id="equation-index-213">
<span class="eqno">(216)<a class="headerlink" href="#equation-index-213" title="Permalink to this equation">¶</a></span>\[S = a^4\sum_x \left [ \sum_\mu \bar\psi_x \gamma_\mu \frac{ \psi_{x+\mu} - \psi_{x-\mu} }{2a}
    - m\bar\psi_x\psi_x \right ]\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\textrm{SU}(N_f)_V\)</span></p></li>
</ul>
<div class="math notranslate nohighlight" id="equation-index-214">
<span class="eqno">(217)<a class="headerlink" href="#equation-index-214" title="Permalink to this equation">¶</a></span>\[\begin{split}&amp;\psi \to e^{if_a\tau_a} \psi\\
&amp;\bar\psi \to \bar\psi e^{-if_a\tau_a}\end{split}\]</div>
<p>is a symmetry of the action and the partition function. Results in conservation flavor number.</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\textrm{SU}(N_f)_A\)</span>, if <span class="math notranslate nohighlight">\(m=0\)</span>,</p></li>
</ul>
<div class="math notranslate nohighlight" id="equation-index-215">
<span class="eqno">(218)<a class="headerlink" href="#equation-index-215" title="Permalink to this equation">¶</a></span>\[\begin{split}&amp;\psi \to e^{if_a\tau_a\gamma_5} \psi\\
&amp;\bar\psi \to \bar\psi e^{if_a\tau_a\gamma_5}\end{split}\]</div>
<p>is a symmetry of the action and the partition function. This is not broken by the measure.
The conserved quantity is known as parity.</p>
</div>
<div class="section" id="wilson-fermions">
<h3>Wilson Fermions<a class="headerlink" href="#wilson-fermions" title="Permalink to this headline">¶</a></h3>
<p>Wilson fermions remove the doublers by adding a second derivative term</p>
<div class="math notranslate nohighlight" id="equation-index-216">
<span class="eqno">(219)<a class="headerlink" href="#equation-index-216" title="Permalink to this equation">¶</a></span>\[S = a^4\sum_x \left [ \sum_\mu \bar\psi_x \gamma_\mu \frac{ \psi_{x+\mu} - \psi_{x-\mu} }{2a}
    - m\bar\psi_x\psi_x - a\frac r2 \bar\psi_x \sum_\mu \frac{ 2\psi_{x} - \psi_{x+\mu} - \psi_{x-\mu} }{2a^2} \right ]\]</div>
<p>The parameter <span class="math notranslate nohighlight">\(r\)</span> is an adjustable constant. Since the second derivative is multiplied by a,
it has higher dimension than the action in general and formally vanishes in the continuum limit.</p>
<p>In momentum space, this fermion matrix is</p>
<div class="math notranslate nohighlight" id="equation-index-217">
<span class="eqno">(220)<a class="headerlink" href="#equation-index-217" title="Permalink to this equation">¶</a></span>\[M_{x,y} = \int \frac{d^4p}{(2\pi)^4} \left (\frac 1a \sum_\mu i\gamma_\mu \sin(p_\mu a) + m
 - \frac 1a r \sum_\mu \left( cos(ap_\mu) -1 \right) \right ) e^{ip\cdot x}.\]</div>
<p>and the propagator</p>
<div class="math notranslate nohighlight" id="equation-index-218">
<span class="eqno">(221)<a class="headerlink" href="#equation-index-218" title="Permalink to this equation">¶</a></span>\[S(p) = a\frac{\sum_\mu i\gamma_\mu \sin(p_\mu a) - am + r \sum_\mu \left( cos(ap_\mu) -1 \right)}{ \sum_\mu \sin(p_\mu a)^2/ + \left [ am + r \sum_\mu \left( cos(ap_\mu) -1 \right)\right ]^2 }\]</div>
<p>So there is a <span class="math notranslate nohighlight">\(p\)</span>-dependent correction to the mass. This will give the doublers a non-zero
mass.
As <span class="math notranslate nohighlight">\(p \to 0\)</span>,</p>
<div class="math notranslate nohighlight" id="equation-index-219">
<span class="eqno">(222)<a class="headerlink" href="#equation-index-219" title="Permalink to this equation">¶</a></span>\[S(p) = a\frac{\sum_\mu i\gamma_\mu \sin(p_\mu a) - am }{ \sum_\mu \sin(p_\mu a)^2 + \left [ am \right ]^2 }\]</div>
<p>The double at <span class="math notranslate nohighlight">\(p \to (\pi/a,0,0,0)\)</span> has</p>
<div class="math notranslate nohighlight" id="equation-index-220">
<span class="eqno">(223)<a class="headerlink" href="#equation-index-220" title="Permalink to this equation">¶</a></span>\[S(p) = a\frac{\sum_\mu i\gamma_\mu \sin(p_\mu a) - \left[am + 2r \right] }{ \sum_\mu \sin(p_\mu a)^2 + \left [ am + 2r \right ]^2 }\]</div>
<p>In fact every direction with a <span class="math notranslate nohighlight">\(\pi/a\)</span> yields an additional <span class="math notranslate nohighlight">\(2r\)</span>. The mass of a doubler
is</p>
<div class="math notranslate nohighlight" id="equation-index-221">
<span class="eqno">(224)<a class="headerlink" href="#equation-index-221" title="Permalink to this equation">¶</a></span>\[m_{doubler} = m + \frac {2N}a r\]</div>
<p>When <span class="math notranslate nohighlight">\(a\to 0\)</span> the doublers become infinitely massive and decouple from the theory.</p>
<p><strong>The standard choice</strong> for the Wilson parameter is <span class="math notranslate nohighlight">\(r=1\)</span>. We then find</p>
<div class="math notranslate nohighlight" id="equation-index-222">
<span class="eqno">(225)<a class="headerlink" href="#equation-index-222" title="Permalink to this equation">¶</a></span>\[S = a^4\sum_x  \left [ \sum_\mu \bar\psi_x \frac{ 1-\gamma_\mu}{2a} \psi_{x+\mu} - \sum_\mu \bar\psi_x \frac{ 1+\gamma_\mu}{2a} \psi_{x-\mu} - M\bar\psi_x\psi_x \right ],\]</div>
<p>where <span class="math notranslate nohighlight">\(M = m+\frac 4a\)</span></p>
<p>This is a particularly useful form of he action because the since the derivative terms contain projections,</p>
<div class="math notranslate nohighlight" id="equation-index-223">
<span class="eqno">(226)<a class="headerlink" href="#equation-index-223" title="Permalink to this equation">¶</a></span>\[\begin{split}&amp;P_\mu^\pm = \frac{ 1\pm \gamma_\mu }{2}.\\
&amp;(P^\pm_\mu)^2 = P^\pm_\mu \\
&amp;P^+_\mu P^-_\mu = P^-_\mu P^+_\mu = 0 \\
&amp;P^+_\mu + P^-_\mu = 1\end{split}\]</div>
<p>These reduce the number of elements in the projected vector by a factor of two, reducing the amount of
multiplication required to evaluate the action and the amount data that
would need to be communicated to other processors in a multiprocessor setup.</p>
<p>Another standard choice is to rescale the fields by <span class="math notranslate nohighlight">\(\sqrt{M}\)</span> so that the action becomes</p>
<div class="math notranslate nohighlight" id="equation-index-224">
<span class="eqno">(227)<a class="headerlink" href="#equation-index-224" title="Permalink to this equation">¶</a></span>\[\begin{split}S &amp;= a^4\sum_x  \left [\kappa \sum_\mu \bar \psi_x \frac 1a \psi_x P_\mu^{-} \psi_{x+\mu} - \kappa \sum_\mu \bar \psi_x \frac 1a \psi_x  P_\mu^{+} \psi_{x-\mu} - \bar\psi_x\psi_x \right ] \\
\kappa &amp;= \frac {1}{2M} = \frac {1}{2m+8/a}\end{split}\]</div>
<p>From this form it is clear that at large mass, or small <span class="math notranslate nohighlight">\(\kappa\)</span>, we can expand the partition function in terms of the
derivative terms, connecting individual sites to their neighbours.</p>
<p><strong>The Chiral Symmetry</strong></p>
<p>The second derivative term <span class="math notranslate nohighlight">\(\psi_{x} \Box_{x,y} \psi_{y}\)</span> in the action breaks the chiral symmetries,
<span class="math notranslate nohighlight">\(\textrm{U(1)}_A\)</span> and <span class="math notranslate nohighlight">\(\textrm{SU}(N_f)_A\)</span>, even at <span class="math notranslate nohighlight">\(m\to 0\)</span>.
Effectively the mass gets and additive renormalization,</p>
<div class="math notranslate nohighlight" id="equation-index-225">
<span class="eqno">(228)<a class="headerlink" href="#equation-index-225" title="Permalink to this equation">¶</a></span>\[m_{phys} = m_0 + \delta m.\]</div>
<p>The bare mass needs to be tuned to find the intended physical mass.</p>
<p><strong>Gauge fields</strong> are added as parallel transports in the derivative,</p>
<div class="math notranslate nohighlight" id="equation-index-226">
<span class="eqno">(229)<a class="headerlink" href="#equation-index-226" title="Permalink to this equation">¶</a></span>\[S = a^4\sum_x  \left [ \sum_\mu \bar\psi_x U_{x,\mu} \frac{ 1-\gamma_\mu}{2a} \psi_{x+\mu}
   - \sum_\mu \bar\psi_x U^\dagger_{x-\hat\mu,\mu} \frac{ 1+\gamma_\mu}{2a} \psi_{x-\mu} - M\bar\psi_x\psi_x \right ],\]</div>
<p>If the gauge interaction is <span class="math notranslate nohighlight">\(SU(N)\)</span>, the spinors acquire a new color index in addition to the spinor index.</p>
<p><strong>Discretization Errors</strong></p>
<p>The naive fermion action was correct up to errors of <span class="math notranslate nohighlight">\(O(a^2)\)</span>, except of course for the doublers.
In quantum field theory, any term that is allowed by symmetries will appear in the action due to renormalization,
but there are no terms that would not break the symmetries at order <span class="math notranslate nohighlight">\(a\)</span>.</p>
<p>Since we added a term that does break some of the symmetries, any other terms that fit the new symmetry structure
are allowed. To get back to a model that is correct at order <span class="math notranslate nohighlight">\(a\)</span>, we should add all the terms that are made
possible by the broken symmetry and tune their couplings to cancel the quantum effects.</p>
<p>So the actual expectation value of the action is a linear combination of the following five possible
order <span class="math notranslate nohighlight">\(a\)</span>: terms</p>
<blockquote>
<div><ol class="arabic">
<li><p><span class="math notranslate nohighlight">\(O_1 = m^2 \bar \psi \psi\)</span></p>
<p>Already in the action, but the coupling <span class="math notranslate nohighlight">\(m\)</span> will get quantum corrections.</p>
</li>
<li><p><span class="math notranslate nohighlight">\(O_2 = m\bar \psi \gamma_\mu D_\mu \psi\)</span></p>
<p>Also in the action, renormalization can be interpreted as a renormalization of the fields.</p>
</li>
<li><p><span class="math notranslate nohighlight">\(O_3 = \bar\psi \gamma_\mu D_\mu \gamma_\nu D_\nu \psi = \bar\psi \Box \psi\)</span></p>
<p>This is the Wilson term. If we only care about on-shell quantities (and we do), renormalization of this term
can be absorbed into the mass term.</p>
</li>
<li><p><span class="math notranslate nohighlight">\(O_4 = \bar\psi \left [ \gamma_\mu D_\mu, \gamma_\nu D_\nu\right] \psi \sim \bar\psi \sigma_{\mu\nu} F_{\mu\nu} \psi\)</span></p>
<p>This one is new. Here <span class="math notranslate nohighlight">\(\sigma_{\mu\nu} = -\frac i2 \left [\gamma_\mu,\gamma_\nu\right ]\)</span>. Renormalization of this one
cannot be completely absorbed to the terms that are already present in the action.</p>
</li>
<li><p><span class="math notranslate nohighlight">\(O_5 = m Tr \left ( F_{\mu\nu}F_{\mu\nu} \right )\)</span></p>
<p>A renormalization of the gauge action.</p>
</li>
</ol>
</div></blockquote>
<p>There are many more terms at higher orders, but these are the only ones at order <span class="math notranslate nohighlight">\(a\)</span>. Since only
<span class="math notranslate nohighlight">\(O_4\)</span> is not already in the action (up to renormalization of existing fields and parameters), it needs to be
added and we need to find a suitable coefficient for it.</p>
<p>Operator <span class="math notranslate nohighlight">\(O_4\)</span> is also known as the Sheikholeslami-Wohler operator or the clover operator. The latter is due
to the fact that the field strength <span class="math notranslate nohighlight">\(F_{\mu\nu}\)</span> is usually evaluated by taking an average of plaquettes
around a given site. The diagram representing this in 2 dimensions has four ‘leaves’, just like clovers usually do not.</p>
<p>It turns out that the clover coefficient <span class="math notranslate nohighlight">\(c_{SW} = 1\)</span> at small coupling. At higher coupling it is generally
larger than one.</p>
<p>So it is sufficient to add one more term to the lattice action a find the value of it’s coefficient to build an order
<span class="math notranslate nohighlight">\(a\)</span> improved lattice action. Notice, though, that when calculating the expectation value of an operator,
<span class="math notranslate nohighlight">\(\ev{O}\)</span>, the measurement may still have order <span class="math notranslate nohighlight">\(a\)</span> effects if the operator <span class="math notranslate nohighlight">\(O\)</span> itself does.
The operator can be improved following the same process as for the action.</p>
<p>The process of finding all operators that mix with the action and measurable operators to a given order and setting
their coefficients is known as Symanzik improvement. This is not a small task and the results are known only for a
small set of models and observables.</p>
</div>
<div class="section" id="staggered-kogut-susskind-fermions">
<h3>Staggered (Kogut-Susskind) Fermions<a class="headerlink" href="#staggered-kogut-susskind-fermions" title="Permalink to this headline">¶</a></h3>
<p>Staggered fermions are a second common solution to the doubling problem. As you will see, they are conceptually more
complicated than Wilson fermions, but are easier to implement in practice.</p>
<p>As a reminder, the naive fermion action was</p>
<div class="math notranslate nohighlight" id="equation-index-227">
<span class="eqno">(230)<a class="headerlink" href="#equation-index-227" title="Permalink to this equation">¶</a></span>\[S = a^4\sum_x \left [ \sum_\mu \bar\psi_x \gamma_\mu \frac{ U_{x,\mu} \psi_{x+\hat\mu} - U^\dagger_{x-\hat\mu,\mu} \psi_{x-\hat\mu} }{2a} - m\bar\psi_x\psi_x  \right ]\]</div>
<p>Staggered fermions do not actually remove the doublers, but rather build the dirac and flavor degrees of freedom out of them.
In the action above, we can perform the replacement</p>
<div class="math notranslate nohighlight" id="equation-index-228">
<span class="eqno">(231)<a class="headerlink" href="#equation-index-228" title="Permalink to this equation">¶</a></span>\[\begin{split}\psi_x &amp;\to T_x \psi_x \\
\bar\psi_x &amp;\to \bar\psi_x T_x^\dagger, \\
T_x &amp;= \gamma_0^{x_0} \gamma_1^{x_1} \gamma_2^{x_2} \gamma_3^{x_3}, \textrm{ } T^\dagger_x T_x = 1\end{split}\]</div>
<p>This leaves the mass term <span class="math notranslate nohighlight">\(\bar\psi_x\psi_x\)</span> unchanged, but in the derivative term we have</p>
<div class="math notranslate nohighlight" id="equation-index-229">
<span class="eqno">(232)<a class="headerlink" href="#equation-index-229" title="Permalink to this equation">¶</a></span>\[T_x \gamma_\mu T_{x+\hat\mu} = (-1)^{x_0+x_1+\dots+x_{\mu-1}} = (-1)^{\sum_{\nu=0}^{\mu-1}x_{\nu}} = \eta_{x,\mu}\]</div>
<p>The naive action becomes</p>
<div class="math notranslate nohighlight" id="equation-index-230">
<span class="eqno">(233)<a class="headerlink" href="#equation-index-230" title="Permalink to this equation">¶</a></span>\[S = a^4\sum_x \left [ \sum_\mu \bar\psi_x \eta_{x,\mu} \frac{ U_{x,\mu} \psi_{x+\hat\mu} - U^\dagger_{x-\hat\mu,\mu} \psi_{x-\hat\mu} }{2a} - m\bar\psi_x\psi_x  \right ]\]</div>
<p>We have replaced the <span class="math notranslate nohighlight">\(\gamma\)</span>-matrices with a set of numbers <span class="math notranslate nohighlight">\(\eta_{x,\mu} = \pm1\)</span> that depend on location and direction.
The derivatives now link each Dirac index to the same Dirac index at all directions, making the different Dirac indexes fully equivalent.</p>
<p>Now we can simply drop 3 of the 4 Dirac indexes, just keeping one two Grassman numbers <span class="math notranslate nohighlight">\(\bar\psi\)</span> and <span class="math notranslate nohighlight">\(\psi\)</span> at each
site. This reduces the number of independent degrees of freedom by 4.
Now there are only 4 doubles left (4 spinor indexes, 4 flavors = 16 doubles). These doubler-flavours are usually referred to as
tastes.</p>
<p><strong>Symmetries</strong></p>
<p>This time we did not add any new terms that would break symmetries, but we did remove the spinor degreese of freedom.
So it is not very surprising that the symmetries related to these indexes are broken.</p>
<p>What remains is a remnant symmetry related to the axial vector symmetry, <span class="math notranslate nohighlight">\(\textrm{U(1)}_A\)</span>.</p>
<div class="math notranslate nohighlight" id="equation-index-231">
<span class="eqno">(234)<a class="headerlink" href="#equation-index-231" title="Permalink to this equation">¶</a></span>\[\begin{split}\psi &amp;\to e^{i\Gamma_5} \psi,\\
\bar\psi &amp;\to \bar\psi e^{i\Gamma_5},\\
\Gamma_5 &amp;= (-1)^{\sum_\mu x_{\mu}}\end{split}\]</div>
<p>This remnant still protects the mass from additive renormalization. The symmetry is broken at nonzero mass, so
zero mass remains a special point. Renormalization never breaks global symmetries.</p>
<p><strong>Staggering the fermions</strong></p>
<p>So far I have not given any reason for calling these fermions staggered. We have only dropped some degrees of freedom,
not reconstructed the original model in the continuum.</p>
<p>We cannot in fact use the doublers at each site. They are described by only two Grassmann fields and cannot be disentangled.
Instead we use the <span class="math notranslate nohighlight">\(2^D\)</span> sites on each <span class="math notranslate nohighlight">\(2\times2\times2\times2\)</span> hypercube.</p>
<p>Numbering the sites on a hypercube by <span class="math notranslate nohighlight">\(\alpha\)</span>, we can recast the fields as</p>
<div class="math notranslate nohighlight" id="equation-index-232">
<span class="eqno">(235)<a class="headerlink" href="#equation-index-232" title="Permalink to this equation">¶</a></span>\[\psi^\alpha \to \Psi^\beta_a,\]</div>
<p>where <span class="math notranslate nohighlight">\(\beta\)</span> is the Dirac index and <span class="math notranslate nohighlight">\(a\)</span> the taste index. In the absence of a gauge field we can fully disentangle
the Dirac and taste indexes and write the action (with <span class="math notranslate nohighlight">\(b=2a\)</span>) as</p>
<div class="math notranslate nohighlight" id="equation-index-233">
<span class="eqno">(236)<a class="headerlink" href="#equation-index-233" title="Permalink to this equation">¶</a></span>\[S = b^4\sum_x \bar\Psi \left [ \sum_\mu (\gamma_\mu \otimes 1) \Delta_\mu
  + \frac b2 (\gamma_\mu\otimes\gamma_\mu^*\gamma_5) \Delta_\mu^2 + 2m (1\otimes 1) \right ] \Psi\]</div>
<p>To be precise,</p>
<div class="math notranslate nohighlight" id="equation-index-234">
<span class="eqno">(237)<a class="headerlink" href="#equation-index-234" title="Permalink to this equation">¶</a></span>\[\Psi^\alpha_a = \frac 18 \sum_{y\in hypercube} T^{\alpha a}_y \psi_y\]</div>
<p>The inverse transform is</p>
<div class="math notranslate nohighlight" id="equation-index-235">
<span class="eqno">(238)<a class="headerlink" href="#equation-index-235" title="Permalink to this equation">¶</a></span>\[\psi_{2x+y} = 2Tr\left[T^\dagger_y\Psi_x\right]\]</div>
<p>So the different indexes of a continuum fermion are actually constructed out of the fields on a minimal hypercube,
not out of the doublers. The doublers are still necessary to ensure we have the correct number of degrees of freedom
(or, in fact, a factor of 4 too many).</p>
<p><strong>Note</strong> that introducing gauge fields complicates the transformation. The order <span class="math notranslate nohighlight">\(b\)</span> term receives a contribution
relative to the gauge coupling. This still works in the continuum limit, since there <span class="math notranslate nohighlight">\(g\to 0\)</span>.</p>
<p><strong>Rooting</strong></p>
<p>The rooting trick is sometimes used to reduce the number of staggered tastes. For <span class="math notranslate nohighlight">\(N_f\)</span> degenerate fermions</p>
<div class="math notranslate nohighlight" id="equation-index-236">
<span class="eqno">(239)<a class="headerlink" href="#equation-index-236" title="Permalink to this equation">¶</a></span>\[Z = \int d\bar\psi d\psi e^{-\sum_f\bar\psi^f M \psi^f} = det \left( M \right )^{N_f}\]</div>
<p>assuming <span class="math notranslate nohighlight">\(M\)</span> describes a single fermion. Since the staggered matrix <span class="math notranslate nohighlight">\(M_{stg}\)</span> describes four, maybe</p>
<div class="math notranslate nohighlight" id="equation-index-237">
<span class="eqno">(240)<a class="headerlink" href="#equation-index-237" title="Permalink to this equation">¶</a></span>\[Z = det \left( M_{stg} \right )^{1/2} = \int d\bar\psi d\psi e^{-\frac 12 \bar\psi M_{stg} \psi}\]</div>
<p>describes 2?</p>
<p>This issue is not completely settled, but the rooting trick is often used and is safe in most cases.</p>
</div>
<div class="section" id="simulating-grassmann-fields">
<h3>Simulating Grassmann fields<a class="headerlink" href="#simulating-grassmann-fields" title="Permalink to this headline">¶</a></h3>
<p>Running calculations of Grassmann numbers on a computer is very non-trivial. On would need to track wether each existing
Grassmann number is present or absent in each term when multiplying. This would require a bit per Grassmann number.
The memory requirement of a lattice simulation would be completely untractable.</p>
<p>It is possible often to expand the exponential out and perform the Grassmann integral analytically, leading to a
<em>dual representation</em>. These exist for many models and are quite efficient, strongly interacting fermions are notably
hard to rewrite in this way.</p>
<p>Instead we usually use the bosonization trick. Given that we simulate 2 degerate fermion flavors, we write the
action as</p>
<div class="math notranslate nohighlight" id="equation-index-238">
<span class="eqno">(241)<a class="headerlink" href="#equation-index-238" title="Permalink to this equation">¶</a></span>\[Z = \int d\bar\psi d\psi e^{-\bar\psi M^\dagger M \psi} = det \left( M \right ) = \frac 1N \int \chi e^{-\chi^\dagger (M^\dagger M)^{-1} \chi}.\]</div>
<p>The pseudofermion fields <span class="math notranslate nohighlight">\(\chi\)</span> here are just normal complex numbers. This is already more tracktable, eventhough the inverse is
not limited to nearest neighbour interactions.</p>
<p>In fact it is surpisingly easy to draw configurations of the pseudofermion fields. Since the action is gaussian in <span class="math notranslate nohighlight">\(\chi\)</span>, we
can draw from a gaussian distribution. First we draw an intermediate field <span class="math notranslate nohighlight">\(\psi\)</span> from a simple gaussian distribution,</p>
<div class="math notranslate nohighlight" id="equation-index-239">
<span class="eqno">(242)<a class="headerlink" href="#equation-index-239" title="Permalink to this equation">¶</a></span>\[P(\psi) = e^{-\psi^\dagger \psi}.\]</div>
<p>Next we transform this into</p>
<div class="math notranslate nohighlight" id="equation-index-240">
<span class="eqno">(243)<a class="headerlink" href="#equation-index-240" title="Permalink to this equation">¶</a></span>\[\chi = M^\dagger \psi\]</div>
<p>Then the distribution of the field field <span class="math notranslate nohighlight">\(\chi\)</span> is</p>
<div class="math notranslate nohighlight" id="equation-index-241">
<span class="eqno">(244)<a class="headerlink" href="#equation-index-241" title="Permalink to this equation">¶</a></span>\[P(\chi) = e^{-\chi^\dagger (M^\dagger M)^{-1} \chi}.\]</div>
<p>as intended.</p>
<p>This trick also gives the initial action of the fermion field cheaply, <span class="math notranslate nohighlight">\(S=\psi^\dagger \psi\)</span>. When updating other
fields, such as the gauge field, we need to calculate the difference in the fermion action. This gives the initial action,
but we still need to calculate the action after the update.</p>
<p>There are several useful methods for calculating the inverse. General methods take O(N^3) computing time, but since
the fermion matrix is very sparce other methods can be much faster. The conjugate gradient method is probably the
most common and works as long as the fermion matrix in Hermitean.</p>
<p>A common trick is to invert the Hermitean matrix <span class="math notranslate nohighlight">\(M M^\dagger\)</span> and multiply by <span class="math notranslate nohighlight">\(M^\dagger\)</span> at the end
to get <span class="math notranslate nohighlight">\(M^{-1}\)</span>. If using Wilson fermions, the combination <span class="math notranslate nohighlight">\(\gamma_5 M\)</span> is Hermitean and
<span class="math notranslate nohighlight">\(\gamma_5(\gamma_5M)^{-1}=M^{-1}\)</span>.</p>
</div>
<div class="section" id="measurements">
<h3>Measurements<a class="headerlink" href="#measurements" title="Permalink to this headline">¶</a></h3>
<p>The fermion propagator is</p>
<div class="math notranslate nohighlight" id="equation-index-242">
<span class="eqno">(245)<a class="headerlink" href="#equation-index-242" title="Permalink to this equation">¶</a></span>\[\begin{split}P_{xy} &amp;= \partial_{J_x} \partial_{J_y} \frac 1Z \int d\bar\psi \psi e^{a^4\sum_{x,y} \bar\psi_x M_{x,y} \psi_y + \bar\psi_x \eta_y + \bar \eta_x \psi_y  } \\
&amp; = \ev{ M^{-1} }_{xy}\end{split}\]</div>
<p>This can be obtained directly from lattice simulations if the inverse <span class="math notranslate nohighlight">\(M^{-1}\)</span> can be calculated.
This is naturally quite expensive, but the methods mentioned above do work.</p>
<p>While the fermion propagator can be used to calculate the renormalized fermion mass, in practice this is not often done.
Instead, the chiral symmetry, broken or not, provides enables more efficient fermion mass measurements. With staggered
fermions the remnant of the chiral symmetry forces the actual renormalized mass to zero when <span class="math notranslate nohighlight">\(m=0\)</span> so  that</p>
<div class="math notranslate nohighlight" id="equation-index-243">
<span class="eqno">(246)<a class="headerlink" href="#equation-index-243" title="Permalink to this equation">¶</a></span>\[\bar m = c_m m_0\]</div>
<p>This is usually sufficient and there is not reason for actually calculating the mass.</p>
<p>With Wilson fermions the situation is more complicated, since the fermion mass is not protected by a symmetry
and can have additive renormalization. Nevertheless the mass is related to the chiral symmetry and we can is it
here. Specifically, we use the Ward identity</p>
<div class="math notranslate nohighlight" id="equation-index-244">
<span class="eqno">(247)<a class="headerlink" href="#equation-index-244" title="Permalink to this equation">¶</a></span>\[\partial_\mu \ev{\bar\psi_x \gamma_\mu \gamma_5 \tau_a \psi_x O(y)} = 2 m \ev{\bar\psi_x \gamma_\mu \gamma_5 \tau_a \psi_x O(y)}\]</div>
<p>for <span class="math notranslate nohighlight">\(x \neq y\)</span>. This relation is also known as the partially conserved axial current relation (PCAC) and so
mass <span class="math notranslate nohighlight">\(m\)</span> here is known as the PCAC-mass. The axial current is conserved when <span class="math notranslate nohighlight">\(m=0\)</span>, which implies
chiral symmetry (at least in continuum), so the PCAC-mass does is free of additive renormalization.</p>
<p>Other important measuremnts include the masses of bound states of fermions. Lattice QCD has been very succesful in
producing ab-initio calculation of these masses, something that is not easy in perturbation theory. In order to find
the mass of a bound state, we calculate the correlation function of an operator <span class="math notranslate nohighlight">\(O(x)\)</span> with the same quantum
numbers as the intended state. For example for the scalar meson <span class="math notranslate nohighlight">\(\sigma\)</span> we could use</p>
<div class="math notranslate nohighlight" id="equation-index-245">
<span class="eqno">(248)<a class="headerlink" href="#equation-index-245" title="Permalink to this equation">¶</a></span>\[O(x) = \bar\psi_x\psi_x \textrm{,  } P(x-y) = \ev{\bar\psi_x\psi_x \bar\psi_y\psi_y}.\]</div>
<p>The correlation function corresponds to the propagator</p>
<div class="math notranslate nohighlight" id="equation-index-246">
<span class="eqno">(249)<a class="headerlink" href="#equation-index-246" title="Permalink to this equation">¶</a></span>\[\ev{O(x)O(y)} = \Braketmid{0}{\hat O^\dagger(x) \hat O(y)}{0} = \Braketmid{0}{ \hat\psi^\dagger_x\hat\psi_x \hat\psi^\dagger_y\hat\psi_y}{0}.\]</div>
<p>The operator will first create a combination of energy eigenstates with the quantum numbers
of the operator at site <span class="math notranslate nohighlight">\(x\)</span>. These will then annihilate at <span class="math notranslate nohighlight">\(y\)</span>. As before, we can decompose the propagator
as</p>
<div class="math notranslate nohighlight" id="equation-index-247">
<span class="eqno">(250)<a class="headerlink" href="#equation-index-247" title="Permalink to this equation">¶</a></span>\[\ev{O(x)O(y)} = e^{-\sum_i E_i |x-y|} \to e^{-m_\sigma t} \textrm{ when } {|x-y|\to\infty}\]</div>
<p>Where now the lowest energy state of the bound state with the smallest mass is the zero momentum <span class="math notranslate nohighlight">\(\sigma\)</span>-particle.</p>
<p>We can construct many other bound states similarly:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Pseudoscalar flavour singlet (<span class="math notranslate nohighlight">\(\eta\)</span>)</p></li>
</ol>
<div class="math notranslate nohighlight" id="equation-index-248">
<span class="eqno">(251)<a class="headerlink" href="#equation-index-248" title="Permalink to this equation">¶</a></span>\[O(x) = \bar\psi_x\gamma_5\psi_x.\]</div>
<ol class="arabic simple" start="2">
<li><p>Pseudoscalar flavour triplet (<span class="math notranslate nohighlight">\(\pi_a\)</span>)</p></li>
</ol>
<div class="math notranslate nohighlight" id="equation-index-249">
<span class="eqno">(252)<a class="headerlink" href="#equation-index-249" title="Permalink to this equation">¶</a></span>\[O_a(x) = \bar\psi_x\gamma_5\sigma_a\psi_x.\]</div>
<ol class="arabic simple" start="3">
<li><p>Vector flavour singlet (<span class="math notranslate nohighlight">\(\omega\)</span>)</p></li>
</ol>
<div class="math notranslate nohighlight" id="equation-index-250">
<span class="eqno">(253)<a class="headerlink" href="#equation-index-250" title="Permalink to this equation">¶</a></span>\[O_\mu(x) = \bar\psi_x\gamma_\mu\psi_x.\]</div>
<ol class="arabic simple" start="4">
<li><p>Vector flavour triplet (<span class="math notranslate nohighlight">\(\omega\)</span>)</p></li>
</ol>
<div class="math notranslate nohighlight" id="equation-index-251">
<span class="eqno">(254)<a class="headerlink" href="#equation-index-251" title="Permalink to this equation">¶</a></span>\[O_{a,\mu}(x) = \bar\psi_x\gamma_\mu \sigma_a\psi_x.\]</div>
</div></blockquote>
<p>and so on…</p>
<p>These operators are still written in terms of Grassmann numbers. In order to calculate the
expectation values, we need to integrate out the fermion fields analytically.
This is similar to the propagator calculations in the previous chapters, where we saw that</p>
<div class="math notranslate nohighlight" id="equation-index-252">
<span class="eqno">(255)<a class="headerlink" href="#equation-index-252" title="Permalink to this equation">¶</a></span>\[\begin{split}\ev{\bar\psi_x \psi_y } &amp;= \frac 1Z \int dU d\bar\psi d\psi \bar\psi_x \psi_y e^{-\bar\psi M(U) \psi - S_{gauge}} \\
&amp;= \frac 1Z \int dU \left ( M(U)^-1 \right )_{xy} e^{- S_{gauge}}\end{split}\]</div>
<p>Now we can combine each <span class="math notranslate nohighlight">\(\bar\psi\)</span> with each <span class="math notranslate nohighlight">\(\psi\)</span> separately, leading to two terms:</p>
<div class="math notranslate nohighlight" id="equation-index-253">
<span class="eqno">(256)<a class="headerlink" href="#equation-index-253" title="Permalink to this equation">¶</a></span>\[\begin{split}\ev{\bar\psi_x \psi_y } &amp;= \frac 1Z \int dU d\bar\psi d\psi \bar\psi_x\Gamma \psi_x \bar\psi_y\Gamma \psi_y e^{-\bar\psi M(U) \psi - S_{gauge}} \\
&amp;= \frac 1Z \int dU Tr \left [ \Gamma \left ( M(U)^-1 \right )_{xy} \Gamma \left ( M(U)^-1 \right )_{yx} \right ] e^{- S_{gauge}} \\
&amp;+ \frac 1Z \int dU Tr \left [ \Gamma \left ( M(U)^-1 \right )_{xx} \right ] Tr \left [ \Gamma \left ( M(U)^-1 \right )_{yy}\right ] e^{- S_{gauge}}\end{split}\]</div>
<p>The second part is known as the <strong>disconnected contribution</strong> or the <strong>disconnected diagram</strong>. This is because the two traces
are taken separately and are not connected by a fermion propagator. The disconnected contribution is statistically
noisy compared to the connected part, especially at large distances. Fortunately, it is zero in for all triplet mesons.</p>
</div>
</div>
<div class="section" id="hybrid-monte-carlo">
<h2>Hybrid Monte-Carlo<a class="headerlink" href="#hybrid-monte-carlo" title="Permalink to this headline">¶</a></h2>
<p>The last missing piece in a program simulating the strong interaction, QCD, is an efficient method for updating the
gauge field. The method you already know, a local update of one of the link matrices, works, but in the presence of
a fermion field this requires inverting the fermion matrix for each update step. The inversion is computationally intensive,
it generally takes <span class="math notranslate nohighlight">\(O(N^3)\)</span> and the fermion matrix grows with <span class="math notranslate nohighlight">\(V^2\)</span>. Even though the matrix is sparse and
the conjugate gradient method quite efficient, this is still slow going.</p>
<p>The Hybrid Monte-Carlo method updates all gauge matrices at the same time.
It consists of 3 steps:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Draw random fermion and momentum fields (momentum introduced below)</p></li>
<li><p>Run a molecular dynamics trajectory, which changes all fields but conserves action up to
integration errors</p></li>
<li><p>Accept or reject with the Metropolis propabitity</p></li>
</ol>
</div></blockquote>
<p>This update satisfies detailed balance if</p>
<blockquote>
<div><ol class="loweralpha simple">
<li><p>the first step satisfies detailed balance (trivial if drawing form a Gaussian distribution)</p></li>
<li><p>the trajectory is time-reversible</p></li>
<li><p>the trajectory maintains the distribution of the momentum (true for hamiltonian equations of motion)</p></li>
<li><p>and the integration errors are sufficiently symmetric.</p></li>
</ol>
</div></blockquote>
<p>The last point results from the second as long as the step size is small, but in practice
it is good to check that</p>
<div class="math notranslate nohighlight" id="equation-index-254">
<span class="eqno">(257)<a class="headerlink" href="#equation-index-254" title="Permalink to this equation">¶</a></span>\[\ev{e^{-\delta S}} = 1\]</div>
<div class="section" id="updating-the-gauge-field-with-molecular-dynamics">
<h3>Updating the gauge field with molecular dynamics<a class="headerlink" href="#updating-the-gauge-field-with-molecular-dynamics" title="Permalink to this headline">¶</a></h3>
<p>The molecular dynamics trajectory follows classical equations of motion, with the
conserved energy replaced by the action.</p>
<p>The actual dynamic gauge field is the vector potential (although it is possible to formulate this
in terms of the SU(N) matrices, this does not avoid calculating the exponential later).
Classical equations of motion conserve the energy by adjusting the field and its conjugate momentum
in opposite directions.
To use this trick, we need to add momentum field
<span class="math notranslate nohighlight">\(\Pi_{x,\mu,a}\)</span> for each vector potential <span class="math notranslate nohighlight">\(A_{x,\mu,a}\)</span>.
The partition function is then</p>
<div class="math notranslate nohighlight" id="equation-index-255">
<span class="eqno">(258)<a class="headerlink" href="#equation-index-255" title="Permalink to this equation">¶</a></span>\[Z = \int dU d\Pi d\bar\phi e^{S_{gauge} - \bar\phi^\dagger \frac 1{M_f}\phi + \frac 12 \sum_{x,\mu,a} \Pi_{x,\mu,a}^2}\]</div>
<p>Notice that the dynamics of the theory do not change by the addition of the momentum field.
It has no interactions with the other fields and adding it is equivalent to multiplying the
partition function with a constant.</p>
<p>Now find the classical equation of motion for the vector potential <span class="math notranslate nohighlight">\(A\)</span> and the momentum
<span class="math notranslate nohighlight">\(\Pi\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-index-256">
<span class="eqno">(259)<a class="headerlink" href="#equation-index-256" title="Permalink to this equation">¶</a></span>\[\begin{split}\partial_s A_{x,\mu,a} &amp;= \frac{\partial S}{\partial \Pi_{x,\mu,a}} = \Pi_{x,\mu,a}\\
\partial_s \Pi_{x,\mu,a} &amp;= - \frac{\partial S}{\partial A_{x,\mu,a} }
= - \frac{\partial S_{gauge}}{\partial A_{x,\mu,a} } - \frac{\partial S_{fermion}}{\partial A_{x,\mu,a} }\end{split}\]</div>
<p>We need to integrate this equation numerically. Since this is a part of a metropolis update,
the integration needs to be reversible. In other words, the integration  steps need to be
symplectic. The simplest method is called the leapfrog update</p>
<div class="math notranslate nohighlight" id="equation-index-257">
<span class="eqno">(260)<a class="headerlink" href="#equation-index-257" title="Permalink to this equation">¶</a></span>\[\begin{split}&amp;\textrm{1) } A_{x,\mu,a}(s+0.5\Delta) = A_{x,\mu,a}(s) + 0.5\Delta \Pi_{x,\mu,a}\\
&amp;\textrm{2) } \Pi_{x,\mu,a}(s+\Delta) = \Pi_{x,\mu,a}(s) - \Delta \frac{\partial S}{\partial A_{x,\mu,a} }\\
&amp;\textrm{3) } A_{x,\mu,a}(s+\Delta) = A_{x,\mu,a}(s+0.5\Delta) + 0.5\Delta \Pi_{x,\mu,a}(s+\Delta s)\end{split}\]</div>
<p>We run this update <span class="math notranslate nohighlight">\(N\)</span> times to reach the the new field <span class="math notranslate nohighlight">\(A_{x,\mu,a}(N\Delta)\)</span>.
This will result in an integration error <span class="math notranslate nohighlight">\(\delta S = S(N\Delta) - S(0)\)</span> of order
<span class="math notranslate nohighlight">\(O(\Delta)\)</span>.</p>
<p>Higher order integrators are also used. Whether they are more efficient depends on the
tradeoff between the acceptance rate, which the integration errors decrease, and the
computational cost of additional evaluations of the derivative.</p>
<p>The gauge update steps as written above directly update the vector potential, but the field
we usually store is the parallel transport <span class="math notranslate nohighlight">\(U_{x,\mu}\)</span>. Since the update size
<span class="math notranslate nohighlight">\(\Delta\)</span> should be small, we can use</p>
<div class="math notranslate nohighlight" id="equation-index-258">
<span class="eqno">(261)<a class="headerlink" href="#equation-index-258" title="Permalink to this equation">¶</a></span>\[\begin{split}U_{x,\mu}(s+0.5\Delta) &amp;= U_{x,\mu}(s) \times e^{i 0.5\Delta \sum_a \Pi_{x,\mu,a} \lambda_a } \\
&amp;\approx e^{i \sum_a \left ( A_{x,\mu,a}(s) + 0.5\Delta \Pi_{x,\mu,a} \right ) \lambda_a }\end{split}\]</div>
<p>This requires calculating the exponential on the left, but even a second order Taylor expansion
results in errors of order <span class="math notranslate nohighlight">\(O(\Delta)\)</span> in the action. We usually use a significantly
higher order expansion to keep the matrix in the SU(N) group.</p>
</div>
<div class="section" id="gauge-derivatives">
<h3>Gauge Derivatives<a class="headerlink" href="#gauge-derivatives" title="Permalink to this headline">¶</a></h3>
<p>In order to calculate the derivatives of the gauge and fermion terms in the action we need the gauge derivative</p>
<div class="math notranslate nohighlight" id="equation-index-259">
<span class="eqno">(262)<a class="headerlink" href="#equation-index-259" title="Permalink to this equation">¶</a></span>\[\frac{\partial U_{x,\mu}}{\partial A_{x,\mu,a} } = \frac{\partial e^{i\sum_a A_{x,\mu,a} \lambda_a}}{\partial A_{x,\mu,a} }
= i\lambda_a e^{i\sum_a A_{x,\mu,a} \lambda_a} = i\lambda_a U_{x,\mu}\]</div>
<p>Since the action is a real number, we can always take the real part of its trace and cycle through
any term until <span class="math notranslate nohighlight">\(U_{x,\mu}\)</span> is in front. Then</p>
<div class="math notranslate nohighlight" id="equation-index-260">
<span class="eqno">(263)<a class="headerlink" href="#equation-index-260" title="Permalink to this equation">¶</a></span>\[\begin{split}\frac{\partial S_{gauge}}{\partial A_{x,\mu,a} }
&amp;= \beta \sum_{\nu\neq\mu} ReTr\left [ i\lambda_a U_{x,\mu} U_{x+\mu,\nu} U^\dagger_{x+\nu,\mu} U^\dagger_{x,\nu}  \right] \\
&amp;- \beta \sum_{\nu\neq\mu} ReTr\left [ i\lambda_a U^\dagger_{x,\mu} U^\dagger_{x-\nu,\nu} U_{x-\nu,\mu} U_{x-\nu+\mu,\nu} \right] \\
&amp;= \beta \sum_{\nu\neq\mu} ReTr\left [ i\lambda_a U_{x,\mu} U_{x+\mu,\nu} U^\dagger_{x+\nu,\mu} U^\dagger_{x,\nu}  \right] \\
&amp;+ \beta \sum_{\nu\neq\mu} ReTr\left [ i\lambda_a U_{x,\mu} U^\dagger_{x-\nu+\mu,\nu} U^\dagger_{x-\nu,\mu} U_{x-\nu,\nu} \right] \\
&amp;= \sum_{\nu\neq\mu} ReTr\left [ i\lambda_a  \beta \left ( U_{x,\mu} U_{x+\mu,\nu} U^\dagger_{x+\nu,\mu} U^\dagger_{x,\nu} + U_{x,\mu} U^\dagger_{x-\nu+\mu,\nu} U^\dagger_{x-\nu,\mu} U_{x-\nu,\nu} \right ) \right]\end{split}\]</div>
<p>We reorder the elements in the action so that the given matrix is on the left,
multiply by the given generator and take the imaginary part of the trace.</p>
<p>We also need the derivative of the fermion actions</p>
<div class="math notranslate nohighlight" id="equation-index-261">
<span class="eqno">(264)<a class="headerlink" href="#equation-index-261" title="Permalink to this equation">¶</a></span>\[\frac{\partial S_{fermion}}{\partial A_{x,\mu,a} }
= \frac{\partial \chi^\dagger \frac 1{M_f} \chi}{\partial A_{x,\mu,a} }
= -\chi^\dagger \frac 1{M_f} \frac{\partial M_f }{\partial A_{x,\mu,a}} \frac 1{M_f} \chi\]</div>
<p>With staggered fermions, denoting <span class="math notranslate nohighlight">\(\psi = \frac 1{M_f} \chi\)</span>, this would be</p>
<div class="math notranslate nohighlight" id="equation-index-262">
<span class="eqno">(265)<a class="headerlink" href="#equation-index-262" title="Permalink to this equation">¶</a></span>\[\begin{split}\frac{\partial S_{staggered}}{\partial A_{x,\mu,a} }
&amp;= ReTr\left [ i\lambda_a \eta_{x,\mu} \left ( U_{x,\mu} \frac{1}{2a} \psi_{x+\hat\mu} \psi^\dagger_x - U^\dagger_{x,\mu} \frac{1}{2a} \psi_x \psi^\dagger_{x+\hat\mu} \right) \right] \\
&amp;= ReTr\left [ i\lambda_a \eta_{x,\mu} U_{x,\mu} \left ( \frac{1}{2a} \psi_{x+\hat\mu} \psi^\dagger_x + \frac{1}{2a} \psi_x \psi^\dagger_{x+\hat\mu} \right) \right]\end{split}\]</div>
<p>For Wilson fermions with two flavors</p>
<div class="math notranslate nohighlight" id="equation-index-263">
<span class="eqno">(266)<a class="headerlink" href="#equation-index-263" title="Permalink to this equation">¶</a></span>\[\begin{split}\frac{\partial S_{Wilson}}{\partial A_{x,\mu,a} }
&amp;= \frac{\partial \chi^\dagger \frac 1{M^\dagger M} \chi}{\partial A_{x,\mu,a} } \\
&amp;= -\chi^\dagger \frac 1{M^\dagger M} \left (\frac{\partial M^\dagger }{\partial A_{x,\mu,a}}M + M^\dagger\frac{\partial M }{\partial A_{x,\mu,a}} \right ) \frac 1{M^\dagger M} \chi\end{split}\]</div>
<p>Denoting <span class="math notranslate nohighlight">\(\psi = \frac 1{M^\dagger M} \chi\)</span>, and <span class="math notranslate nohighlight">\(\phi = M\psi\)</span> the Wilson fermion action is</p>
<div class="math notranslate nohighlight" id="equation-index-264">
<span class="eqno">(267)<a class="headerlink" href="#equation-index-264" title="Permalink to this equation">¶</a></span>\[\begin{split}\frac{\partial S_{Wilson}}{\partial A_{x,\mu,a} }
&amp;= ReTr\left [ i\lambda_a \left ( U_{x,\mu} \frac{- 1+ \gamma_\mu}{2a} \psi_{x+\hat\mu} \phi^\dagger_x - U^\dagger_{x,\mu} \frac{1+\gamma_\mu}{2a} \psi_x \phi^\dagger_{x+\hat\mu} \right) \right] \\
&amp;- ReTr\left [ i\lambda_a \left ( U^\dagger_{x,\mu} \frac{-1+ \gamma_\mu}{2a} \phi_x \psi^\dagger_{x+\hat\mu} - U_{x,\mu} \frac{1+\gamma_\mu}{2a} \phi_{x+\hat\mu} \psi^\dagger_x \right) \right]\end{split}\]</div>
</div>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="#">Table of Contents</a></h3>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Lattice Field Theories</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#motivation">Motivation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#learning-objectives">Learning Objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="#spin-models">Spin models</a></li>
<li class="toctree-l2"><a class="reference internal" href="#field-theories">Field theories</a></li>
<li class="toctree-l2"><a class="reference internal" href="#scalar-fields">Scalar Fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="#monte-carlo-methods">Monte Carlo Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="#gauge-fields">Gauge fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="#fermions">Fermions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#hybrid-monte-carlo">Hybrid Monte-Carlo</a></li>
</ul>
</li>
</ul>

<ul class="this-page-menu">
  <li><a href="https://github.com/rantahar/Lattice-Field-Theory"
         rel="nofollow">See our github page to add issues or fork your own version of these notes</a></li>
</ul>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Jarno Rantaharju.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.3.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/index.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>